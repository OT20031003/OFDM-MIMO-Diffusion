Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
img shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6331, 0.7854, 0.6502, 0.7924, 0.5607, 0.5562, 1.0437, 0.4510, 0.6230,
        0.6187, 0.5298, 0.5912, 0.5910, 0.6297, 0.6507, 0.9634, 0.4686, 0.9956,
        0.5815, 0.6080], device='cuda:0')
Variance (Real, all elements): 0.5042194128036499
Variance (Imag, all elements): 0.5025734305381775
--------SNR = -5,  rho_ul = 0.004941058844013093-----------
G_variance = tensor([0.9819, 0.9938, 1.0036, 0.9916, 1.0296, 0.9780, 0.9955, 1.0133, 1.0177,
        1.0161, 1.0370, 0.9835, 1.0115, 0.9955, 0.9761, 1.0031, 0.9724, 1.0192,
        0.9856, 0.9994], device='cuda:0')
G_hat_variance = tensor([0.2422, 0.2436, 0.2456, 0.2364, 0.2409, 0.2366, 0.2441, 0.2343, 0.2428,
        0.2428, 0.2425, 0.2431, 0.2409, 0.2442, 0.2467, 0.2409, 0.2468, 0.2466,
        0.2405, 0.2402], device='cuda:0')
G_tilde_var = tensor([0.7635, 0.7540, 0.7551, 0.7484, 0.7784, 0.7572, 0.7489, 0.7772, 0.7785,
        0.7808, 0.7998, 0.7450, 0.7729, 0.7661, 0.7390, 0.7604, 0.7461, 0.7644,
        0.7476, 0.7623], device='cuda:0')
gamma = tensor([[[0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
          0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
          0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
          0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
          0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
          0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
          0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403,
          0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403, 0.2403]]],
       device='cuda:0')
Z_mean = tensor([-0.0040+0.0175j, -0.0138+0.0163j,  0.0098-0.0191j,  0.0017+0.0163j,
        -0.0066-0.0092j,  0.0050-0.0179j, -0.0072+0.0029j, -0.0089-0.0025j,
         0.0058+0.0035j, -0.0126+0.0130j,  0.0257+0.0034j, -0.0023-0.0052j,
         0.0033-0.0047j,  0.0134+0.0009j,  0.0171-0.0023j, -0.0084+0.0007j,
         0.0051-0.0042j, -0.0016+0.0061j,  0.0027+0.0072j, -0.0115-0.0041j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0082, 1.0141, 1.0224, 0.9839, 1.0029, 0.9848, 1.0161, 0.9751, 1.0106,
        1.0105, 1.0094, 1.0117, 1.0026, 1.0166, 1.0268, 1.0029, 1.0273, 1.0263,
        1.0011, 0.9999], device='cuda:0')
Real_SNR = tensor([-5.2031, -3.6546, -4.0513, -4.2648, -4.6963, -4.9350, -4.5291, -4.3315,
        -4.2652, -4.5780, -3.9666, -4.9718, -4.8142, -4.0548, -4.6404, -4.6936,
        -4.8708, -4.2211, -4.3299, -4.6674], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([62.2834, 87.0005, 80.6534, 78.6006, 69.8921, 63.2692, 69.2920, 74.1694,
        74.9094, 70.1427, 77.2265, 65.9781, 66.9965, 78.1196, 67.5141, 70.4975,
        67.6940, 76.0148, 74.6736, 70.3096], device='cuda:0')
signal_var = tensor([0.3077, 0.4299, 0.3985, 0.3884, 0.3453, 0.3126, 0.3424, 0.3665, 0.3701,
        0.3466, 0.3816, 0.3260, 0.3310, 0.3860, 0.3336, 0.3483, 0.3345, 0.3756,
        0.3690, 0.3474], device='cuda:0')
w_var = tensor([1.0198, 0.9973, 1.0129, 1.0369, 1.0183, 0.9739, 0.9714, 0.9936, 0.9883,
        0.9945, 0.9511, 1.0242, 1.0030, 0.9819, 0.9711, 1.0265, 1.0267, 0.9927,
        0.9999, 1.0176], device='cuda:0')
y_var = tensor([1.3143, 1.4049, 1.3829, 1.4449, 1.3553, 1.2692, 1.3029, 1.3331, 1.3649,
        1.3445, 1.3241, 1.3372, 1.3112, 1.3870, 1.3155, 1.3705, 1.3576, 1.4013,
        1.3815, 1.3688], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([48.6238, 48.6238, 48.6238, 48.6238, 48.6238, 48.6238, 48.6238, 48.6238,
        48.6238, 48.6238, 48.6238, 48.6238, 48.6238, 48.6238, 48.6238, 48.6238,
        48.6238, 48.6238, 48.6238, 48.6238], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 1.1763,  0.9983,  0.8350,  ...,  0.6714,  0.7477,  0.9599],
        [ 1.8399, 11.7579,  1.2054,  ...,  3.5253,  2.4019,  3.4766],
        [ 1.6947,  3.1519,  3.0986,  ...,  6.8078,  2.3254, 13.9485],
        ...,
        [ 3.3670,  2.2776,  2.0731,  ...,  2.3287,  1.8442,  1.9374],
        [ 0.2228,  1.9155,  1.1432,  ...,  2.2566,  2.0693,  2.3022],
        [ 0.9531,  1.0091,  0.7251,  ...,  0.2562,  1.4655,  0.3915]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 5.774938106536865
Var (shape: torch.Size([20, 64])) = tensor([[ 1.4589,  1.2382,  1.0356,  ...,  0.8327,  0.9273,  1.1905],
        [ 2.2819, 14.5828,  1.4950,  ...,  4.3723,  2.9790,  4.3118],
        [ 2.1019,  3.9091,  3.8430,  ...,  8.4434,  2.8841, 17.2997],
        ...,
        [ 4.1759,  2.8248,  2.5712,  ...,  2.8882,  2.2873,  2.4029],
        [ 0.2763,  2.3757,  1.4178,  ...,  2.7988,  2.5664,  2.8554],
        [ 1.1821,  1.2515,  0.8994,  ...,  0.3178,  1.8176,  0.4856]],
       device='cuda:0')
***********
SINR = tensor([-27.5927, -32.7176, -32.2268, -29.4036, -36.5913, -28.7187, -26.1535,
        -41.1814, -28.0687, -30.6012, -28.0501, -34.1412, -26.8670, -29.6315,
        -28.9776, -28.3507, -32.3158, -31.6101, -29.8319, -29.0927],
       device='cuda:0')
Real_SINR = tensor([-27.9681, -37.7645, -37.0329, -30.9773, -39.0149, -31.4672, -26.9331,
        -47.3083, -29.5406, -32.0772, -29.8915, -38.1433, -28.1812, -30.6517,
        -32.1117, -30.8660, -37.1103, -33.1115, -30.3769, -30.5459],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([1.7377e-03, 5.3458e-04, 5.9849e-04, 1.1459e-03, 2.1917e-04, 1.3414e-03,
        2.4188e-03, 7.6177e-05, 1.5576e-03, 8.6996e-04, 1.5643e-03, 3.8522e-04,
        2.0531e-03, 1.0874e-03, 1.2638e-03, 1.4598e-03, 5.8637e-04, 6.8974e-04,
        1.0384e-03, 1.2308e-03], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000,
        1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = -4,  rho_ul = 0.006220424539898394-----------
G_variance = tensor([1.0020, 1.0074, 0.9983, 1.0002, 1.0241, 1.0018, 0.9985, 0.9949, 1.0416,
        0.9836, 1.0060, 1.0114, 1.0228, 0.9953, 0.9774, 1.0175, 0.9749, 1.0035,
        1.0116, 1.0430], device='cuda:0')
G_hat_variance = tensor([0.2843, 0.2802, 0.2832, 0.2804, 0.2877, 0.2918, 0.2882, 0.2841, 0.2893,
        0.2846, 0.2793, 0.2883, 0.2864, 0.2884, 0.2781, 0.2867, 0.2800, 0.2885,
        0.2900, 0.2876], device='cuda:0')
G_tilde_var = tensor([0.7329, 0.7260, 0.6981, 0.7218, 0.7238, 0.7200, 0.7127, 0.7148, 0.7302,
        0.6981, 0.7211, 0.7084, 0.7177, 0.7149, 0.7209, 0.7180, 0.7144, 0.7133,
        0.7154, 0.7355], device='cuda:0')
gamma = tensor([[[0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
          0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
          0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
          0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
          0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
          0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
          0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847,
          0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847, 0.2847]]],
       device='cuda:0')
Z_mean = tensor([ 0.0040-0.0128j,  0.0139+0.0033j,  0.0114+0.0098j, -0.0174-0.0047j,
        -0.0028-0.0057j,  0.0150-0.0001j,  0.0044-0.0193j,  0.0144+0.0062j,
        -0.0047+0.0141j,  0.0013-0.0099j, -0.0006+0.0109j, -0.0187-0.0004j,
         0.0084-0.0018j, -0.0063-0.0110j,  0.0134+0.0114j,  0.0001-0.0049j,
         0.0168+0.0163j,  0.0103+0.0004j, -0.0085-0.0011j, -0.0037+0.0146j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9983, 0.9840, 0.9947, 0.9846, 1.0103, 1.0246, 1.0121, 0.9978, 1.0161,
        0.9995, 0.9808, 1.0124, 1.0058, 1.0128, 0.9765, 1.0070, 0.9835, 1.0130,
        1.0183, 1.0101], device='cuda:0')
Real_SNR = tensor([-3.3283, -3.4668, -2.9182, -3.8975, -3.6549, -3.7022, -3.2953, -4.1712,
        -3.8060, -3.7486, -3.7793, -3.6900, -3.3379, -3.1060, -3.2695, -3.5583,
        -3.8251, -3.4122, -3.7292, -3.3607], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([74.3712, 73.9022, 82.4616, 66.2995, 67.4227, 67.8490, 72.3116, 59.9049,
        65.7962, 67.9080, 67.8424, 69.2352, 75.0687, 77.1272, 75.6359, 72.0447,
        68.0776, 71.6606, 68.5802, 71.2186], device='cuda:0')
signal_var = tensor([0.4626, 0.4597, 0.5129, 0.4124, 0.4194, 0.4220, 0.4498, 0.3726, 0.4093,
        0.4224, 0.4220, 0.4307, 0.4670, 0.4798, 0.4705, 0.4481, 0.4235, 0.4458,
        0.4266, 0.4430], device='cuda:0')
w_var = tensor([0.9955, 1.0213, 1.0044, 1.0118, 0.9730, 0.9899, 0.9606, 0.9737, 0.9831,
        1.0014, 1.0075, 1.0073, 1.0071, 0.9809, 0.9989, 1.0168, 1.0217, 0.9780,
        1.0068, 0.9605], device='cuda:0')
y_var = tensor([1.4688, 1.4643, 1.5179, 1.4240, 1.3981, 1.4255, 1.4282, 1.3463, 1.3980,
        1.4468, 1.4270, 1.4316, 1.4603, 1.4474, 1.4697, 1.4351, 1.4676, 1.4375,
        1.4086, 1.4008], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([45.7762, 45.7762, 45.7762, 45.7762, 45.7762, 45.7762, 45.7762, 45.7762,
        45.7762, 45.7762, 45.7762, 45.7762, 45.7762, 45.7762, 45.7762, 45.7762,
        45.7762, 45.7762, 45.7762, 45.7762], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 1.0598,  0.2523,  6.4739,  ...,  1.4411,  1.8228,  6.3534],
        [18.2108, 28.1615,  1.5512,  ..., 10.2800,  0.4690,  3.7216],
        [ 2.0285,  1.0692,  1.4014,  ...,  3.7336,  4.1884,  3.5029],
        ...,
        [ 2.4723,  1.0225,  1.2082,  ...,  2.0666,  0.7842,  0.7947],
        [ 8.6593,  4.1312,  2.5190,  ...,  2.3536,  1.3348,  2.2753],
        [ 1.4118,  3.1121,  0.6359,  ...,  0.8834,  0.9374,  0.3886]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 6.567849159240723
Var (shape: torch.Size([20, 64])) = tensor([[ 1.3616,  0.3242,  8.3173,  ...,  1.8514,  2.3419,  8.1626],
        [23.3963, 36.1804,  1.9929,  ..., 13.2072,  0.6026,  4.7813],
        [ 2.6061,  1.3737,  1.8004,  ...,  4.7967,  5.3810,  4.5003],
        ...,
        [ 3.1763,  1.3137,  1.5523,  ...,  2.6551,  1.0075,  1.0210],
        [11.1250,  5.3075,  3.2363,  ...,  3.0237,  1.7149,  2.9232],
        [ 1.8138,  3.9982,  0.8170,  ...,  1.1349,  1.2044,  0.4993]],
       device='cuda:0')
***********
SINR = tensor([-29.1714, -34.0873, -29.4605, -26.0314, -29.5011, -29.6646, -29.6285,
        -42.0517, -25.7992, -28.6532, -26.4794, -26.0605, -26.7575, -29.2095,
        -28.3738, -25.4466, -28.5102, -28.1853, -30.5379, -27.0154],
       device='cuda:0')
Real_SINR = tensor([-32.4239, -39.7912, -32.8352, -26.6307, -31.5137, -32.9466, -34.8755,
        -48.7368, -27.4022, -30.9490, -27.7486, -27.7278, -29.0584, -31.2221,
        -30.7663, -26.4741, -30.7063, -31.5226, -33.0354, -28.2189],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([1.2087e-03, 3.9003e-04, 1.1310e-03, 2.4876e-03, 1.1205e-03, 1.0791e-03,
        1.0881e-03, 6.2345e-05, 2.6239e-03, 1.3617e-03, 2.2443e-03, 2.4710e-03,
        2.1054e-03, 1.1982e-03, 1.4521e-03, 2.8452e-03, 1.4072e-03, 1.5164e-03,
        8.8273e-04, 1.9843e-03], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000,
        1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = -3,  rho_ul = 0.007831050525426129-----------
G_variance = tensor([0.9797, 1.0022, 1.0109, 1.0051, 0.9783, 0.9960, 0.9867, 1.0016, 1.0000,
        1.0018, 0.9939, 1.0031, 0.9610, 1.0153, 0.9851, 0.9921, 1.0076, 1.0147,
        0.9956, 1.0017], device='cuda:0')
G_hat_variance = tensor([0.3216, 0.3293, 0.3373, 0.3313, 0.3302, 0.3330, 0.3303, 0.3363, 0.3364,
        0.3279, 0.3314, 0.3383, 0.3278, 0.3503, 0.3278, 0.3336, 0.3390, 0.3370,
        0.3354, 0.3297], device='cuda:0')
G_tilde_var = tensor([0.6642, 0.6689, 0.6746, 0.6614, 0.6460, 0.6733, 0.6610, 0.6609, 0.6692,
        0.6631, 0.6733, 0.6581, 0.6521, 0.6582, 0.6606, 0.6647, 0.6731, 0.6817,
        0.6614, 0.6718], device='cuda:0')
gamma = tensor([[[0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
          0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
          0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
          0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
          0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
          0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
          0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339,
          0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339, 0.3339]]],
       device='cuda:0')
Z_mean = tensor([-0.0041+0.0103j,  0.0019+0.0076j,  0.0078+0.0098j, -0.0041+0.0024j,
        -0.0158-0.0097j,  0.0006+0.0053j,  0.0051-0.0027j,  0.0050+0.0123j,
        -0.0068-0.0100j, -0.0066-0.0046j, -0.0033+0.0040j, -0.0087+0.0178j,
         0.0125+0.0092j,  0.0183+0.0001j, -0.0055-0.0155j,  0.0006+0.0009j,
        -0.0050+0.0132j, -0.0034+0.0070j,  0.0076+0.0122j, -0.0109-0.0021j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9634, 0.9862, 1.0102, 0.9923, 0.9891, 0.9974, 0.9892, 1.0075, 1.0075,
        0.9821, 0.9928, 1.0133, 0.9818, 1.0492, 0.9818, 0.9993, 1.0155, 1.0094,
        1.0047, 0.9875], device='cuda:0')
Real_SNR = tensor([-3.3355, -2.3240, -1.3705, -2.5029, -2.7270, -2.5692, -2.6621, -2.2766,
        -2.6650, -2.5278, -2.6168, -3.3477, -2.7616, -2.8206, -1.5848, -2.4801,
        -2.4743, -2.2980, -2.1748, -3.1367], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([60.6378, 76.3293, 92.9961, 73.1562, 68.1038, 68.6739, 64.6424, 73.8349,
        67.0567, 71.3825, 69.9121, 59.2148, 68.3817, 68.1185, 86.7453, 71.0457,
        71.3709, 76.8893, 78.5165, 62.2430], device='cuda:0')
signal_var = tensor([0.4749, 0.5977, 0.7283, 0.5729, 0.5333, 0.5378, 0.5062, 0.5782, 0.5251,
        0.5590, 0.5475, 0.4637, 0.5355, 0.5334, 0.6793, 0.5564, 0.5589, 0.6021,
        0.6149, 0.4874], device='cuda:0')
w_var = tensor([1.0236, 1.0207, 0.9985, 1.0194, 0.9993, 0.9717, 0.9344, 0.9767, 0.9700,
        1.0004, 1.0001, 1.0024, 1.0114, 1.0213, 0.9785, 0.9849, 0.9880, 1.0221,
        1.0145, 1.0037], device='cuda:0')
y_var = tensor([1.5090, 1.5942, 1.7304, 1.5979, 1.5380, 1.5004, 1.4701, 1.5790, 1.4599,
        1.5302, 1.5701, 1.4707, 1.5442, 1.5439, 1.6830, 1.5525, 1.5294, 1.6381,
        1.6374, 1.4852], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([42.6329, 42.6329, 42.6329, 42.6329, 42.6329, 42.6329, 42.6329, 42.6329,
        42.6329, 42.6329, 42.6329, 42.6329, 42.6329, 42.6329, 42.6329, 42.6329,
        42.6329, 42.6329, 42.6329, 42.6329], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 7.6415, 19.5981,  1.0400,  ...,  2.9677,  6.0134,  8.3555],
        [ 0.5760,  0.4770,  1.8173,  ...,  3.3206,  1.6709,  5.2720],
        [ 5.5366,  4.8058,  1.7638,  ...,  2.3596,  9.7007,  3.6108],
        ...,
        [ 3.7112,  6.8004,  5.9711,  ...,  2.7249,  5.0870, 20.8443],
        [ 0.8932,  1.2406,  3.5110,  ...,  0.4115,  0.7848,  0.7494],
        [ 0.5003,  0.2674,  0.3413,  ...,  1.6565,  1.1353,  0.2952]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 12.813496589660645
Var (shape: torch.Size([20, 64])) = tensor([[10.1926, 26.1412,  1.3872,  ...,  3.9585,  8.0211, 11.1451],
        [ 0.7683,  0.6363,  2.4240,  ...,  4.4293,  2.2288,  7.0321],
        [ 7.3850,  6.4103,  2.3526,  ...,  3.1473, 12.9394,  4.8162],
        ...,
        [ 4.9502,  9.0707,  7.9647,  ...,  3.6347,  6.7854, 27.8034],
        [ 1.1914,  1.6548,  4.6831,  ...,  0.5489,  1.0468,  0.9997],
        [ 0.6674,  0.3567,  0.4552,  ...,  2.2095,  1.5144,  0.3937]],
       device='cuda:0')
***********
SINR = tensor([-32.6499, -27.6566, -28.7587, -24.3646, -27.7823, -28.2396, -27.4137,
        -25.5210, -27.2780, -25.5320, -41.0143, -26.8139, -25.0001, -23.9109,
        -30.0767, -28.8895, -24.8436, -33.4174, -25.6552, -24.2595],
       device='cuda:0')
Real_SINR = tensor([-37.8308, -30.7051, -31.4733, -26.4614, -29.8971, -32.1389, -29.1807,
        -26.9459, -29.0522, -26.5004, -49.3314, -28.3913, -26.6461, -24.9080,
        -34.3601, -31.2144, -26.9790, -38.1890, -27.6750, -26.2786],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([5.4297e-04, 1.7124e-03, 1.3291e-03, 3.6472e-03, 1.6636e-03, 1.4976e-03,
        1.8107e-03, 2.7970e-03, 1.8680e-03, 2.7899e-03, 7.9165e-05, 2.0783e-03,
        3.1522e-03, 4.0471e-03, 9.8152e-04, 1.2897e-03, 3.2675e-03, 4.5505e-04,
        2.7120e-03, 3.7362e-03], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000,
        1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = -2,  rho_ul = 0.00985870850750302-----------
G_variance = tensor([0.9739, 1.0088, 1.0067, 0.9664, 1.0026, 0.9900, 0.9897, 1.0016, 0.9983,
        0.9887, 0.9905, 1.0083, 1.0256, 0.9995, 0.9896, 0.9902, 1.0124, 1.0023,
        1.0213, 1.0319], device='cuda:0')
G_hat_variance = tensor([0.3852, 0.3829, 0.3871, 0.3846, 0.3874, 0.3831, 0.3847, 0.3858, 0.3784,
        0.3826, 0.3833, 0.3862, 0.3996, 0.3847, 0.3902, 0.3925, 0.3823, 0.3910,
        0.3907, 0.4014], device='cuda:0')
G_tilde_var = tensor([0.6037, 0.6289, 0.6288, 0.6030, 0.6191, 0.6106, 0.6149, 0.6118, 0.6346,
        0.6120, 0.5938, 0.6165, 0.6178, 0.6089, 0.6119, 0.6096, 0.6140, 0.6091,
        0.6153, 0.6142], device='cuda:0')
gamma = tensor([[[0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
          0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
          0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
          0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
          0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
          0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
          0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869,
          0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869, 0.3869]]],
       device='cuda:0')
Z_mean = tensor([-0.0198-0.0082j, -0.0040-0.0169j,  0.0043+0.0169j,  0.0061+0.0132j,
         0.0163+0.0075j, -0.0142+0.0215j, -0.0088+0.0085j, -0.0025+0.0022j,
         0.0186-0.0209j, -0.0011-0.0073j,  0.0069+0.0069j,  0.0046+0.0017j,
         0.0092-0.0153j,  0.0271+0.0278j,  0.0026+0.0039j,  0.0085+0.0152j,
        -0.0022-0.0038j, -0.0022-0.0191j,  0.0039-0.0019j, -0.0068+0.0065j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9956, 0.9898, 1.0006, 0.9941, 1.0014, 0.9904, 0.9943, 0.9972, 0.9782,
        0.9890, 0.9907, 0.9982, 1.0330, 0.9945, 1.0087, 1.0145, 0.9882, 1.0106,
        1.0100, 1.0377], device='cuda:0')
Real_SNR = tensor([-1.3512, -1.8911, -0.5914, -2.1849, -1.1463, -1.5045, -1.3701, -1.6118,
        -1.6674, -1.5280, -1.7569, -1.3809, -1.4727, -1.7792, -1.4773, -1.7877,
        -1.3988, -0.8631, -1.8244, -1.8627], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([72.6710, 66.2028, 87.1154, 62.3769, 75.6720, 71.4926, 74.6177, 69.6511,
        70.0580, 70.5505, 68.1952, 74.1403, 71.3425, 69.2054, 70.2088, 67.7566,
        72.3841, 83.1391, 67.2015, 67.6885], device='cuda:0')
signal_var = tensor([0.7164, 0.6527, 0.8588, 0.6150, 0.7460, 0.7048, 0.7356, 0.6867, 0.6907,
        0.6955, 0.6723, 0.7309, 0.7033, 0.6823, 0.6922, 0.6680, 0.7136, 0.8196,
        0.6625, 0.6673], device='cuda:0')
w_var = tensor([0.9779, 1.0088, 0.9841, 1.0170, 0.9714, 0.9966, 1.0085, 0.9952, 1.0140,
        0.9888, 1.0076, 1.0045, 0.9873, 1.0277, 0.9726, 1.0082, 0.9848, 0.9998,
        1.0084, 1.0247], device='cuda:0')
y_var = tensor([1.7007, 1.6656, 1.8388, 1.6455, 1.7231, 1.7335, 1.7587, 1.7001, 1.6977,
        1.7264, 1.6814, 1.7172, 1.7105, 1.7167, 1.6816, 1.6745, 1.6206, 1.7831,
        1.6875, 1.6609], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([39.2408, 39.2408, 39.2408, 39.2408, 39.2408, 39.2408, 39.2408, 39.2408,
        39.2408, 39.2408, 39.2408, 39.2408, 39.2408, 39.2408, 39.2408, 39.2408,
        39.2408, 39.2408, 39.2408, 39.2408], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[1.3255, 2.6379, 2.9788,  ..., 2.0760, 4.1384, 1.9235],
        [0.4131, 0.7743, 0.9914,  ..., 1.2048, 0.4406, 0.6937],
        [9.0336, 0.2213, 2.9969,  ..., 0.8382, 0.6360, 1.1743],
        ...,
        [9.6429, 1.3487, 3.3851,  ..., 2.3878, 8.2916, 3.6457],
        [1.8263, 0.5968, 2.9887,  ..., 1.3127, 0.8969, 2.1528],
        [0.5922, 0.4464, 1.2378,  ..., 0.3177, 0.5913, 1.1074]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 2.5486245155334473
Var (shape: torch.Size([20, 64])) = tensor([[ 1.8383,  3.6585,  4.1311,  ...,  2.8791,  5.7393,  2.6677],
        [ 0.5729,  1.0738,  1.3749,  ...,  1.6709,  0.6110,  0.9621],
        [12.5284,  0.3070,  4.1563,  ...,  1.1625,  0.8821,  1.6286],
        ...,
        [13.3734,  1.8705,  4.6947,  ...,  3.3115, 11.4993,  5.0561],
        [ 2.5329,  0.8277,  4.1450,  ...,  1.8206,  1.2438,  2.9856],
        [ 0.8213,  0.6191,  1.7166,  ...,  0.4405,  0.8201,  1.5358]],
       device='cuda:0')
***********
SINR = tensor([-29.5179, -23.3341, -25.1616, -23.3815, -23.5425, -22.4594, -22.0664,
        -27.0735, -24.8354, -25.6041, -28.5569, -26.3791, -31.1367, -30.4644,
        -30.7032, -24.8963, -23.2488, -28.6215, -25.0201, -22.2223],
       device='cuda:0')
Real_SINR = tensor([-31.2732, -24.4271, -28.7024, -25.2230, -24.0588, -23.8013, -23.4564,
        -29.5744, -26.3446, -27.7974, -31.8004, -30.2239, -35.8038, -33.2477,
        -34.0266, -27.6383, -24.5961, -30.9727, -27.8257, -22.1669],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0011, 0.0046, 0.0030, 0.0046, 0.0044, 0.0056, 0.0062, 0.0020, 0.0033,
        0.0027, 0.0014, 0.0023, 0.0008, 0.0009, 0.0008, 0.0032, 0.0047, 0.0014,
        0.0031, 0.0060], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000, 1000, 1000, 1000, 1000,  983,  976, 1000, 1000, 1000, 1000, 1000,
        1000, 1000, 1000, 1000,  999, 1000, 1000,  979], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = -1,  rho_ul = 0.012411378667566898-----------
G_variance = tensor([0.9782, 0.9743, 1.0101, 0.9871, 1.0008, 0.9849, 1.0008, 1.0076, 0.9895,
        0.9994, 0.9752, 0.9971, 0.9918, 1.0066, 0.9896, 0.9923, 1.0309, 0.9825,
        0.9954, 1.0331], device='cuda:0')
G_hat_variance = tensor([0.4439, 0.4362, 0.4482, 0.4252, 0.4304, 0.4322, 0.4417, 0.4400, 0.4351,
        0.4315, 0.4331, 0.4337, 0.4398, 0.4496, 0.4449, 0.4336, 0.4536, 0.4292,
        0.4449, 0.4520], device='cuda:0')
G_tilde_var = tensor([0.5392, 0.5564, 0.5568, 0.5727, 0.5611, 0.5531, 0.5684, 0.5631, 0.5514,
        0.5628, 0.5457, 0.5569, 0.5455, 0.5462, 0.5602, 0.5510, 0.5649, 0.5651,
        0.5745, 0.5641], device='cuda:0')
gamma = tensor([[[0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
          0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
          0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
          0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
          0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
          0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
          0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427,
          0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427, 0.4427]]],
       device='cuda:0')
Z_mean = tensor([ 0.0033-0.0064j,  0.0002+0.0065j, -0.0128+0.0196j,  0.0040+0.0135j,
        -0.0055-0.0088j, -0.0039-0.0067j,  0.0195+0.0044j, -0.0043+0.0097j,
        -0.0006-0.0085j,  0.0058-0.0016j,  0.0027-0.0008j, -0.0041-0.0099j,
         0.0093+0.0239j,  0.0260-0.0016j, -0.0102-0.0025j, -0.0060-0.0152j,
         0.0022-0.0126j,  0.0127-0.0061j, -0.0173-0.0112j,  0.0080+0.0106j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0027, 0.9854, 1.0124, 0.9606, 0.9721, 0.9763, 0.9978, 0.9940, 0.9829,
        0.9748, 0.9784, 0.9796, 0.9934, 1.0155, 1.0051, 0.9794, 1.0247, 0.9696,
        1.0051, 1.0209], device='cuda:0')
Real_SNR = tensor([-0.2963, -1.1549,  0.2370, -0.8483, -0.8308, -0.6498, -0.9394, -0.6979,
        -0.4587, -0.7285, -0.6803, -0.6209, -0.4557, -0.2562,  0.0233, -0.8339,
        -0.7856, -0.5176, -0.8473, -0.5774], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([76.2990, 60.0966, 86.9848, 65.7816, 68.5272, 70.7852, 66.7349, 67.6942,
        73.1808, 71.7348, 68.8938, 69.0871, 73.1161, 73.3759, 78.3947, 67.4884,
        65.5387, 72.3903, 67.9902, 70.4589], device='cuda:0')
signal_var = tensor([0.9470, 0.7459, 1.0796, 0.8164, 0.8505, 0.8785, 0.8283, 0.8402, 0.9083,
        0.8903, 0.8551, 0.8575, 0.9075, 0.9107, 0.9730, 0.8376, 0.8134, 0.8985,
        0.8439, 0.8745], device='cuda:0')
w_var = tensor([1.0138, 0.9731, 1.0223, 0.9926, 1.0298, 1.0203, 1.0283, 0.9867, 1.0095,
        1.0529, 1.0001, 0.9893, 1.0079, 0.9660, 0.9678, 1.0149, 0.9747, 1.0122,
        1.0257, 0.9989], device='cuda:0')
y_var = tensor([1.9383, 1.7200, 2.1162, 1.8178, 1.8996, 1.9409, 1.8895, 1.8178, 1.8914,
        1.9881, 1.8703, 1.8931, 1.8872, 1.8976, 1.9744, 1.8116, 1.7940, 1.9598,
        1.8784, 1.8461], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([35.6679, 35.6679, 35.6679, 35.6679, 35.6679, 35.6679, 35.6679, 35.6679,
        35.6679, 35.6679, 35.6679, 35.6679, 35.6679, 35.6679, 35.6679, 35.6679,
        35.6679, 35.6679, 35.6679, 35.6679], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 0.6871,  0.1778,  0.8283,  ...,  1.2130,  0.2951,  0.9846],
        [ 1.1018,  2.0282,  3.7556,  ...,  0.2706,  1.1168,  0.9644],
        [ 0.4884,  0.2793,  0.8781,  ...,  1.6708,  0.4977,  1.1045],
        ...,
        [ 3.7807,  4.1178,  4.3776,  ...,  3.0381,  1.5529, 11.4572],
        [ 0.4134,  0.4039,  1.7810,  ...,  0.6015,  0.3885,  2.3239],
        [ 7.8127,  0.9988,  6.7173,  ...,  7.9131,  1.4235, 11.2783]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 2.344787359237671
Var (shape: torch.Size([20, 64])) = tensor([[ 0.9912,  0.2565,  1.1950,  ...,  1.7500,  0.4258,  1.4205],
        [ 1.5896,  2.9260,  5.4182,  ...,  0.3903,  1.6112,  1.3914],
        [ 0.7046,  0.4029,  1.2668,  ...,  2.4105,  0.7181,  1.5934],
        ...,
        [ 5.4543,  5.9407,  6.3155,  ...,  4.3830,  2.2403, 16.5291],
        [ 0.5964,  0.5827,  2.5695,  ...,  0.8677,  0.5605,  3.3526],
        [11.2713,  1.4409,  9.6910,  ..., 11.4161,  2.0537, 16.2711]],
       device='cuda:0')
***********
SINR = tensor([-21.8632, -22.5605, -24.2085, -20.7107, -25.4025, -27.3077, -25.7782,
        -21.5485, -22.6738, -24.7934, -21.6261, -22.8144, -25.1752, -24.8160,
        -28.0948, -24.6010, -23.6704, -27.8521, -21.7214, -29.2943],
       device='cuda:0')
Real_SINR = tensor([-24.6155, -24.7088, -28.5051, -22.0663, -28.3823, -29.5031, -27.4360,
        -22.4836, -23.8790, -27.6819, -23.2066, -24.1399, -28.0341, -27.6311,
        -30.4827, -28.6134, -25.2791, -31.5418, -23.4693, -33.5223],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0065, 0.0055, 0.0038, 0.0084, 0.0029, 0.0019, 0.0026, 0.0070, 0.0054,
        0.0033, 0.0068, 0.0052, 0.0030, 0.0033, 0.0015, 0.0035, 0.0043, 0.0016,
        0.0067, 0.0012], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 972,  985, 1000,  949, 1000, 1000, 1000,  966,  988, 1000,  967,  990,
        1000, 1000, 1000, 1000, 1000, 1000,  969, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 0,  rho_ul = 0.015625-----------
G_variance = tensor([1.0117, 1.0038, 0.9777, 0.9957, 1.0137, 0.9886, 0.9997, 1.0014, 0.9826,
        0.9928, 0.9864, 0.9845, 1.0060, 0.9765, 0.9949, 0.9965, 0.9995, 0.9958,
        0.9789, 1.0004], device='cuda:0')
G_hat_variance = tensor([0.4960, 0.4996, 0.5020, 0.4972, 0.5076, 0.4814, 0.4926, 0.4913, 0.5067,
        0.4976, 0.4836, 0.4972, 0.5117, 0.4980, 0.4984, 0.4971, 0.5027, 0.5046,
        0.4970, 0.4979], device='cuda:0')
G_tilde_var = tensor([0.5086, 0.5036, 0.4968, 0.4988, 0.5071, 0.5012, 0.5032, 0.5006, 0.4916,
        0.4952, 0.5053, 0.4964, 0.5124, 0.4921, 0.5040, 0.4976, 0.4999, 0.4983,
        0.4834, 0.5044], device='cuda:0')
gamma = tensor([[[0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
          0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
          0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
          0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
          0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
          0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
          0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000,
          0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000, 0.5000]]],
       device='cuda:0')
Z_mean = tensor([-0.0280-0.0022j,  0.0033-0.0023j,  0.0098-0.0096j,  0.0109+0.0211j,
        -0.0052-0.0056j,  0.0026-0.0022j,  0.0144+0.0010j, -0.0065+0.0027j,
        -0.0081-0.0108j,  0.0153+0.0021j,  0.0021-0.0103j,  0.0115-0.0214j,
         0.0238+0.0107j,  0.0053-0.0089j,  0.0029+0.0071j,  0.0104+0.0003j,
        -0.0113-0.0109j, -0.0008+0.0095j,  0.0123+0.0006j,  0.0001+0.0046j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9921, 0.9991, 1.0039, 0.9945, 1.0151, 0.9627, 0.9852, 0.9826, 1.0134,
        0.9951, 0.9671, 0.9945, 1.0234, 0.9961, 0.9968, 0.9943, 1.0054, 1.0093,
        0.9941, 0.9959], device='cuda:0')
Real_SNR = tensor([-0.1384,  0.5100,  1.3201,  0.7480,  0.6663, -0.0163,  0.0696,  0.1088,
         0.8876,  0.4479, -0.1506,  0.1376, -0.0116,  0.1683,  1.2285, -0.1072,
         0.5895,  0.2142,  0.5550, -0.3544], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([61.9410, 71.4561, 86.8554, 75.9281, 73.4371, 62.9028, 63.6264, 65.5317,
        76.3451, 70.8049, 60.9441, 64.8918, 65.2406, 67.7905, 81.8210, 61.9301,
        71.4968, 65.0693, 72.6127, 58.5629], device='cuda:0')
signal_var = tensor([0.9678, 1.1165, 1.3571, 1.1864, 1.1475, 0.9829, 0.9942, 1.0239, 1.1929,
        1.1063, 0.9523, 1.0139, 1.0194, 1.0592, 1.2785, 0.9677, 1.1171, 1.0167,
        1.1346, 0.9150], device='cuda:0')
w_var = tensor([0.9992, 0.9928, 1.0014, 0.9987, 0.9843, 0.9865, 0.9784, 0.9986, 0.9724,
        0.9979, 0.9859, 0.9823, 1.0221, 1.0190, 0.9635, 0.9918, 0.9753, 0.9678,
        0.9985, 0.9929], device='cuda:0')
y_var = tensor([2.0135, 2.0623, 2.3471, 2.2240, 2.1328, 1.9670, 1.9063, 2.0432, 2.1138,
        2.1185, 1.9361, 1.9825, 2.0292, 2.0597, 2.2532, 1.9394, 2.0568, 2.0180,
        2.0540, 1.8951], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([32., 32., 32., 32., 32., 32., 32., 32., 32., 32., 32., 32., 32., 32.,
        32., 32., 32., 32., 32., 32.], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[0.6862, 0.6191, 0.5429,  ..., 0.6433, 0.2914, 0.3187],
        [0.7194, 2.6173, 0.5288,  ..., 0.6912, 1.1791, 2.1860],
        [0.6184, 0.4091, 1.0172,  ..., 0.4636, 1.6063, 1.6453],
        ...,
        [0.9733, 5.6800, 2.7076,  ..., 0.5367, 2.6579, 1.2545],
        [1.8384, 2.7101, 1.0437,  ..., 2.8426, 1.0555, 2.4202],
        [9.2853, 0.7782, 2.0765,  ..., 0.4408, 0.6188, 2.0156]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 4.2084784507751465
Var (shape: torch.Size([20, 64])) = tensor([[ 1.0293,  0.9286,  0.8143,  ...,  0.9650,  0.4371,  0.4781],
        [ 1.0790,  3.9259,  0.7932,  ...,  1.0368,  1.7687,  3.2789],
        [ 0.9275,  0.6137,  1.5258,  ...,  0.6953,  2.4095,  2.4679],
        ...,
        [ 1.4599,  8.5201,  4.0615,  ...,  0.8051,  3.9868,  1.8818],
        [ 2.7576,  4.0651,  1.5656,  ...,  4.2639,  1.5833,  3.6304],
        [13.9279,  1.1673,  3.1148,  ...,  0.6612,  0.9283,  3.0234]],
       device='cuda:0')
***********
SINR = tensor([-18.8952, -22.5898, -20.2511, -23.5100, -22.4639, -19.9525, -23.1342,
        -21.7985, -23.9262, -33.5894, -19.8518, -19.8517, -23.3456, -18.4500,
        -24.0057, -19.8020, -20.3252, -24.4478, -21.8426, -25.1125],
       device='cuda:0')
Real_SINR = tensor([-19.0654, -24.2553, -21.3731, -25.2748, -24.2555, -20.7269, -24.5516,
        -22.7250, -25.4809, -40.9319, -21.8473, -21.4259, -25.2949, -18.8426,
        -27.3959, -21.5352, -20.8429, -29.0047, -23.6160, -29.5853],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0127, 0.0055, 0.0094, 0.0044, 0.0056, 0.0100, 0.0048, 0.0066, 0.0040,
        0.0004, 0.0102, 0.0102, 0.0046, 0.0141, 0.0040, 0.0104, 0.0092, 0.0036,
        0.0065, 0.0031], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 911,  986,  939, 1000,  984,  933,  996,  971, 1000, 1000,  931,  931,
        1000,  901, 1000,  930,  941, 1000,  971, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 1,  rho_ul = 0.019670709559283864-----------
G_variance = tensor([1.0132, 1.0034, 0.9956, 1.0116, 0.9958, 1.0224, 1.0248, 0.9689, 0.9674,
        0.9922, 0.9997, 1.0019, 1.0285, 1.0172, 0.9707, 1.0278, 1.0071, 1.0057,
        0.9970, 1.0167], device='cuda:0')
G_hat_variance = tensor([0.5673, 0.5488, 0.5575, 0.5602, 0.5584, 0.5552, 0.5698, 0.5396, 0.5510,
        0.5562, 0.5538, 0.5570, 0.5725, 0.5785, 0.5413, 0.5538, 0.5611, 0.5454,
        0.5563, 0.5617], device='cuda:0')
G_tilde_var = tensor([0.4379, 0.4415, 0.4378, 0.4393, 0.4416, 0.4518, 0.4463, 0.4406, 0.4246,
        0.4308, 0.4433, 0.4469, 0.4447, 0.4367, 0.4292, 0.4545, 0.4364, 0.4521,
        0.4284, 0.4440], device='cuda:0')
gamma = tensor([[[0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
          0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
          0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
          0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
          0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
          0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
          0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573,
          0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573, 0.5573]]],
       device='cuda:0')
Z_mean = tensor([ 0.0060-6.5679e-03j,  0.0204-1.1105e-02j,  0.0050-3.0090e-04j,
        -0.0010-2.1355e-02j,  0.0050+8.8787e-03j,  0.0030-4.7081e-03j,
         0.0035-4.1209e-03j, -0.0030+1.7826e-02j,  0.0036+1.3567e-02j,
        -0.0152-2.8145e-03j,  0.0081+4.4146e-05j, -0.0031+3.2960e-03j,
        -0.0029-5.3297e-03j, -0.0085-9.4946e-03j,  0.0045-2.6062e-02j,
        -0.0019-1.9176e-03j, -0.0013-5.9594e-04j, -0.0125+4.9541e-03j,
         0.0198-5.7539e-03j, -0.0115+9.7727e-03j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0179, 0.9847, 1.0003, 1.0053, 1.0019, 0.9961, 1.0225, 0.9683, 0.9887,
        0.9981, 0.9936, 0.9994, 1.0273, 1.0380, 0.9712, 0.9936, 1.0068, 0.9787,
        0.9982, 1.0078], device='cuda:0')
Real_SNR = tensor([1.5149, 1.9168, 2.1888, 0.8972, 1.1778, 1.3665, 1.4556, 1.9984, 1.0288,
        0.6535, 1.5317, 1.6440, 1.8344, 1.7836, 1.9087, 1.5741, 1.3154, 1.9388,
        1.6911, 0.7989], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([70.0454, 77.7197, 82.9086, 64.3579, 67.1637, 69.8085, 69.9453, 79.8192,
        65.6264, 61.1259, 74.8447, 76.7807, 76.9961, 77.5118, 78.6722, 71.5897,
        67.9565, 77.4570, 72.2610, 60.4748], device='cuda:0')
signal_var = tensor([1.3778, 1.5288, 1.6309, 1.2660, 1.3212, 1.3732, 1.3759, 1.5701, 1.2909,
        1.2024, 1.4722, 1.5103, 1.5146, 1.5247, 1.5475, 1.4082, 1.3368, 1.5236,
        1.4214, 1.1896], device='cuda:0')
w_var = tensor([0.9721, 0.9833, 0.9852, 1.0297, 1.0073, 1.0025, 0.9841, 0.9910, 1.0186,
        1.0344, 1.0347, 1.0344, 0.9928, 1.0112, 0.9972, 0.9801, 0.9874, 0.9750,
        0.9630, 0.9897], device='cuda:0')
y_var = tensor([2.3513, 2.4434, 2.5833, 2.2536, 2.3403, 2.3875, 2.3098, 2.5254, 2.2795,
        2.2361, 2.5379, 2.5443, 2.4624, 2.5818, 2.5840, 2.4113, 2.2912, 2.4689,
        2.3222, 2.2168], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([28.3321, 28.3321, 28.3321, 28.3321, 28.3321, 28.3321, 28.3321, 28.3321,
        28.3321, 28.3321, 28.3321, 28.3321, 28.3321, 28.3321, 28.3321, 28.3321,
        28.3321, 28.3321, 28.3321, 28.3321], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 3.5847,  1.1925,  2.1705,  ...,  0.6880,  4.2595,  0.8204],
        [ 8.6128,  0.8556,  1.6988,  ...,  6.2344,  1.1175,  2.5214],
        [ 0.9038,  1.3594,  2.4814,  ...,  1.1826,  1.1950,  0.7600],
        ...,
        [ 0.6621,  3.0412,  2.7336,  ..., 18.7650, 12.1651, 10.2027],
        [ 5.4753,  2.5403,  1.1131,  ...,  2.0923,  4.5023,  2.1027],
        [ 1.6921,  0.2472,  1.3345,  ...,  1.5854,  0.4153,  0.9787]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 6.993510723114014
Var (shape: torch.Size([20, 64])) = tensor([[ 5.5824,  1.8571,  3.3801,  ...,  1.0714,  6.6334,  1.2776],
        [13.4128,  1.3324,  2.6456,  ...,  9.7089,  1.7403,  3.9266],
        [ 1.4075,  2.1170,  3.8643,  ...,  1.8418,  1.8610,  1.1835],
        ...,
        [ 1.0312,  4.7360,  4.2571,  ..., 29.2230, 18.9448, 15.8889],
        [ 8.5268,  3.9560,  1.7334,  ...,  3.2584,  7.0115,  3.2746],
        [ 2.6351,  0.3849,  2.0782,  ...,  2.4690,  0.6468,  1.5242]],
       device='cuda:0')
***********
SINR = tensor([-21.7037, -25.1413, -22.5257, -18.3376, -34.9849, -26.6978, -25.2203,
        -19.4384, -24.5593, -20.2931, -28.2961, -25.1601, -17.9773, -20.2360,
        -21.6331, -21.0208, -18.3389, -28.4328, -24.6204, -19.2135],
       device='cuda:0')
Real_SINR = tensor([-25.4538, -28.6752, -23.8349, -18.5909, -39.9305, -33.0283, -31.5739,
        -22.6002, -27.4820, -21.5433, -36.1335, -29.8205, -19.2679, -21.7638,
        -23.4849, -23.3813, -20.0096, -29.7940, -26.6806, -20.9577],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0067, 0.0031, 0.0056, 0.0145, 0.0003, 0.0021, 0.0030, 0.0113, 0.0035,
        0.0093, 0.0015, 0.0030, 0.0157, 0.0094, 0.0068, 0.0078, 0.0144, 0.0014,
        0.0034, 0.0118], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 969, 1000,  985,  898, 1000, 1000, 1000,  922, 1000,  940, 1000, 1000,
         891,  939,  967,  955,  899, 1000, 1000,  917], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 2,  rho_ul = 0.0247639561322049-----------
G_variance = tensor([0.9813, 0.9799, 0.9938, 0.9925, 1.0258, 1.0098, 0.9945, 1.0015, 1.0064,
        1.0064, 0.9601, 1.0171, 1.0298, 0.9791, 0.9985, 0.9707, 0.9997, 0.9755,
        1.0154, 1.0011], device='cuda:0')
G_hat_variance = tensor([0.6137, 0.6010, 0.6225, 0.6110, 0.6381, 0.6180, 0.6060, 0.6102, 0.6123,
        0.6168, 0.5978, 0.6148, 0.6259, 0.6070, 0.6087, 0.6105, 0.6035, 0.6098,
        0.6090, 0.6173], device='cuda:0')
G_tilde_var = tensor([0.3837, 0.3843, 0.3903, 0.3870, 0.3944, 0.3982, 0.3830, 0.3858, 0.3912,
        0.3831, 0.3750, 0.3905, 0.3967, 0.3889, 0.3898, 0.3827, 0.3957, 0.3787,
        0.3956, 0.3820], device='cuda:0')
gamma = tensor([[[0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
          0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
          0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
          0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
          0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
          0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
          0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131,
          0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131, 0.6131]]],
       device='cuda:0')
Z_mean = tensor([-0.0215+0.0008j, -0.0165+0.0106j,  0.0111+0.0111j, -0.0138+0.0122j,
        -0.0122+0.0072j,  0.0026+0.0002j,  0.0049+0.0109j,  0.0020-0.0060j,
         0.0043+0.0035j, -0.0006-0.0030j, -0.0005+0.0121j, -0.0151-0.0023j,
         0.0054-0.0030j, -0.0024+0.0051j, -0.0236+0.0139j,  0.0037+0.0198j,
         0.0090+0.0101j, -0.0099+0.0046j, -0.0028-0.0041j,  0.0062+0.0260j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0009, 0.9802, 1.0153, 0.9965, 1.0406, 1.0079, 0.9883, 0.9953, 0.9987,
        1.0059, 0.9751, 1.0027, 1.0209, 0.9899, 0.9928, 0.9957, 0.9843, 0.9945,
        0.9933, 1.0068], device='cuda:0')
Real_SNR = tensor([2.0428, 2.7129, 3.9284, 2.7679, 2.3217, 2.2947, 2.9126, 1.7751, 2.3270,
        2.2222, 2.0327, 2.6346, 2.7544, 1.7804, 2.0300, 1.5742, 2.3991, 2.7934,
        2.7523, 2.5522], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([64.1251, 76.2929, 98.1184, 75.9225, 67.6551, 68.4311, 79.7678, 63.4369,
        69.1717, 68.7580, 65.7186, 72.7629, 75.7328, 60.6457, 62.0226, 57.8838,
        69.6700, 75.2234, 79.2280, 71.4523], device='cuda:0')
signal_var = tensor([1.5880, 1.8893, 2.4298, 1.8801, 1.6754, 1.6946, 1.9754, 1.5709, 1.7130,
        1.7027, 1.6275, 1.8019, 1.8754, 1.5018, 1.5359, 1.4334, 1.7253, 1.8628,
        1.9620, 1.7694], device='cuda:0')
w_var = tensor([0.9921, 1.0116, 0.9834, 0.9940, 0.9816, 0.9991, 1.0102, 1.0439, 1.0024,
        1.0208, 1.0192, 0.9824, 0.9946, 0.9967, 0.9624, 0.9976, 0.9930, 0.9791,
        1.0410, 0.9831], device='cuda:0')
y_var = tensor([2.6156, 2.9445, 3.3019, 2.8884, 2.7018, 2.7235, 2.9875, 2.5484, 2.8257,
        2.7312, 2.6162, 2.8231, 2.8805, 2.4468, 2.4523, 2.4021, 2.7129, 2.8697,
        2.8982, 2.8124], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([24.7592, 24.7592, 24.7592, 24.7592, 24.7592, 24.7592, 24.7592, 24.7592,
        24.7592, 24.7592, 24.7592, 24.7592, 24.7592, 24.7592, 24.7592, 24.7592,
        24.7592, 24.7592, 24.7592, 24.7592], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 0.4020,  0.3599,  1.3347,  ...,  1.0559,  0.6980,  0.2945],
        [ 1.1122,  0.8288,  1.3913,  ...,  1.5148,  0.9497,  0.2330],
        [ 1.6855,  2.3620,  2.1705,  ...,  2.5604,  1.5033,  1.9691],
        ...,
        [ 1.1882,  2.9938,  0.6122,  ...,  1.1739,  0.8988,  1.4763],
        [ 0.8323, 13.6996,  0.2714,  ...,  1.1937,  2.8522,  0.6489],
        [ 1.6407,  2.0252,  1.8203,  ...,  5.0930, 12.2915,  2.4476]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 3.237651824951172
Var (shape: torch.Size([20, 64])) = tensor([[ 0.6485,  0.5805,  2.1531,  ...,  1.7033,  1.1259,  0.4751],
        [ 1.7942,  1.3370,  2.2443,  ...,  2.4436,  1.5319,  0.3759],
        [ 2.7190,  3.8103,  3.5013,  ...,  4.1303,  2.4250,  3.1764],
        ...,
        [ 1.9167,  4.8294,  0.9876,  ...,  1.8937,  1.4498,  2.3815],
        [ 1.3426, 22.0993,  0.4378,  ...,  1.9255,  4.6009,  1.0468],
        [ 2.6467,  3.2669,  2.9364,  ...,  8.2156, 19.8278,  3.9484]],
       device='cuda:0')
***********
SINR = tensor([-18.0501, -19.8502, -19.9448, -18.5935, -22.2243, -25.9207, -25.9122,
        -19.2358, -17.7961, -25.0420, -21.5360, -23.3273, -20.1430, -17.8113,
        -17.0422, -22.8893, -18.9409, -18.4528, -20.7739, -22.2627],
       device='cuda:0')
Real_SINR = tensor([-19.7450, -22.0049, -21.6802, -20.8488, -25.8600, -31.9764, -29.9016,
        -20.3529, -18.8370, -27.1435, -22.7030, -28.9895, -22.2986, -19.1325,
        -17.0107, -26.1920, -21.2276, -19.7114, -25.3246, -26.2000],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0154, 0.0102, 0.0100, 0.0136, 0.0060, 0.0026, 0.0026, 0.0118, 0.0163,
        0.0031, 0.0070, 0.0046, 0.0096, 0.0163, 0.0194, 0.0051, 0.0126, 0.0141,
        0.0083, 0.0059], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 892,  931,  933,  904,  979, 1000, 1000,  918,  886, 1000,  965, 1000,
         937,  887,  869,  992,  912,  901,  950,  980], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 3,  rho_ul = 0.031175973671388742-----------
G_variance = tensor([1.0044, 0.9625, 0.9884, 0.9959, 1.0084, 0.9944, 0.9845, 1.0004, 1.0345,
        1.0026, 1.0050, 1.0075, 1.0053, 1.0031, 1.0252, 0.9604, 0.9934, 0.9808,
        0.9837, 0.9867], device='cuda:0')
G_hat_variance = tensor([0.6777, 0.6420, 0.6743, 0.6649, 0.6734, 0.6759, 0.6562, 0.6736, 0.6751,
        0.6645, 0.6841, 0.6762, 0.6812, 0.6608, 0.6776, 0.6478, 0.6632, 0.6581,
        0.6491, 0.6540], device='cuda:0')
G_tilde_var = tensor([0.3237, 0.3288, 0.3270, 0.3367, 0.3336, 0.3252, 0.3362, 0.3284, 0.3377,
        0.3438, 0.3341, 0.3389, 0.3298, 0.3310, 0.3395, 0.3287, 0.3313, 0.3344,
        0.3266, 0.3287], device='cuda:0')
gamma = tensor([[[0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
          0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
          0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
          0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
          0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
          0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
          0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661,
          0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661, 0.6661]]],
       device='cuda:0')
Z_mean = tensor([ 0.0058-1.0081e-03j, -0.0134+4.2860e-03j,  0.0033-2.0217e-03j,
         0.0033+1.7448e-02j, -0.0040-6.3991e-03j, -0.0026-3.7999e-03j,
        -0.0097-1.9556e-03j, -0.0131+1.4783e-02j,  0.0049-7.8727e-03j,
        -0.0069-8.9876e-03j, -0.0021-1.2513e-03j, -0.0215-6.9921e-03j,
        -0.0149-9.5344e-03j,  0.0032+9.8717e-05j, -0.0015-5.7234e-03j,
         0.0041-1.4267e-04j,  0.0166-7.5769e-03j,  0.0005-1.2632e-02j,
        -0.0019-3.2588e-02j,  0.0052-1.5855e-03j], device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0174, 0.9638, 1.0122, 0.9982, 1.0108, 1.0147, 0.9851, 1.0112, 1.0135,
        0.9975, 1.0270, 1.0151, 1.0226, 0.9920, 1.0172, 0.9725, 0.9956, 0.9879,
        0.9744, 0.9818], device='cuda:0')
Real_SNR = tensor([3.7405, 3.2609, 4.4513, 3.8498, 3.2052, 2.8098, 3.2471, 3.5372, 3.2475,
        3.1493, 3.5345, 3.5703, 3.3318, 3.6834, 4.6259, 3.4404, 2.9981, 3.8748,
        4.0072, 2.8546], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([74.4845, 69.6728, 89.6854, 79.9924, 67.6853, 62.0881, 65.9861, 73.3668,
        68.0318, 67.0533, 71.5094, 71.9048, 68.7581, 75.1638, 92.8351, 70.7547,
        63.6731, 76.5164, 81.0884, 60.9661], device='cuda:0')
signal_var = tensor([2.3221, 2.1721, 2.7960, 2.4938, 2.1102, 1.9357, 2.0572, 2.2873, 2.1210,
        2.0905, 2.2294, 2.2417, 2.1436, 2.3433, 2.8942, 2.2058, 1.9851, 2.3855,
        2.5280, 1.9007], device='cuda:0')
w_var = tensor([0.9814, 1.0252, 1.0033, 1.0277, 1.0088, 1.0136, 0.9740, 1.0130, 1.0041,
        1.0123, 0.9880, 0.9853, 0.9953, 1.0034, 0.9976, 0.9989, 0.9953, 0.9775,
        1.0047, 0.9850], device='cuda:0')
y_var = tensor([3.3192, 3.2152, 3.8765, 3.5348, 3.0639, 2.8729, 3.0567, 3.2389, 3.1649,
        3.0563, 3.1842, 3.2524, 3.0428, 3.2915, 3.9056, 3.2214, 2.9500, 3.3344,
        3.5733, 2.8937], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([21.3671, 21.3671, 21.3671, 21.3671, 21.3671, 21.3671, 21.3671, 21.3671,
        21.3671, 21.3671, 21.3671, 21.3671, 21.3671, 21.3671, 21.3671, 21.3671,
        21.3671, 21.3671, 21.3671, 21.3671], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 1.3727,  5.3307,  2.9480,  ...,  1.0405,  0.7411,  1.3797],
        [ 0.3265,  4.1440,  0.9478,  ...,  3.5021,  0.5172,  5.8198],
        [21.8078,  1.4321,  3.4196,  ...,  4.4839,  5.9680,  1.9428],
        ...,
        [ 1.0633,  1.6684,  1.0245,  ...,  0.5006,  0.6034,  0.7292],
        [ 0.2976,  0.3210,  0.1958,  ...,  0.9427,  0.9169,  0.4326],
        [ 1.1596,  1.1722,  0.6909,  ...,  0.9119,  0.7333,  2.5263]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 2.7604501247406006
Var (shape: torch.Size([20, 64])) = tensor([[ 2.2872,  8.8818,  4.9117,  ...,  1.7336,  1.2348,  2.2988],
        [ 0.5439,  6.9045,  1.5791,  ...,  5.8350,  0.8617,  9.6966],
        [36.3349,  2.3861,  5.6976,  ...,  7.4707,  9.9435,  3.2370],
        ...,
        [ 1.7717,  2.7798,  1.7070,  ...,  0.8340,  1.0054,  1.2150],
        [ 0.4958,  0.5349,  0.3262,  ...,  1.5707,  1.5276,  0.7208],
        [ 1.9321,  1.9531,  1.1511,  ...,  1.5193,  1.2217,  4.2091]],
       device='cuda:0')
***********
SINR = tensor([-19.5617, -19.8133, -22.5506, -15.9863, -18.9133, -21.3047, -17.6779,
        -17.3432, -20.3162, -19.8569, -21.9709, -21.7596, -20.6145, -22.5332,
        -15.7761, -24.8498, -16.1987, -16.1410, -14.8542, -19.4064],
       device='cuda:0')
Real_SINR = tensor([-25.6955, -22.5459, -27.4114, -16.9555, -19.7783, -25.1838, -19.5841,
        -20.0618, -23.9248, -22.1584, -24.4737, -28.2420, -24.2038, -26.1667,
        -17.2897, -29.6889, -17.8284, -18.0987, -16.3784, -20.4771],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0109, 0.0103, 0.0055, 0.0246, 0.0127, 0.0074, 0.0168, 0.0181, 0.0092,
        0.0102, 0.0063, 0.0066, 0.0086, 0.0055, 0.0258, 0.0033, 0.0234, 0.0237,
        0.0317, 0.0113], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 925,  930,  985,  845,  911,  961,  884,  876,  941,  931,  974,  970,
         947,  985,  840, 1000,  850,  849,  818,  922], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 4,  rho_ul = 0.03924822549233719-----------
G_variance = tensor([0.9869, 0.9920, 1.0249, 0.9740, 0.9947, 0.9892, 1.0136, 1.0225, 1.0086,
        0.9810, 0.9877, 1.0023, 1.0099, 1.0067, 1.0108, 1.0107, 0.9957, 1.0004,
        0.9743, 0.9931], device='cuda:0')
G_hat_variance = tensor([0.7210, 0.7104, 0.7160, 0.7094, 0.6978, 0.7200, 0.7241, 0.7212, 0.7175,
        0.7030, 0.7103, 0.7259, 0.7225, 0.7099, 0.7408, 0.7203, 0.7131, 0.7222,
        0.7063, 0.7026], device='cuda:0')
G_tilde_var = tensor([0.2802, 0.2832, 0.2847, 0.2826, 0.2857, 0.2839, 0.2859, 0.2854, 0.2846,
        0.2816, 0.2846, 0.2834, 0.2885, 0.2824, 0.2835, 0.2772, 0.2834, 0.2794,
        0.2773, 0.2799], device='cuda:0')
gamma = tensor([[[0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
          0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
          0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
          0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
          0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
          0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
          0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153,
          0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153, 0.7153]]],
       device='cuda:0')
Z_mean = tensor([-0.0061+0.0179j, -0.0050-0.0046j, -0.0182-0.0008j,  0.0097+0.0155j,
        -0.0104+0.0074j, -0.0049+0.0002j, -0.0062+0.0039j,  0.0035-0.0063j,
         0.0022-0.0074j, -0.0044-0.0148j, -0.0177+0.0052j, -0.0065+0.0093j,
        -0.0015+0.0089j, -0.0101-0.0078j,  0.0068-0.0014j, -0.0104+0.0018j,
        -0.0067+0.0026j,  0.0066-0.0018j, -0.0002-0.0068j, -0.0070+0.0039j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0080, 0.9932, 1.0010, 0.9918, 0.9756, 1.0066, 1.0123, 1.0083, 1.0032,
        0.9829, 0.9931, 1.0149, 1.0101, 0.9925, 1.0357, 1.0070, 0.9969, 1.0097,
        0.9875, 0.9823], device='cuda:0')
Real_SNR = tensor([4.1532, 3.8627, 5.8501, 4.5162, 4.4125, 4.2997, 5.4004, 4.9581, 4.1487,
        4.5016, 3.5187, 4.6855, 4.3905, 4.2203, 4.5109, 4.3850, 4.4963, 4.4890,
        4.5899, 4.4325], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([67.9640, 62.7305, 98.9193, 72.6095, 71.2433, 69.1947, 88.0807, 80.6476,
        68.2937, 73.2188, 57.6654, 73.9897, 70.2532, 68.1108, 71.3664, 68.0141,
        73.7199, 70.3599, 72.8667, 70.5957], device='cuda:0')
signal_var = tensor([2.6675, 2.4621, 3.8824, 2.8498, 2.7962, 2.7158, 3.4570, 3.1653, 2.6804,
        2.8737, 2.2633, 2.9040, 2.7573, 2.6732, 2.8010, 2.6694, 2.8934, 2.7615,
        2.8599, 2.7708], device='cuda:0')
w_var = tensor([1.0251, 1.0116, 1.0095, 1.0074, 1.0123, 1.0091, 0.9969, 1.0107, 1.0312,
        1.0193, 1.0066, 0.9873, 1.0033, 1.0116, 0.9913, 0.9726, 1.0275, 0.9823,
        0.9939, 0.9985], device='cuda:0')
y_var = tensor([3.5794, 3.4260, 4.8983, 3.8990, 3.7547, 3.7538, 4.4646, 4.1754, 3.7285,
        3.8290, 3.3214, 3.9339, 3.7510, 3.7017, 3.7156, 3.6536, 3.9329, 3.7576,
        3.8410, 3.7711], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([18.2238, 18.2238, 18.2238, 18.2238, 18.2238, 18.2238, 18.2238, 18.2238,
        18.2238, 18.2238, 18.2238, 18.2238, 18.2238, 18.2238, 18.2238, 18.2238,
        18.2238, 18.2238, 18.2238, 18.2238], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 6.1973,  0.4947,  0.4101,  ...,  1.3406,  2.1748,  0.7979],
        [ 0.5528,  2.1161,  1.4751,  ...,  2.9286,  1.3417,  1.7535],
        [ 4.6800,  2.0053,  0.3851,  ...,  2.3947,  0.9473,  6.6147],
        ...,
        [ 5.6264, 16.1648,  0.5868,  ..., 20.1850,  3.8707,  6.9066],
        [ 0.4459,  1.9783,  2.2762,  ...,  0.6711,  0.7056,  0.9425],
        [24.6702,  3.9744,  8.1107,  ...,  0.8656, 11.3365,  1.1692]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 3.337446689605713
Var (shape: torch.Size([20, 64])) = tensor([[10.6299,  0.8485,  0.7034,  ...,  2.2995,  3.7304,  1.3686],
        [ 0.9482,  3.6296,  2.5302,  ...,  5.0233,  2.3013,  3.0077],
        [ 8.0274,  3.4396,  0.6606,  ...,  4.1075,  1.6248, 11.3460],
        ...,
        [ 9.6507, 27.7268,  1.0065,  ..., 34.6224,  6.6393, 11.8466],
        [ 0.7648,  3.3933,  3.9042,  ...,  1.1512,  1.2102,  1.6166],
        [42.3156,  6.8171, 13.9120,  ...,  1.4848, 19.4450,  2.0054]],
       device='cuda:0')
***********
SINR = tensor([-18.3371, -17.7785, -18.6414, -17.3693, -18.0579, -20.8107, -17.7360,
        -21.0031, -14.8309, -18.5809, -22.1470, -18.8716, -15.9567, -18.7031,
        -16.4210, -20.7336, -22.3917, -22.1677, -19.8691, -21.9708],
       device='cuda:0')
Real_SINR = tensor([-18.4919, -19.6008, -24.8706, -20.3600, -20.7013, -22.5047, -19.0473,
        -24.1047, -16.4298, -21.5718, -25.6260, -20.2066, -18.8546, -19.6200,
        -17.7092, -27.1689, -27.8651, -25.4166, -22.7307, -24.7061],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0145, 0.0164, 0.0135, 0.0180, 0.0154, 0.0082, 0.0166, 0.0079, 0.0318,
        0.0137, 0.0061, 0.0128, 0.0247, 0.0133, 0.0223, 0.0084, 0.0057, 0.0060,
        0.0102, 0.0063], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([898, 886, 905, 877, 892, 951, 885, 955, 817, 904, 977, 910, 844, 906,
        855, 949, 982, 978, 931, 974], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 5,  rho_ul = 0.04941058844013093-----------
G_variance = tensor([1.0050, 0.9943, 0.9949, 1.0262, 1.0133, 0.9985, 0.9777, 1.0012, 1.0049,
        0.9987, 0.9783, 0.9892, 1.0051, 0.9754, 0.9831, 1.0273, 1.0000, 0.9926,
        0.9942, 1.0212], device='cuda:0')
G_hat_variance = tensor([0.7638, 0.7693, 0.7536, 0.7851, 0.7667, 0.7660, 0.7467, 0.7605, 0.7527,
        0.7566, 0.7532, 0.7525, 0.7584, 0.7448, 0.7496, 0.7706, 0.7583, 0.7486,
        0.7613, 0.7618], device='cuda:0')
G_tilde_var = tensor([0.2452, 0.2288, 0.2382, 0.2406, 0.2384, 0.2399, 0.2417, 0.2451, 0.2381,
        0.2411, 0.2357, 0.2403, 0.2442, 0.2385, 0.2377, 0.2510, 0.2377, 0.2409,
        0.2407, 0.2370], device='cuda:0')
gamma = tensor([[[0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
          0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
          0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
          0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
          0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
          0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
          0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597,
          0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597, 0.7597]]],
       device='cuda:0')
Z_mean = tensor([-0.0147-0.0290j,  0.0025+0.0010j,  0.0080-0.0056j,  0.0015+0.0208j,
        -0.0039-0.0033j, -0.0063-0.0081j, -0.0022-0.0002j,  0.0176+0.0005j,
        -0.0206+0.0200j,  0.0059-0.0172j,  0.0010-0.0107j, -0.0095-0.0323j,
         0.0060-0.0047j,  0.0171-0.0164j, -0.0047-0.0050j,  0.0219-0.0027j,
         0.0081-0.0039j, -0.0041-0.0029j, -0.0040-0.0028j, -0.0184-0.0044j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0053, 1.0126, 0.9920, 1.0333, 1.0092, 1.0083, 0.9828, 1.0010, 0.9907,
        0.9958, 0.9913, 0.9905, 0.9982, 0.9803, 0.9866, 1.0143, 0.9981, 0.9853,
        1.0020, 1.0027], device='cuda:0')
Real_SNR = tensor([5.1762, 6.5087, 6.1379, 5.2373, 5.2368, 5.9151, 5.1093, 5.3608, 5.7461,
        5.2720, 5.5238, 5.4547, 5.6047, 4.9719, 5.6739, 5.7635, 5.3509, 5.9458,
        5.9690, 5.1093], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([67.6932, 88.1709, 82.5514, 67.6107, 65.6968, 79.7276, 65.3652, 69.3571,
        72.0658, 66.9309, 70.1917, 70.8689, 75.7021, 63.3954, 74.8357, 77.5845,
        69.2068, 79.9038, 78.9204, 65.5162], device='cuda:0')
signal_var = tensor([3.3448, 4.3566, 4.0789, 3.3407, 3.2461, 3.9394, 3.2297, 3.4270, 3.5608,
        3.3071, 3.4682, 3.5017, 3.7405, 3.1324, 3.6977, 3.8335, 3.4195, 3.9481,
        3.8995, 3.2372], device='cuda:0')
w_var = tensor([1.0156, 0.9734, 0.9926, 1.0002, 0.9720, 1.0091, 0.9959, 0.9973, 0.9483,
        0.9823, 0.9721, 0.9973, 1.0291, 0.9970, 1.0012, 1.0168, 0.9974, 1.0042,
        0.9865, 0.9982], device='cuda:0')
y_var = tensor([4.3391, 5.3933, 5.1523, 4.3620, 4.1898, 4.8466, 4.0996, 4.3687, 4.4972,
        4.3480, 4.4838, 4.5495, 4.7287, 4.1222, 4.6422, 4.8874, 4.3841, 4.9499,
        4.8736, 4.2670], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([15.3762, 15.3762, 15.3762, 15.3762, 15.3762, 15.3762, 15.3762, 15.3762,
        15.3762, 15.3762, 15.3762, 15.3762, 15.3762, 15.3762, 15.3762, 15.3762,
        15.3762, 15.3762, 15.3762, 15.3762], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[3.6257e+01, 6.4288e+01, 3.5215e+01,  ..., 2.8352e+01, 1.7274e+02,
         3.4020e+02],
        [3.1617e+00, 1.0497e+00, 1.1034e+00,  ..., 1.5096e+00, 8.1256e-01,
         2.9410e+00],
        [1.9639e+00, 2.8675e-01, 1.2020e+00,  ..., 4.3459e+00, 5.7786e-01,
         2.5412e+00],
        ...,
        [1.6629e+01, 7.9417e+00, 2.8278e+00,  ..., 5.0135e+00, 8.3969e-01,
         1.5417e+01],
        [9.2995e-01, 1.4593e+00, 1.2798e+00,  ..., 1.6810e-01, 1.4524e+00,
         1.4185e+00],
        [1.5842e+00, 6.1270e-01, 1.2232e+00,  ..., 2.1600e+00, 9.9501e-01,
         3.7725e-01]], device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 11.765154838562012
Var (shape: torch.Size([20, 64])) = tensor([[6.3803e+01, 1.1313e+02, 6.1970e+01,  ..., 4.9892e+01, 3.0397e+02,
         5.9866e+02],
        [5.5638e+00, 1.8473e+00, 1.9417e+00,  ..., 2.6565e+00, 1.4299e+00,
         5.1755e+00],
        [3.4560e+00, 5.0461e-01, 2.1152e+00,  ..., 7.6477e+00, 1.0169e+00,
         4.4719e+00],
        ...,
        [2.9263e+01, 1.3975e+01, 4.9762e+00,  ..., 8.8224e+00, 1.4776e+00,
         2.7130e+01],
        [1.6365e+00, 2.5680e+00, 2.2521e+00,  ..., 2.9582e-01, 2.5559e+00,
         2.4962e+00],
        [2.7878e+00, 1.0782e+00, 2.1526e+00,  ..., 3.8011e+00, 1.7510e+00,
         6.6387e-01]], device='cuda:0')
***********
SINR = tensor([-32.7897, -17.9571, -18.4054, -17.3803, -18.1008, -20.7465, -18.3233,
        -14.8509, -15.6759, -19.4645, -21.7363, -17.5985, -18.8211, -20.0601,
        -13.2349, -26.0131, -19.4160, -20.5915, -14.5947, -15.4949],
       device='cuda:0')
Real_SINR = tensor([-40.3125, -19.6874, -23.6620, -19.6017, -18.9500, -23.5551, -21.9169,
        -17.5275, -17.1446, -22.4618, -27.3750, -18.2157, -22.3961, -23.8860,
        -14.6364, -31.1290, -23.1455, -24.5494, -16.3032, -18.1396],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0005, 0.0158, 0.0142, 0.0180, 0.0152, 0.0084, 0.0145, 0.0317, 0.0264,
        0.0112, 0.0067, 0.0171, 0.0129, 0.0098, 0.0453, 0.0025, 0.0113, 0.0087,
        0.0336, 0.0274], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  890,  900,  877,  893,  949,  898,  817,  837,  923,  969,  882,
         909,  935,  777, 1000,  922,  946,  811,  833], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 6,  rho_ul = 0.06220424539898394-----------
G_variance = tensor([1.0067, 1.0084, 0.9992, 1.0232, 1.0032, 0.9800, 1.0078, 0.9929, 0.9611,
        0.9777, 0.9939, 0.9766, 1.0084, 1.0160, 1.0028, 1.0054, 1.0188, 0.9673,
        0.9944, 1.0085], device='cuda:0')
G_hat_variance = tensor([0.8006, 0.8019, 0.8099, 0.8137, 0.7932, 0.7829, 0.8072, 0.7846, 0.7746,
        0.7830, 0.8005, 0.7928, 0.7980, 0.8036, 0.8017, 0.7962, 0.8230, 0.7761,
        0.7875, 0.8144], device='cuda:0')
G_tilde_var = tensor([0.2000, 0.2021, 0.1973, 0.2068, 0.2038, 0.1961, 0.1995, 0.1960, 0.2003,
        0.2029, 0.2045, 0.1969, 0.2020, 0.2048, 0.1963, 0.2051, 0.2018, 0.1940,
        0.2065, 0.1981], device='cuda:0')
gamma = tensor([[[0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992,
          0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992,
          0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992,
          0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992,
          0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992,
          0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992,
          0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992,
          0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992, 0.7992]]],
       device='cuda:0')
Z_mean = tensor([ 0.0091-0.0060j, -0.0048+0.0036j,  0.0117+0.0087j,  0.0116+0.0025j,
        -0.0027-0.0057j,  0.0058-0.0035j, -0.0014-0.0114j,  0.0060+0.0077j,
        -0.0185-0.0119j,  0.0108-0.0009j,  0.0037-0.0166j,  0.0123-0.0070j,
         0.0033+0.0177j, -0.0100-0.0018j, -0.0023+0.0050j, -0.0019+0.0027j,
        -0.0221-0.0132j, -0.0138-0.0151j,  0.0047-0.0086j,  0.0015-0.0022j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0016, 1.0034, 1.0133, 1.0180, 0.9925, 0.9795, 1.0100, 0.9817, 0.9692,
        0.9797, 1.0015, 0.9920, 0.9985, 1.0054, 1.0031, 0.9962, 1.0297, 0.9710,
        0.9854, 1.0190], device='cuda:0')
Real_SNR = tensor([6.1022, 6.3608, 6.8037, 6.3710, 6.3884, 6.9372, 6.9754, 6.2394, 5.9905,
        6.2390, 6.2140, 6.3369, 6.6249, 5.9403, 7.0735, 6.3969, 6.6647, 7.4864,
        6.3973, 6.3525], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([63.3723, 70.1930, 79.8464, 71.2773, 70.5644, 77.9184, 78.5120, 66.0091,
        66.1678, 68.2724, 68.0667, 71.3942, 75.1986, 64.5720, 82.7664, 70.3388,
        74.8478, 91.3372, 70.1817, 69.5287], device='cuda:0')
signal_var = tensor([3.9420, 4.3663, 4.9668, 4.4337, 4.3894, 4.8469, 4.8838, 4.1060, 4.1159,
        4.2468, 4.2340, 4.4410, 4.6777, 4.0167, 5.1484, 4.3754, 4.6559, 5.6816,
        4.3656, 4.3250], device='cuda:0')
w_var = tensor([0.9672, 1.0093, 1.0368, 1.0225, 1.0082, 0.9812, 0.9800, 0.9761, 1.0361,
        1.0096, 1.0124, 1.0323, 1.0175, 1.0229, 1.0100, 1.0031, 1.0035, 1.0135,
        1.0007, 1.0017], device='cuda:0')
y_var = tensor([4.8999, 5.4346, 5.9925, 5.5271, 5.2857, 5.9438, 6.0116, 5.0160, 5.1772,
        5.3388, 5.2532, 5.5280, 5.7554, 5.1839, 6.0169, 5.4330, 5.6530, 6.6839,
        5.3311, 5.2268], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([12.8486, 12.8486, 12.8486, 12.8486, 12.8486, 12.8486, 12.8486, 12.8486,
        12.8486, 12.8486, 12.8486, 12.8486, 12.8486, 12.8486, 12.8486, 12.8486,
        12.8486, 12.8486, 12.8486, 12.8486], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[  5.9937,   5.6764,   9.0568,  ...,   7.9760,   8.4822,   7.3064],
        [  2.5236,  32.0419,  24.3353,  ...,   1.1839,  29.7304,  52.0196],
        [ 34.2294,   4.6551,  24.8594,  ..., 134.2963,   5.9124,  28.1014],
        ...,
        [  0.4475,   0.5418,   1.2771,  ...,   2.6707,   1.2940,   1.1021],
        [  0.7324,   4.5083,   0.4714,  ...,   9.3056,   0.4827,   2.7477],
        [  3.2788,   1.7884,   6.4005,  ...,   1.3976,   6.7954,   3.2045]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 7.348771095275879
Var (shape: torch.Size([20, 64])) = tensor([[ 10.7841,  10.2132,  16.2953,  ...,  14.3508,  15.2615,  13.1460],
        [  4.5406,  57.6511,  43.7850,  ...,   2.1302,  53.4921,  93.5958],
        [ 61.5868,   8.3757,  44.7280,  ..., 241.6312,  10.6379,  50.5612],
        ...,
        [  0.8052,   0.9748,   2.2978,  ...,   4.8053,   2.3282,   1.9830],
        [  1.3177,   8.1114,   0.8482,  ...,  16.7429,   0.8686,   4.9438],
        [  5.8993,   3.2177,  11.5160,  ...,   2.5145,  12.2265,   5.7656]],
       device='cuda:0')
***********
SINR = tensor([-22.7528, -20.8540, -25.6785, -13.8506, -19.9830, -13.9511, -19.9621,
        -25.0566, -14.5480, -16.2503, -14.9608, -13.0826, -13.2608, -16.5447,
        -17.1208, -13.7537, -17.2318, -15.9159, -15.7993, -16.0513],
       device='cuda:0')
Real_SINR = tensor([-25.4930, -25.0202, -31.5850, -16.8043, -23.1357, -16.0388, -24.8876,
        -32.0579, -17.6223, -18.8335, -17.0940, -15.0838, -14.4328, -21.7969,
        -20.0438, -15.1381, -20.9005, -18.0701, -17.5433, -18.6974],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0053, 0.0081, 0.0027, 0.0396, 0.0099, 0.0387, 0.0100, 0.0031, 0.0339,
        0.0232, 0.0309, 0.0469, 0.0451, 0.0217, 0.0190, 0.0404, 0.0186, 0.0250,
        0.0256, 0.0242], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 989,  952, 1000,  792,  934,  795,  933, 1000,  810,  851,  820,  773,
         777,  858,  871,  790,  874,  843,  840,  846], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 7,  rho_ul = 0.07831050525426128-----------
G_variance = tensor([1.0120, 0.9643, 0.9967, 1.0023, 0.9681, 1.0019, 1.0009, 1.0028, 0.9913,
        1.0118, 1.0145, 0.9994, 0.9970, 1.0110, 1.0087, 0.9905, 1.0032, 0.9927,
        0.9778, 0.9934], device='cuda:0')
G_hat_variance = tensor([0.8493, 0.8173, 0.8317, 0.8342, 0.8146, 0.8254, 0.8377, 0.8358, 0.8365,
        0.8382, 0.8362, 0.8346, 0.8270, 0.8390, 0.8468, 0.8267, 0.8289, 0.8200,
        0.8229, 0.8364], device='cuda:0')
G_tilde_var = tensor([0.1693, 0.1625, 0.1663, 0.1668, 0.1657, 0.1651, 0.1677, 0.1642, 0.1657,
        0.1719, 0.1705, 0.1673, 0.1665, 0.1667, 0.1675, 0.1638, 0.1625, 0.1677,
        0.1615, 0.1648], device='cuda:0')
gamma = tensor([[[0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337,
          0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337,
          0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337,
          0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337,
          0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337,
          0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337,
          0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337,
          0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337, 0.8337]]],
       device='cuda:0')
Z_mean = tensor([ 0.0079-0.0106j,  0.0045+0.0020j,  0.0101+0.0032j, -0.0081+0.0074j,
         0.0159-0.0099j,  0.0184-0.0099j,  0.0012+0.0023j, -0.0094-0.0119j,
         0.0085-0.0028j,  0.0120-0.0073j, -0.0047-0.0062j, -0.0006-0.0168j,
        -0.0078+0.0012j, -0.0039+0.0255j, -0.0195+0.0052j, -0.0061-0.0029j,
        -0.0098+0.0113j,  0.0029-0.0016j, -0.0003+0.0131j, -0.0016-0.0214j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0188, 0.9804, 0.9976, 1.0007, 0.9771, 0.9901, 1.0048, 1.0025, 1.0034,
        1.0055, 1.0031, 1.0011, 0.9920, 1.0064, 1.0158, 0.9917, 0.9943, 0.9837,
        0.9871, 1.0033], device='cuda:0')
Real_SNR = tensor([7.2398, 7.4804, 8.5582, 7.7972, 7.7155, 7.6508, 6.9100, 7.3752, 7.4106,
        7.5781, 7.1304, 7.8913, 8.0454, 7.7530, 7.8786, 7.8395, 7.6514, 7.9463,
        7.1660, 7.5292], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([67.6698, 71.2828, 90.2899, 77.1850, 74.3805, 75.3596, 63.7689, 69.7193,
        72.7619, 74.7915, 64.4757, 78.7648, 79.5328, 75.6464, 75.5567, 74.2877,
        71.3371, 81.2289, 66.1169, 72.4432], device='cuda:0')
signal_var = tensor([5.2993, 5.5822, 7.0707, 6.0444, 5.8248, 5.9015, 4.9938, 5.4598, 5.6980,
        5.8570, 5.0491, 6.1681, 6.2283, 5.9239, 5.9169, 5.8175, 5.5864, 6.3611,
        5.1776, 5.6731], device='cuda:0')
w_var = tensor([1.0005, 0.9972, 0.9854, 1.0038, 0.9857, 1.0136, 1.0172, 0.9992, 1.0343,
        1.0230, 0.9776, 1.0024, 0.9769, 0.9938, 0.9643, 0.9567, 0.9594, 1.0207,
        0.9943, 1.0021], device='cuda:0')
y_var = tensor([6.3200, 6.5952, 8.0350, 6.9962, 6.7076, 6.9041, 6.0153, 6.4339, 6.6840,
        6.7672, 6.1146, 7.1694, 7.1938, 6.8906, 6.6879, 6.6546, 6.5765, 7.4150,
        6.2590, 6.6906], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([10.6456, 10.6456, 10.6456, 10.6456, 10.6456, 10.6456, 10.6456, 10.6456,
        10.6456, 10.6456, 10.6456, 10.6456, 10.6456, 10.6456, 10.6456, 10.6456,
        10.6456, 10.6456, 10.6456, 10.6456], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[ 3.5357,  8.4981, 13.6117,  ...,  4.4161,  2.8997,  0.4383],
        [20.3143,  3.6048,  1.1941,  ...,  1.2389, 10.3885,  2.5501],
        [ 0.7445,  0.5314,  0.8525,  ...,  0.3896,  0.9104,  0.6056],
        ...,
        [ 0.6997,  4.3356,  1.8198,  ...,  7.4793,  2.3709,  3.5609],
        [ 1.0104,  1.6755,  0.3750,  ...,  0.5826,  3.6204,  3.1011],
        [ 1.7762,  3.6125,  2.2592,  ...,  2.2683,  0.5668,  1.1288]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 3.793841600418091
Var (shape: torch.Size([20, 64])) = tensor([[ 6.4833, 15.5827, 24.9593,  ...,  8.0977,  5.3171,  0.8036],
        [37.2495,  6.6100,  2.1896,  ...,  2.2717, 19.0491,  4.6761],
        [ 1.3651,  0.9744,  1.5632,  ...,  0.7143,  1.6694,  1.1104],
        ...,
        [ 1.2831,  7.9500,  3.3368,  ..., 13.7146,  4.3475,  6.5294],
        [ 1.8527,  3.0723,  0.6876,  ...,  1.0683,  6.6386,  5.6863],
        [ 3.2570,  6.6241,  4.1426,  ...,  4.1593,  1.0393,  2.0698]],
       device='cuda:0')
***********
SINR = tensor([-17.3953, -17.0837, -13.2198, -15.8939, -14.8492, -16.3870, -16.3516,
        -15.4913, -11.3479, -14.9323, -24.4213, -16.8078, -15.8373, -15.6894,
        -13.6055, -13.2283, -14.5484, -16.0810, -14.1392, -14.2836],
       device='cuda:0')
Real_SINR = tensor([-21.4827, -19.0016, -13.7207, -17.8770, -16.9175, -19.6224, -20.0824,
        -16.9160, -12.8639, -20.2594, -29.2678, -19.7390, -18.6014, -16.9731,
        -15.7251, -14.4000, -16.8333, -19.2181, -15.2746, -16.0663],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0179, 0.0192, 0.0455, 0.0251, 0.0317, 0.0225, 0.0226, 0.0275, 0.0683,
        0.0311, 0.0036, 0.0204, 0.0254, 0.0263, 0.0418, 0.0454, 0.0339, 0.0241,
        0.0371, 0.0360], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 877,  870,  776,  843,  817,  854,  853,  833,  726,  819, 1000,  864,
         841,  838,  786,  776,  810,  847,  800,  803], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 8,  rho_ul = 0.09858708507503021-----------
G_variance = tensor([0.9897, 0.9826, 1.0097, 1.0339, 0.9978, 0.9834, 0.9891, 1.0078, 0.9904,
        1.0309, 1.0037, 1.0089, 1.0007, 1.0022, 0.9866, 0.9968, 0.9904, 1.0217,
        1.0012, 0.9875], device='cuda:0')
G_hat_variance = tensor([0.8599, 0.8572, 0.8629, 0.8796, 0.8620, 0.8395, 0.8618, 0.8769, 0.8460,
        0.8838, 0.8546, 0.8705, 0.8658, 0.8616, 0.8521, 0.8571, 0.8540, 0.8999,
        0.8552, 0.8598], device='cuda:0')
G_tilde_var = tensor([0.1377, 0.1408, 0.1404, 0.1371, 0.1363, 0.1387, 0.1330, 0.1349, 0.1398,
        0.1373, 0.1374, 0.1349, 0.1374, 0.1358, 0.1341, 0.1386, 0.1375, 0.1394,
        0.1344, 0.1364], device='cuda:0')
gamma = tensor([[[0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632,
          0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632,
          0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632,
          0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632,
          0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632,
          0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632,
          0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632,
          0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632, 0.8632]]],
       device='cuda:0')
Z_mean = tensor([ 0.0113+0.0147j,  0.0083-0.0039j, -0.0150+0.0047j,  0.0102+0.0022j,
         0.0026-0.0044j,  0.0152-0.0073j,  0.0135+0.0006j,  0.0026+0.0140j,
         0.0141-0.0142j, -0.0255+0.0088j, -0.0006+0.0074j, -0.0116-0.0083j,
         0.0040-0.0088j,  0.0006+0.0050j,  0.0115-0.0167j, -0.0134+0.0107j,
        -0.0064+0.0045j, -0.0120+0.0088j,  0.0126+0.0150j,  0.0247-0.0232j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([0.9961, 0.9931, 0.9997, 1.0190, 0.9987, 0.9725, 0.9984, 1.0159, 0.9800,
        1.0239, 0.9901, 1.0085, 1.0030, 0.9981, 0.9872, 0.9930, 0.9893, 1.0426,
        0.9908, 0.9961], device='cuda:0')
Real_SNR = tensor([8.7736, 8.9208, 9.1961, 8.4234, 8.4077, 8.3841, 8.1599, 8.6779, 8.2205,
        8.3259, 8.9422, 8.6201, 8.3635, 8.0142, 8.3580, 8.0829, 8.2879, 8.8148,
        7.8665, 8.1048], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([76.4637, 78.6467, 84.9304, 71.0273, 68.7807, 69.2522, 67.1829, 75.6092,
        66.2564, 69.0534, 76.2710, 71.7137, 70.4351, 64.6530, 70.4704, 64.8635,
        70.7796, 78.9555, 64.0515, 67.5659], device='cuda:0')
signal_var = tensor([7.5383, 7.7535, 8.3730, 7.0024, 6.7809, 6.8274, 6.6234, 7.4541, 6.5320,
        6.8078, 7.5193, 7.0700, 6.9440, 6.3739, 6.9475, 6.3947, 6.9780, 7.7840,
        6.3146, 6.6611], device='cuda:0')
w_var = tensor([0.9998, 0.9941, 1.0076, 1.0067, 0.9784, 0.9905, 1.0118, 1.0107, 0.9840,
        1.0010, 0.9593, 0.9714, 1.0122, 1.0069, 1.0140, 0.9943, 1.0350, 1.0226,
        1.0320, 1.0305], device='cuda:0')
y_var = tensor([8.5792, 8.8745, 9.2660, 7.9514, 7.6530, 7.8529, 7.7330, 8.5322, 7.6357,
        7.7715, 8.3550, 8.0543, 7.9007, 7.4059, 7.8021, 7.4277, 8.0545, 8.7376,
        7.3573, 7.7931], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556,
        8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556, 8.7556,
        8.7556, 8.7556], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[  0.7775,   3.9536,   0.7889,  ...,   7.9144,   3.7047,   2.5729],
        [  4.5514,  26.3498,   4.2299,  ...,  16.2798,   1.0515,   1.7060],
        [  0.5421,   0.9885,   1.0044,  ...,   2.7739,   1.9603,   6.5657],
        ...,
        [  0.9620,   4.6354,   5.4641,  ...,   1.0065,   1.1949,   5.5511],
        [  1.5865,   1.0608,   0.8541,  ...,   0.7308,   3.9669,   0.6848],
        [  7.5201,  25.0207, 135.4530,  ...,  17.6714,  18.3428,  49.0066]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 5.4205522537231445
Var (shape: torch.Size([20, 64])) = tensor([[  1.4487,   7.3664,   1.4699,  ...,  14.7461,   6.9025,   4.7939],
        [  8.4801,  49.0947,   7.8812,  ...,  30.3323,   1.9591,   3.1786],
        [  1.0101,   1.8417,   1.8714,  ...,   5.1683,   3.6524,  12.2332],
        ...,
        [  1.7924,   8.6367,  10.1807,  ...,   1.8753,   2.2263,  10.3427],
        [  2.9560,   1.9766,   1.5914,  ...,   1.3617,   7.3911,   1.2758],
        [ 14.0114,  46.6185, 252.3751,  ...,  32.9252,  34.1762,  91.3087]],
       device='cuda:0')
***********
SINR = tensor([-15.2944, -17.0224, -13.8182, -14.2419, -19.3108, -11.6425, -14.5813,
        -12.3373, -12.8406,  -9.8905, -13.3375, -17.2187, -18.3833, -11.4588,
        -12.2542, -11.9211, -11.4445, -15.9298, -11.7437, -25.4468],
       device='cuda:0')
Real_SINR = tensor([-19.2577, -20.9438, -17.6333, -14.2408, -25.6753, -14.6325, -16.0389,
        -15.3221, -13.9689, -11.6989, -15.4067, -22.2776, -22.5278, -14.4275,
        -13.9174, -12.8438, -13.4461, -20.4273, -12.7122, -29.5286],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0287, 0.0195, 0.0399, 0.0363, 0.0116, 0.0641, 0.0337, 0.0552, 0.0494,
        0.0930, 0.0443, 0.0186, 0.0143, 0.0667, 0.0562, 0.0604, 0.0669, 0.0249,
        0.0627, 0.0028], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 828,  869,  792,  802,  919,  734,  811,  753,  766,  684,  779,  873,
         899,  729,  751,  741,  728,  844,  737, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
--------SNR = 9,  rho_ul = 0.124113786675669-----------
G_variance = tensor([0.9966, 1.0046, 0.9959, 1.0259, 0.9932, 0.9698, 0.9805, 0.9846, 0.9911,
        1.0118, 0.9973, 0.9896, 0.9889, 1.0249, 0.9703, 1.0069, 0.9773, 0.9661,
        1.0009, 1.0094], device='cuda:0')
G_hat_variance = tensor([0.8907, 0.8881, 0.8775, 0.9115, 0.8757, 0.8672, 0.8746, 0.8784, 0.8815,
        0.8936, 0.8750, 0.8775, 0.8681, 0.9124, 0.8602, 0.8982, 0.8614, 0.8570,
        0.8908, 0.8958], device='cuda:0')
G_tilde_var = tensor([0.1116, 0.1085, 0.1133, 0.1111, 0.1109, 0.1112, 0.1114, 0.1093, 0.1135,
        0.1119, 0.1094, 0.1088, 0.1117, 0.1109, 0.1096, 0.1133, 0.1126, 0.1114,
        0.1093, 0.1108], device='cuda:0')
gamma = tensor([[[0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882,
          0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882,
          0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882,
          0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882,
          0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882,
          0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882,
          0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882,
          0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882, 0.8882]]],
       device='cuda:0')
Z_mean = tensor([-0.0119+0.0072j, -0.0074+0.0231j, -0.0197+0.0151j, -0.0042+0.0077j,
         0.0006-0.0070j,  0.0009-0.0112j, -0.0088+0.0176j, -0.0034+0.0203j,
        -0.0044+0.0019j,  0.0078-0.0019j,  0.0123+0.0174j,  0.0130+0.0119j,
         0.0075-0.0127j,  0.0042+0.0016j,  0.0035-0.0155j,  0.0090-0.0123j,
        -0.0030+0.0094j, -0.0144-0.0158j, -0.0052-0.0055j, -0.0153-0.0224j],
       device='cuda:0')
Z_variance ~CN(0, 1)= tensor([1.0028, 0.9999, 0.9879, 1.0262, 0.9860, 0.9763, 0.9847, 0.9890, 0.9925,
        1.0060, 0.9852, 0.9879, 0.9774, 1.0272, 0.9685, 1.0113, 0.9698, 0.9649,
        1.0030, 1.0086], device='cuda:0')
Real_SNR = tensor([ 9.0194,  9.2347, 10.6026,  8.8002,  9.1672,  8.9202,  9.4844,  9.2693,
         9.1618,  9.5775, 10.2463,  9.5150,  9.7169,  9.8086,  9.3045,  8.5217,
         9.5601,  9.1450,  9.5156,  9.1722], device='cuda:0')
q_var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(D_eta_sqrt @ q).var = tensor([1.0002, 1.0001, 0.9997, 1.0002, 1.0002, 1.0002, 1.0002, 1.0001, 1.0002,
        1.0002, 1.0000, 1.0000, 1.0001, 1.0002, 1.0000, 1.0002, 0.9994, 0.9999,
        1.0002, 1.0002], device='cuda:0')
(G @ (D_eta_sqrt @ q)).var = tensor([67.3874, 66.2950, 91.5316, 61.5372, 68.7923, 60.7236, 74.3102, 70.3155,
        64.4946, 73.2511, 86.6861, 71.3215, 74.7429, 75.4807, 67.9244, 57.4824,
        72.9706, 66.5122, 73.9774, 67.5742], device='cuda:0')
signal_var = tensor([ 8.3637,  8.2281, 11.3603,  7.6376,  8.5381,  7.5366,  9.2229,  8.7271,
         8.0047,  9.0915, 10.7589,  8.8520,  9.2766,  9.3682,  8.4304,  7.1344,
         9.0567,  8.2551,  9.1816,  8.3869], device='cuda:0')
w_var = tensor([1.0482, 0.9814, 0.9889, 1.0068, 1.0343, 0.9664, 1.0385, 1.0326, 0.9709,
        1.0020, 1.0166, 0.9898, 0.9901, 0.9790, 0.9895, 1.0027, 1.0022, 1.0051,
        1.0265, 1.0148], device='cuda:0')
y_var = tensor([ 9.3075,  9.2582, 12.2185,  8.5278,  9.5071,  8.6131, 10.3890,  9.7801,
         8.9574, 10.0724, 11.8446,  9.7800, 10.3297, 10.3112,  9.4804,  8.1280,
        10.1922,  9.1556, 10.1511,  9.3816], device='cuda:0')
####cond finisihed #####
sum_betak_gammak = tensor([7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562,
        7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562, 7.1562,
        7.1562, 7.1562], device='cuda:0')
************
inv_Z_H_Z_k (shape: torch.Size([20, 64])) = tensor([[20.3326, 12.5419,  0.5253,  ...,  1.1817, 37.9182, 15.4189],
        [ 0.1661,  0.9459,  0.2720,  ...,  0.5374,  0.2995,  0.3375],
        [ 1.7464,  0.6066,  1.4736,  ...,  0.3064,  2.1042,  0.5011],
        ...,
        [ 0.5517,  0.8094,  0.4588,  ...,  0.6263,  0.4827,  0.3764],
        [ 2.8497,  1.8456,  2.0008,  ...,  3.8470,  0.8940,  1.1513],
        [ 1.9393,  0.7553,  1.9245,  ...,  1.0869,  1.2380,  2.5717]],
       device='cuda:0')
inv_Z_H_Z_k.mean (expected to be = 10000000.0) = 2.9399335384368896
Var (shape: torch.Size([20, 64])) = tensor([[38.3917, 23.6815,  0.9919,  ...,  2.2313, 71.5965, 29.1138],
        [ 0.3137,  1.7861,  0.5137,  ...,  1.0146,  0.5655,  0.6373],
        [ 3.2975,  1.1453,  2.7824,  ...,  0.5786,  3.9730,  0.9462],
        ...,
        [ 1.0418,  1.5283,  0.8663,  ...,  1.1826,  0.9115,  0.7107],
        [ 5.3807,  3.4849,  3.7779,  ...,  7.2639,  1.6881,  2.1739],
        [ 3.6618,  1.4262,  3.6339,  ...,  2.0522,  2.3376,  4.8558]],
       device='cuda:0')
***********
SINR = tensor([-18.9348,  -8.0838, -10.9348, -11.8951, -18.1771,  -9.8782, -10.1188,
        -16.9664, -14.2831, -13.4468, -12.5742, -12.5953, -10.7940, -10.6036,
        -10.6318,  -9.8111, -14.9837, -10.7951, -13.2318, -11.4003],
       device='cuda:0')
Real_SINR = tensor([-24.1844,  -8.8042, -13.6528, -13.9134, -22.0031, -10.5971, -13.1739,
        -20.7887, -17.2382, -16.6686, -13.6351, -15.0562, -12.5706, -13.1171,
        -11.1686,  -9.4103, -17.6627, -11.7081, -17.2605, -14.4127],
       device='cuda:0')
Real_SINR_noise.shape = torch.Size([20])
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0126, 0.1345, 0.0746, 0.0607, 0.0150, 0.0933, 0.0887, 0.0197, 0.0360,
        0.0433, 0.0524, 0.0521, 0.0769, 0.0801, 0.0796, 0.0946, 0.0308, 0.0769,
        0.0454, 0.0675], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([911, 629, 714, 741, 895, 684, 691, 868, 803, 782, 759, 760, 710, 705,
        705, 682, 821, 710, 776, 727], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/dynamic/
20 images are saved in outputs/MIMOdiffusion/M=64/K=64/nonoisenosample/
