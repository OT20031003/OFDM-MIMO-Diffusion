Loading model from models/ldm/text2img-large/model.ckpt
autoencoder.py
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
ldm.modules/diffusionmodules/util.py ; make_schedule = linear
ldm/modules/diffusionmodules/model.py, Enocoder; in_channels = 3, ch_mult = [1, 2, 4, 4]
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
making attention of type 'vanilla' with 512 in_channels
ldm/models/autoencoder.py, AutoencoderKL init, created
Working with z of shape (1, 4, 32, 32) = 4096 dimensions.
making attention of type 'vanilla' with 512 in_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
ldm/modules/diffusionmodules/model.py, Resnet in_channels != out_channels
remove_png complete
合計 100 枚の画像をロードしました。20 枚ずつのチャンクで処理します。

--- 処理中: 画像 1 から 20 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 0)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.7532, 0.6074, 0.6583, 0.7701, 0.8240, 0.5942, 0.6361, 0.7516, 0.5557,
        0.6154, 0.4440, 0.5926, 0.5110, 0.4479, 0.4735, 0.6824, 0.6127, 1.1112,
        0.5367, 0.5905], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-5.0634, -4.6996, -4.8106, -4.9738, -4.6269, -5.1799, -5.4238, -3.8310,
        -4.9171, -4.1874, -5.5225, -5.0635, -5.1180, -5.0814, -3.9015, -3.8769,
        -4.9376, -6.1202, -5.1402, -4.5382], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.0443e+10-4.6122e+04j, 3.7565e+13+1.6309e+08j, 1.3227e+13+3.4599e+07j,
        6.2821e+12+5.8042e+06j, 1.4440e+13+4.7451e+06j, 6.1847e+12+1.3403e+07j,
        8.3559e+11+5.8468e+07j, 2.6313e+12+9.0772e+06j, 2.6556e+12+5.1987e+06j,
        2.0166e+12+9.8652e+06j, 6.7437e+11+1.1896e+06j, 4.0539e+12-6.4734e+06j,
        4.8520e+11-1.3729e+07j, 1.5626e+13+4.5883e+06j, 1.1859e+12+3.2870e+06j,
        1.9695e+11-1.9996e+06j, 3.4149e+12+2.7372e+06j, 1.5372e+11+7.4601e+04j,
        1.0516e+13-2.6246e+07j, 1.0996e+13-1.1071e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (6657567883264+12828035j)
SINR torch.Size([20]) = tensor([-30.2259, -17.6911, -19.8904, -18.0809, -16.6148, -17.6656, -27.2138,
        -19.1527, -29.7577, -19.6756, -19.7298, -17.5231, -24.3348, -17.0717,
        -16.2083, -21.9493, -16.1094, -19.5773, -18.1730, -16.2067],
       device='cuda:0')
SINR mean = -20.142587661743164
E[H^H] = 1e-07
E_MSE (Error Power) = 196.74620056152344
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0009, 0.0167, 0.0102, 0.0153, 0.0213, 0.0168, 0.0019, 0.0120, 0.0011,
        0.0107, 0.0105, 0.0174, 0.0037, 0.0192, 0.0234, 0.0063, 0.0239, 0.0109,
        0.0150, 0.0234], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  884,  932,  893,  860,  884, 1000,  916, 1000,  927,  928,  880,
        1000,  870,  850,  973,  848,  925,  895,  850], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -4-----------
Real SNR = tensor([-3.4764, -3.5933, -4.0919, -4.3844, -2.1505, -2.8923, -3.5130, -3.4219,
        -4.1158, -4.2136, -4.2141, -3.1590, -4.2208, -4.1656, -3.9750, -2.9881,
        -4.5392, -2.5252, -3.3063, -3.7668], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([5.5736e+10-1.4174e+05j, 5.7209e+11-5.9867e+06j, 3.7997e+12-2.9037e+07j,
        5.8148e+11+1.0116e+07j, 6.6456e+11-3.2768e+05j, 1.4558e+13-4.8261e+06j,
        3.5098e+12-3.0555e+07j, 2.0997e+10+4.4831e+06j, 1.0772e+14-2.4039e+05j,
        5.1600e+11-7.6636e+05j, 9.5334e+12+1.6749e+08j, 2.5381e+12-7.1859e+06j,
        2.7346e+11+7.7474e+05j, 1.0764e+13-1.0605e+08j, 1.1455e+12-4.0838e+06j,
        5.4242e+12+5.8857e+06j, 2.8984e+11+1.0978e+06j, 3.3469e+11+2.7430e+06j,
        2.4106e+12-1.3068e+06j, 4.0453e+12-2.3117e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8437732737024-11018.6005859375j)
SINR torch.Size([20]) = tensor([-28.4895, -25.1661, -18.3566, -27.1301, -19.0055, -18.2501, -24.1435,
        -32.4089, -11.9469, -17.2086, -23.3227, -17.8135, -20.3185, -20.3575,
        -17.9719, -16.1810, -18.6777, -24.2563, -19.4548, -16.2619],
       device='cuda:0')
SINR mean = -20.8360652923584
E[H^H] = 1e-07
E_MSE (Error Power) = 244.9748992919922
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0014, 0.0030, 0.0144, 0.0019, 0.0124, 0.0147, 0.0038, 0.0006, 0.0600,
        0.0187, 0.0046, 0.0163, 0.0092, 0.0091, 0.0157, 0.0235, 0.0134, 0.0037,
        0.0112, 0.0231], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000, 1000,  899, 1000,  913,  897, 1000, 1000,  742,  873, 1000,  887,
         941,  941,  890,  849,  906, 1000,  923,  851], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -3-----------
Real SNR = tensor([-3.6985, -2.1886, -2.9953, -2.6275, -3.6386, -3.5128, -1.5394, -1.6778,
        -3.0347, -2.9980, -3.1045, -4.0246, -3.1977, -2.3841, -2.7495, -2.6018,
        -3.5236, -3.0030, -1.8677, -1.9661], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([8.5587e+11-1.3206e+06j, 2.1468e+12+1.4508e+07j, 1.1004e+14+1.0207e+08j,
        3.1220e+12+1.4527e+08j, 3.9478e+11+7.9503e+05j, 2.9217e+10-6.6348e+05j,
        2.6973e+14-4.7978e+07j, 1.1563e+12+2.9405e+07j, 4.8054e+13-3.5386e+06j,
        7.0453e+13-1.1567e+08j, 3.9994e+11-4.0842e+06j, 8.2979e+10+7.2632e+05j,
        4.3434e+11+2.2185e+07j, 1.0764e+14+5.8536e+07j, 3.7022e+11+5.7885e+06j,
        1.3536e+12+4.7750e+06j, 3.3620e+12+4.3841e+06j, 8.2159e+11+6.2678e+06j,
        2.1817e+11-8.6516e+05j, 1.1900e+13+3.8154e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (31628495683584+12937207j)
SINR torch.Size([20]) = tensor([-19.5118, -18.6882, -13.6060, -29.5572, -20.3459, -24.3320, -13.0365,
        -32.1674, -12.6953, -14.4394, -21.9346, -19.7852, -27.9582, -14.7899,
        -21.0850, -17.5167, -18.4774, -21.4681, -18.0185, -17.2296],
       device='cuda:0')
SINR mean = -19.832157135009766
E[H^H] = 1e-07
E_MSE (Error Power) = 229.89781188964844
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0111, 0.0133, 0.0418, 0.0011, 0.0091, 0.0037, 0.0473, 0.0006, 0.0510,
        0.0347, 0.0064, 0.0104, 0.0016, 0.0321, 0.0077, 0.0174, 0.0140, 0.0071,
        0.0155, 0.0186], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 924,  906,  786, 1000,  941, 1000,  771, 1000,  762,  807,  973,  930,
        1000,  816,  956,  880,  902,  964,  891,  874], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -2-----------
Real SNR = tensor([-2.1098, -2.5656, -2.2068, -2.4855, -2.4637, -2.2789, -1.8993, -1.7173,
        -1.6259, -2.8448, -2.1863, -2.3305, -1.6619, -1.5158, -0.6990, -1.5136,
        -2.1565, -1.9485, -1.8749, -1.1549], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([8.5035e+13-2.6355e+07j, 2.1609e+12-1.2705e+07j, 8.1152e+10+3.1758e+05j,
        2.7399e+13+2.1106e+08j, 2.2003e+12-2.5464e+06j, 3.1213e+13+6.3234e+07j,
        6.2837e+11+1.6286e+07j, 7.8297e+12+4.7824e+07j, 3.7611e+12+7.1908e+06j,
        4.5501e+11+5.4253e+06j, 1.8122e+12+8.8107e+06j, 3.0313e+13-5.1875e+07j,
        1.1296e+13+6.5144e+05j, 1.3611e+13-2.0041e+07j, 2.8454e+11+6.9079e+05j,
        2.5872e+12+4.3172e+06j, 1.3961e+13-1.4136e+07j, 1.9345e+13-3.2699e+07j,
        1.7878e+13-8.0116e+07j, 2.6338e+11+3.5803e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (13605667864576+6284587.5j)
SINR torch.Size([20]) = tensor([-13.6968, -17.1785, -24.2023, -13.7718, -15.0285, -14.7472, -22.6618,
        -19.4164, -15.7508, -21.6432, -16.8006, -14.1932, -13.3599, -14.1684,
        -14.9440, -14.5844, -14.0243, -12.6676, -15.1081, -18.2954],
       device='cuda:0')
SINR mean = -16.31216049194336
E[H^H] = 1e-07
E_MSE (Error Power) = 60.2496223449707
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0409, 0.0188, 0.0038, 0.0403, 0.0305, 0.0324, 0.0054, 0.0113, 0.0259,
        0.0068, 0.0205, 0.0367, 0.0441, 0.0369, 0.0310, 0.0336, 0.0381, 0.0513,
        0.0299, 0.0146], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 788,  873, 1000,  790,  822,  815,  987,  922,  839,  967,  864,  801,
         780,  800,  820,  811,  797,  762,  824,  898], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = -1-----------
Real SNR = tensor([ 0.1330, -1.0470, -1.2788, -1.1534, -0.8769, -0.9119,  0.1313, -0.5599,
        -0.9560, -1.3166, -0.9399,  0.7065, -1.4961, -0.8526, -1.2334, -0.6769,
        -1.0294, -1.0563, -1.3552, -0.7542], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.6438e+13+9.2540e+07j, 1.2567e+13+1.0796e+07j, 3.0563e+11-1.8222e+06j,
        7.6305e+11+3.6650e+07j, 1.6226e+12-4.1407e+06j, 1.0298e+11+8.4798e+05j,
        2.4397e+13-3.2070e+08j, 1.3753e+10-5.3040e+06j, 6.1814e+11-1.6629e+06j,
        2.1398e+12+3.3525e+07j, 2.5923e+12-5.7347e+06j, 9.5258e+11-3.4349e+07j,
        2.1137e+12+1.8184e+07j, 4.9466e+12-1.2537e+07j, 1.3041e+12-5.9105e+06j,
        2.3924e+12-2.5690e+06j, 5.9625e+10-5.3613e+04j, 1.2056e+12+1.3302e+06j,
        3.1410e+10+1.2194e+06j, 3.7451e+12+7.8643e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (3915553964032-9591175j)
SINR torch.Size([20]) = tensor([-13.1944, -12.1909, -17.6191, -27.5564, -15.3213, -20.7385, -18.7606,
        -32.9750, -18.8236, -17.4100, -16.4943, -27.0877, -15.7292, -17.5909,
        -15.3813, -14.1482, -18.0902, -14.5690, -24.2503, -14.0208],
       device='cuda:0')
SINR mean = -18.59757423400879
E[H^H] = 1e-07
E_MSE (Error Power) = 205.17478942871094
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0457, 0.0569, 0.0170, 0.0018, 0.0285, 0.0084, 0.0131, 0.0005, 0.0129,
        0.0178, 0.0219, 0.0020, 0.0260, 0.0171, 0.0281, 0.0370, 0.0153, 0.0337,
        0.0037, 0.0381], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 775,  749,  883, 1000,  829,  949,  908, 1000,  909,  878,  857, 1000,
         839,  882,  830,  800,  893,  810, 1000,  797], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 0-----------
Real SNR = tensor([ 4.4224e-02, -2.5751e-01, -4.6123e-01, -6.5390e-01,  1.2489e+00,
        -3.5262e-01,  3.5032e-02,  1.4531e+00, -3.8219e-01,  1.9532e-01,
         7.6080e-02,  3.8713e-01,  3.2195e-03, -1.9698e-01,  2.9457e-04,
         5.2053e-01, -9.5061e-01,  1.9245e-01, -3.2768e-01, -4.7750e-01],
       device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.2532e+13-3.0743e+07j, 9.5052e+12-1.9735e+07j, 2.6182e+13-3.8151e+07j,
        1.4467e+12+4.5257e+06j, 8.6668e+13+9.6681e+07j, 5.6221e+11+6.8266e+05j,
        9.6024e+11-3.6205e+06j, 1.2738e+13-6.9681e+07j, 1.1260e+12+6.9108e+06j,
        8.8947e+11-2.1889e+05j, 6.2519e+13+2.8311e+06j, 2.4721e+13+8.9499e+07j,
        5.6249e+13+3.0975e+07j, 7.3693e+11-6.6233e+05j, 2.3953e+10+2.9951e+06j,
        3.8840e+12+7.6054e+07j, 8.8429e+11+2.0072e+06j, 1.4113e+13+1.6430e+07j,
        1.7929e+13+1.1314e+08j, 4.8129e+12+1.5442e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (17424088825856+14768053j)
SINR torch.Size([20]) = tensor([-12.2222, -15.5774, -10.5849, -17.1967, -12.9431, -13.4323, -16.3078,
        -14.1122, -15.0577, -17.7004, -11.1328, -15.2910,  -8.8463, -14.2665,
        -26.7799, -21.8712, -13.7760, -11.8007, -15.6280, -10.7724],
       device='cuda:0')
SINR mean = -14.764983177185059
E[H^H] = 1e-07
E_MSE (Error Power) = 55.82147216796875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0566, 0.0269, 0.0804, 0.0187, 0.0483, 0.0434, 0.0229, 0.0373, 0.0303,
        0.0167, 0.0715, 0.0287, 0.1154, 0.0361, 0.0021, 0.0065, 0.0402, 0.0620,
        0.0266, 0.0772], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 750,  835,  704,  873,  769,  782,  852,  799,  823,  884,  720,  828,
         653,  803, 1000,  972,  790,  738,  836,  709], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 1-----------
Real SNR = tensor([ 0.5657,  1.5454,  0.8811,  0.6436, -0.4791,  1.6177,  0.5845,  2.4287,
         0.8169,  0.4159,  0.8218,  1.7068,  0.9699,  1.9988,  1.4470,  1.7599,
         1.2857,  2.2132,  1.4724,  0.3761], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([7.6914e+12+9.5231e+05j, 4.7658e+12-2.2263e+07j, 1.8735e+12-2.9555e+06j,
        2.2635e+13+4.2602e+07j, 2.5170e+13+3.6819e+07j, 5.1733e+13+6.8770e+07j,
        2.4089e+12+1.5267e+07j, 5.0786e+12+4.7803e+07j, 1.9323e+12+4.0309e+06j,
        2.4918e+11+1.8593e+06j, 1.8487e+12+2.2135e+04j, 3.3125e+11+1.7934e+07j,
        3.6708e+13-4.5614e+07j, 1.5665e+13+5.6697e+06j, 1.0999e+11+6.1558e+05j,
        4.3134e+12+1.0672e+07j, 3.2526e+12-1.6158e+07j, 3.0642e+12-2.1253e+07j,
        8.7310e+12-2.8564e+07j, 7.8473e+11+1.9497e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (9917309124608+5820207.5j)
SINR torch.Size([20]) = tensor([-11.6288, -13.0736, -16.6438, -13.2285,  -9.3546, -10.9010, -14.4024,
        -16.6536, -14.3460, -18.6329, -10.7840, -20.8431,  -9.5443, -12.5937,
        -20.8142, -13.4757, -16.8542, -14.1764, -13.0238, -12.8777],
       device='cuda:0')
SINR mean = -14.192611694335938
E[H^H] = 1e-07
E_MSE (Error Power) = 35.704315185546875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0643, 0.0470, 0.0212, 0.0454, 0.1040, 0.0752, 0.0350, 0.0212, 0.0355,
        0.0135, 0.0771, 0.0082, 0.1000, 0.0522, 0.0082, 0.0430, 0.0202, 0.0368,
        0.0475, 0.0490], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([733, 772, 860, 776, 668, 713, 806, 861, 805, 905, 710, 951, 674, 760,
        951, 783, 865, 801, 771, 767], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 2-----------
Real SNR = tensor([2.2493, 2.8733, 1.1721, 2.1015, 3.3521, 2.9690, 2.6865, 3.4634, 1.8666,
        1.9092, 1.8407, 2.5583, 1.9316, 2.6167, 1.0632, 1.7949, 1.4126, 2.6718,
        1.6465, 2.4662], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([6.3068e+10+9.5642e+05j, 6.9642e+12+1.0124e+07j, 4.3970e+10-8.2176e+06j,
        7.7314e+12+2.4327e+07j, 1.8650e+12+5.1445e+06j, 8.6162e+14-1.5600e+09j,
        3.5144e+12+8.1318e+06j, 2.0973e+12-3.5121e+06j, 1.8025e+13-3.0773e+07j,
        8.7115e+11+2.0233e+06j, 6.3624e+12-2.9584e+07j, 4.2785e+12+1.5093e+07j,
        2.2333e+11+9.5268e+05j, 1.3396e+12-6.0268e+05j, 2.8457e+10+2.7118e+06j,
        1.6027e+13-3.0822e+07j, 6.6865e+12-1.6687e+07j, 1.7522e+12+1.0489e+07j,
        5.4362e+11+1.0622e+06j, 7.0078e+11-5.7045e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (47036946710528-80246552j)
SINR torch.Size([20]) = tensor([-21.1126, -11.8737, -26.9804, -12.6252, -11.0081,  -7.4515, -11.4067,
        -13.2261, -11.0058, -11.3146, -13.8170, -12.0087, -12.7814, -15.6599,
        -23.7709, -10.0555,  -9.8021, -16.0240, -15.0333, -15.4855],
       device='cuda:0')
SINR mean = -14.122148513793945
E[H^H] = 1e-07
E_MSE (Error Power) = 60.09019088745117
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0077, 0.0610, 0.0020, 0.0518, 0.0735, 0.1524, 0.0675, 0.0454, 0.0735,
        0.0688, 0.0399, 0.0592, 0.0501, 0.0264, 0.0042, 0.0899, 0.0947, 0.0244,
        0.0304, 0.0275], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 957,  740, 1000,  760,  716,  609,  727,  776,  716,  725,  792,  744,
         765,  837, 1000,  689,  681,  846,  822,  833], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 3-----------
Real SNR = tensor([3.6508, 2.9496, 3.0328, 2.9064, 4.6136, 3.0903, 3.4050, 3.8507, 2.8686,
        3.0455, 3.0382, 3.0538, 3.6311, 3.2640, 3.4809, 4.6072, 3.4561, 2.8095,
        3.6106, 2.5048], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([5.9438e+11-3.5551e+06j, 1.0873e+11+6.0658e+06j, 6.6741e+11+2.2673e+06j,
        6.2661e+13+1.0198e+07j, 3.0699e+13-3.4099e+08j, 3.0400e+13+6.6850e+06j,
        1.5946e+12+3.8463e+06j, 2.2611e+14+1.2243e+08j, 5.0536e+12+5.9785e+06j,
        1.4009e+13-3.5381e+07j, 2.0941e+12-5.9062e+06j, 2.7158e+13-2.1872e+07j,
        8.1254e+10+1.0574e+07j, 2.2792e+13-3.3857e+07j, 4.8256e+10+1.4749e+06j,
        2.1305e+12+3.3241e+06j, 1.2791e+12+9.5363e+06j, 2.3977e+12+2.6328e+07j,
        2.0193e+13+3.9995e+07j, 1.0494e+13-4.6423e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (23028475887616-9875242j)
SINR torch.Size([20]) = tensor([-12.2882, -22.5146, -10.7072,  -6.9386, -13.0129,  -7.2746, -16.0265,
         -4.8250, -11.2674,  -8.5480, -10.3521,  -8.1031, -31.4385,  -7.9442,
        -22.5597, -11.8468, -11.4767, -11.8097, -12.1935, -10.2565],
       device='cuda:0')
SINR mean = -12.569193840026855
E[H^H] = 1e-07
E_MSE (Error Power) = 98.36029052734375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0558, 0.0056, 0.0783, 0.1683, 0.0476, 0.1578, 0.0244, 0.2477, 0.0695,
        0.1226, 0.0844, 0.1340, 0.0007, 0.1383, 0.0055, 0.0614, 0.0664, 0.0618,
        0.0569, 0.0861], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 751,  985,  708,  593,  771,  604,  846,  523,  723,  644,  697,  630,
        1000,  625,  985,  739,  729,  738,  749,  695], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 4-----------
Real SNR = tensor([4.0201, 4.6177, 5.0803, 3.7723, 4.3641, 3.4838, 4.9773, 4.7440, 3.8352,
        4.0205, 4.8426, 4.3712, 4.7070, 4.6780, 5.4939, 4.6173, 4.1166, 4.8352,
        4.7914, 5.4085], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([6.4420e+11+1541163.8750j, 9.4150e+12-21058140.0000j,
        4.3900e+12-14614717.0000j, 2.7386e+12+21613532.0000j,
        1.2475e+12+1091797.8750j, 1.4202e+12+37429416.0000j,
        1.3704e+14-66316772.0000j, 9.0249e+12-21171418.0000j,
        3.9276e+11-549530.2500j, 1.3569e+13+18060768.0000j,
        2.4942e+13-21135600.0000j, 5.1367e+12-60933764.0000j,
        3.6411e+12+2469087.7500j, 4.6094e+13+68365320.0000j,
        5.7238e+11-6517143.5000j, 8.1892e+11+649671.4375j,
        1.4898e+12-3696231.5000j, 2.4654e+12+21233664.0000j,
        8.1269e+11-2801941.5000j, 3.2251e+12-17871714.0000j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (13453896974336-3210627.5j)
SINR torch.Size([20]) = tensor([-14.5829, -10.2700,  -9.8612, -10.8626, -11.6951, -15.7729,  -7.5322,
        -11.7792, -12.7483,  -9.0187,  -9.4897, -12.6165, -11.6698,  -6.6718,
        -16.6213,  -9.0171, -10.1063, -16.5752, -15.4944,  -9.7192],
       device='cuda:0')
SINR mean = -11.605216979980469
E[H^H] = 1e-07
E_MSE (Error Power) = 18.10474967956543
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0336, 0.0859, 0.0936, 0.0758, 0.0634, 0.0258, 0.1500, 0.0623, 0.0504,
        0.1114, 0.1011, 0.0519, 0.0637, 0.1771, 0.0213, 0.1114, 0.0889, 0.0215,
        0.0274, 0.0964], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([811, 695, 683, 712, 735, 840, 612, 738, 764, 658, 672, 760, 735, 584,
        860, 658, 690, 859, 833, 679], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 5-----------
Real SNR = tensor([4.9951, 5.7109, 5.0163, 5.3883, 5.4043, 4.4066, 5.3022, 6.2891, 5.3257,
        4.7562, 5.2577, 5.9122, 4.3140, 4.7961, 5.9308, 4.9091, 5.9809, 4.7156,
        4.8888, 4.4576], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, nan+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([8.7414e+11+3.3876e+06j, 8.6839e+11+1.1599e+07j, 5.7082e+13+2.0113e+07j,
        6.7498e+10-5.8135e+05j, 1.3479e+13-1.3173e+07j, 5.8018e+12-7.8229e+06j,
        1.0831e+11-1.5460e+07j, 7.7611e+11-4.4296e+06j, 9.4662e+12+1.2873e+07j,
        7.2299e+10-2.2621e+07j, 1.5882e+13+1.1144e+08j, 1.7126e+13+1.2178e+07j,
        1.2327e+12+7.4779e+05j, 5.7754e+12+2.6619e+06j, 2.9499e+12-3.6084e+06j,
        2.9297e+11-8.1008e+06j, 7.1027e+12+1.8857e+07j, 5.6248e+12+4.9796e+06j,
        7.2289e+11-5.3443e+06j, 1.5747e+13+1.6980e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8052673085440+5893256.5j)
SINR torch.Size([20]) = tensor([-12.5928, -11.7249,  -3.8877, -19.9328,  -6.8845,  -9.5789, -25.1891,
        -13.1539,  -6.5413, -25.6495,  -9.6321, -11.3721,  -9.7713,  -6.7562,
         -9.3643, -16.0525,  -7.1630,  -6.4351, -15.6324,  -4.9633],
       device='cuda:0')
SINR mean = -11.613886833190918
E[H^H] = 1e-07
E_MSE (Error Power) = 50.2721061706543
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0522, 0.0630, 0.2900, 0.0101, 0.1701, 0.0992, 0.0030, 0.0461, 0.1815,
        0.0027, 0.0982, 0.0680, 0.0954, 0.1743, 0.1038, 0.0242, 0.1612, 0.1852,
        0.0266, 0.2418], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 760,  736,  490,  933,  591,  675, 1000,  774,  580, 1000,  676,  726,
         680,  587,  668,  846,  600,  576,  836,  527], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 6-----------
Real SNR = tensor([6.2392, 6.5932, 5.5572, 6.2896, 7.5368, 5.8457, 6.7422, 7.4769, 5.6854,
        6.2739, 5.7397, 5.8995, 6.7491, 5.5605, 6.1346, 7.3017, 5.7388, 4.1427,
        6.0681, 5.7650], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.9803e+10+3.1252e+07j, 1.8911e+13+1.3458e+08j, 3.8433e+12-7.1339e+06j,
        4.2644e+12-2.8545e+07j, 3.8284e+11-2.7365e+05j, 3.0578e+12-1.4891e+07j,
        2.3239e+12-1.2686e+07j, 4.6255e+12-4.6492e+06j, 1.2812e+13+1.0494e+06j,
        1.3550e+13+3.5153e+07j, 9.1156e+10-9.3835e+05j, 3.1825e+12+2.1227e+05j,
        8.2090e+11+6.3152e+06j, 1.4006e+13+1.9850e+07j, 4.6640e+12+1.0128e+07j,
        1.3526e+14-1.1986e+08j, 2.3496e+12-1.8208e+07j, 3.0858e+12-2.5002e+06j,
        3.5651e+13+1.7430e+08j, 1.2123e+12+1.4004e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (13206910140416+10857684j)
SINR torch.Size([20]) = tensor([-27.4864,  -9.7358,  -5.2956, -14.5027,  -6.3572,  -7.4654, -14.4904,
         -6.2827,  -4.5503,  -6.1485, -13.9409,  -6.8923, -14.6792,  -4.6774,
         -9.9308,  -5.4254,  -8.9596,  -5.9373,  -6.8803, -11.2808],
       device='cuda:0')
SINR mean = -9.545964241027832
E[H^H] = 1e-07
E_MSE (Error Power) = 37.810726165771484
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0018, 0.0961, 0.2280, 0.0342, 0.1879, 0.1520, 0.0343, 0.1905, 0.2597,
        0.1953, 0.0388, 0.1698, 0.0329, 0.2541, 0.0922, 0.2228, 0.1127, 0.2031,
        0.1702, 0.0693], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  679,  539,  809,  574,  610,  809,  571,  513,  567,  795,  591,
         813,  518,  685,  543,  656,  560,  591,  724], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 7-----------
Real SNR = tensor([6.4188, 6.8433, 7.1372, 7.6423, 9.3772, 7.6017, 7.0439, 7.6135, 6.3573,
        7.8331, 6.9269, 7.0890, 6.5665, 7.0188, 9.0009, 7.4929, 7.2966, 8.1617,
        7.4624, 7.4260], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([       inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
        2.0917e+37+1.3507e+33j,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([6.4628e+12+18190240.0000j, 3.8303e+13-16198530.0000j,
        1.7357e+13-25764960.0000j, 8.6184e+10+963020.6875j,
        2.1724e+12-19953026.0000j, 4.9936e+12-21805592.0000j,
        1.8695e+13-11949909.0000j, 5.1327e+11+2278038.5000j,
        1.4330e+12-3761378.7500j, 3.2422e+12+8105122.0000j,
        2.1142e+12+9417501.0000j, 4.3222e+13-80165232.0000j,
        2.7179e+12-1766762.2500j, 9.8478e+12-22786036.0000j,
        5.6302e+12-2263767.7500j, 3.7028e+12-4703332.0000j,
        1.3667e+13+14322898.0000j, 2.3319e+13+58081872.0000j,
        2.1621e+14-5461114.0000j, 1.0801e+13+1372134.2500j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (21224386199552-5192440.5j)
SINR torch.Size([20]) = tensor([ -5.2423,  -3.6937,  -5.7277, -14.6470, -13.9854,  -6.5691,  -7.0900,
         -8.2245,  -4.7440,  -6.4469, -11.4652,  -6.5469,  -6.1915,  -5.3270,
         -5.4376,  -4.4973,  -8.9991,  -8.3035,  -1.7948,  -3.0649],
       device='cuda:0')
SINR mean = -6.8999176025390625
E[H^H] = 1e-07
E_MSE (Error Power) = 6.898755073547363
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2302, 0.2993, 0.2110, 0.0332, 0.0384, 0.1806, 0.1635, 0.1308, 0.2512,
        0.1848, 0.0666, 0.1813, 0.1938, 0.2268, 0.2223, 0.2620, 0.1118, 0.1288,
        0.3981, 0.3305], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([537, 484, 553, 812, 796, 581, 598, 634, 520, 577, 729, 580, 568, 540,
        543, 511, 657, 636, 417, 462], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 8-----------
Real SNR = tensor([8.0478, 7.4169, 7.6246, 9.1903, 7.6606, 8.4197, 8.9995, 7.4540, 8.0981,
        6.8738, 7.9850, 7.4283, 8.5362, 8.0492, 8.3984, 9.4036, 8.5738, 7.6456,
        8.6185, 7.5959], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([       inf+nanj,        inf+nanj, 2.7409e+38+1.4613e+33j,
        2.0336e+37+2.0177e+31j,        inf+nanj, 4.8448e+37-6.8800e+31j,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj, 7.5177e+37-2.4342e+31j, 1.2399e+38-2.1758e+33j,
        1.7346e+38+2.7536e+31j,        inf+nanj,        inf+nanj,
        3.2927e+38-3.4563e+32j, 3.0979e+38+4.8564e+32j, 1.3237e+37-3.2445e+31j,
               inf+nanj,        inf+nanj], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([2.3445e+13+4.3391e+07j, 2.4750e+13+1.1149e+07j, 1.5721e+11-4.3910e+06j,
        7.7213e+12+2.6222e+07j, 2.7427e+13-2.3704e+06j, 5.3146e+11-2.7694e+07j,
        2.1959e+13-1.5530e+07j, 1.1294e+11+5.1137e+06j, 2.0636e+11+6.1708e+05j,
        4.3149e+11-2.1791e+06j, 5.8788e+12+4.5371e+06j, 1.2419e+12+7.0317e+06j,
        1.6857e+13+2.4338e+07j, 3.8432e+13-1.1427e+07j, 1.0356e+12+3.1536e+06j,
        2.7709e+12+1.1568e+08j, 2.6869e+12+3.2923e+06j, 6.2617e+12+3.7871e+07j,
        7.7736e+11-4.5006e+06j, 6.4883e+12-1.6317e+08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (9458641010688+2556804j)
SINR torch.Size([20]) = tensor([ -5.5323,  -1.4907, -12.9772,  -5.8358,  -4.0594, -15.0064,  -7.3803,
        -16.9346, -11.3289,  -8.4100,  -3.6318,  -8.3537,  -2.7584,  -2.9616,
         -7.9453, -17.4296,  -6.9650,  -6.6028,  -7.4577, -12.0542],
       device='cuda:0')
SINR mean = -8.2557954788208
E[H^H] = 1e-07
E_MSE (Error Power) = 12.201057434082031
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2186, 0.4150, 0.0480, 0.2069, 0.2820, 0.0306, 0.1545, 0.0199, 0.0686,
        0.1260, 0.3023, 0.1275, 0.3463, 0.3358, 0.1383, 0.0178, 0.1675, 0.1794,
        0.1522, 0.0587], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([547, 406, 770, 557, 496, 821, 607, 867, 725, 639, 481, 638, 451, 458,
        625, 878, 594, 582, 609, 745], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)
--------SNR = 9-----------
Real SNR = tensor([ 8.8791,  9.6440,  9.2051,  9.4288,  7.9020,  8.5555,  8.8035,  7.3219,
         9.0830,  9.6603,  8.7240,  8.9326,  8.8956,  9.1320,  9.5590, 10.1603,
        10.7294,  9.7240,  9.4945,  9.5844], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.3825e+36-2.1136e+31j, 7.0792e+37-4.3859e+31j, 8.0021e+36-5.8680e+31j,
        1.0790e+36-2.9852e+31j, 1.4081e+37+5.5818e+31j, 2.4117e+37+5.0969e+30j,
        8.4284e+37+6.5010e+31j, 4.5861e+36-7.6488e+29j, 1.4311e+37+9.9776e+31j,
        3.7813e+36+3.1100e+31j,        inf+nanj, 1.1809e+38+7.9908e+32j,
        9.1003e+37-4.7806e+31j, 1.9048e+35-3.7867e+31j, 9.3090e+37-2.3906e+31j,
        4.3431e+36+1.0374e+30j, 3.2417e+37+1.6692e+32j, 6.0777e+36+4.6869e+31j,
        1.8483e+36-4.5195e+28j, 5.7597e+36-2.3097e+31j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([6.7827e+11-3.5575e+07j, 2.6485e+13+3.1634e+07j, 3.0364e+13+5.5508e+06j,
        1.8860e+13+5.1155e+07j, 7.3696e+13+1.2442e+08j, 1.1227e+12-2.6542e+06j,
        2.7916e+12+5.3810e+06j, 9.4394e+12-3.5588e+07j, 9.1206e+11+8.5204e+06j,
        3.5853e+13+3.3554e+07j, 1.5822e+12-4.4571e+06j, 8.0701e+10+1.2969e+07j,
        2.8434e+11-8.8632e+05j, 3.9253e+11-6.0647e+05j, 7.8859e+11+1.1823e+06j,
        2.5013e+12-5.7321e+06j, 5.1719e+13+1.1622e+07j, 1.1163e+11+1.3067e+06j,
        1.1549e+10+3.0439e+06j, 4.1353e+13-6.2172e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (14951281328128+9931263j)
SINR torch.Size([20]) = tensor([-17.0541,  -0.4516,  -1.9151,  -6.7747,  -0.1966,  -3.2647,  -5.7243,
         -4.3940, -12.7180,  -2.4272,  -4.3296, -25.4478,  -8.0949,  -7.6890,
         -9.1558,  -5.9136,  -2.5251, -12.2658, -28.3571,  -1.7230],
       device='cuda:0')
SINR mean = -8.021090507507324
E[H^H] = 1e-07
E_MSE (Error Power) = 58.5565299987793
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0193, 0.4740, 0.3915, 0.1737, 0.4887, 0.3204, 0.2111, 0.2666, 0.0508,
        0.3638, 0.2695, 0.0028, 0.1342, 0.1455, 0.1083, 0.2040, 0.3586, 0.0560,
        0.0015, 0.4021], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 870,  370,  421,  588,  361,  469,  553,  508,  763,  439,  506, 1000,
         630,  617,  662,  559,  443,  751, 1000,  415], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 0)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 0)

--- 処理中: 画像 21 から 40 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 20)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.5159, 0.4950, 0.6478, 0.5684, 0.4894, 0.5508, 0.6202, 0.6527, 0.5857,
        0.6284, 0.7064, 0.7388, 0.7715, 0.6258, 0.9953, 0.6690, 0.7055, 0.8390,
        0.6214, 0.6514], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-4.9736, -4.0332, -5.3467, -5.1115, -4.4811, -3.9455, -5.4613, -5.4801,
        -5.7510, -2.8808, -6.0062, -4.2788, -4.1249, -3.5388, -4.2463, -3.7321,
        -4.2599, -3.9786, -4.6919, -5.3139], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.0396e+13-2.7059e+07j, 2.0343e+14-2.1921e+08j, 9.6225e+10-2.4950e+04j,
        3.2035e+12+7.9954e+06j, 3.4527e+13+7.7323e+07j, 1.9883e+13-1.0536e+08j,
        3.8215e+11+5.0089e+06j, 8.0790e+11+1.0485e+06j, 6.3661e+11-7.1447e+06j,
        8.2371e+13-8.7795e+06j, 2.1009e+11+1.6434e+06j, 2.7745e+12+7.9812e+06j,
        7.0588e+10-3.1490e+05j, 9.1525e+12+9.5300e+06j, 1.1816e+14-2.0267e+08j,
        1.3715e+13-2.4639e+07j, 5.9663e+10+3.8361e+07j, 1.1099e+12+1.0633e+07j,
        5.0124e+11+7.0072e+06j, 6.7548e+11+7.6714e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (25607742160896-21395092j)
SINR torch.Size([20]) = tensor([-14.9979, -16.2121, -27.6629, -17.8968, -18.5414, -19.6191, -23.7788,
        -24.2891, -22.3061, -15.0068, -22.1415, -20.8097, -31.4711, -19.1772,
        -17.2808, -14.7302, -38.8611, -22.8299, -23.8824, -21.3904],
       device='cuda:0')
SINR mean = -21.644262313842773
E[H^H] = 1e-07
E_MSE (Error Power) = 585.40771484375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0307, 0.0234, 0.0017, 0.0160, 0.0138, 0.0108, 0.0042, 0.0037, 0.0058,
        0.0306, 0.0061, 0.0082, 0.0007, 0.0119, 0.0184, 0.0326, 0.0001, 0.0052,
        0.0041, 0.0072], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 821,  850, 1000,  889,  903,  926, 1000, 1000,  980,  821,  977,  951,
        1000,  917,  875,  814, 1000,  991, 1000,  962], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -4-----------
Real SNR = tensor([-4.6166, -3.8004, -3.1963, -3.9974, -3.9338, -3.6176, -3.1502, -4.3377,
        -4.5733, -3.2211, -3.2369, -3.3124, -4.0116, -1.8182, -2.2171, -5.0816,
        -3.9309, -4.6227, -3.0942, -6.0559], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.7860e+11+2.2628e+06j, 2.0355e+10-2.1254e+06j, 4.9437e+11+4.9930e+06j,
        6.2467e+12-6.4978e+06j, 8.2750e+12+8.9339e+06j, 6.0731e+12+1.1751e+07j,
        4.6131e+12+3.3039e+06j, 4.5248e+12+6.5230e+06j, 1.2162e+13+4.6441e+07j,
        6.9171e+13+1.1209e+08j, 1.3854e+12+8.2805e+06j, 1.6905e+13+2.6132e+07j,
        2.9580e+12-2.8125e+07j, 5.2815e+12-0.0000e+00j, 5.8294e+12+8.7684e+06j,
        1.4484e+12+5.6118e+06j, 3.2088e+11+3.0073e+06j, 1.9380e+12-2.0186e+06j,
        1.5948e+13+1.7917e+07j, 1.3698e+12+1.7110e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8267162976256+12218079j)
SINR torch.Size([20]) = tensor([-23.4564, -30.4029, -23.5223, -19.0544, -14.8143, -22.5583, -21.2274,
        -21.9876, -22.5253, -15.4681, -20.6327, -14.7921, -17.8214, -17.6593,
        -18.0575, -18.9817, -23.9623, -22.3294, -15.6453, -20.4544],
       device='cuda:0')
SINR mean = -20.267656326293945
E[H^H] = 1e-07
E_MSE (Error Power) = 165.72866821289062
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0045, 0.0009, 0.0044, 0.0123, 0.0319, 0.0055, 0.0075, 0.0063, 0.0056,
        0.0276, 0.0086, 0.0321, 0.0162, 0.0169, 0.0154, 0.0125, 0.0040, 0.0058,
        0.0265, 0.0089], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000, 1000, 1000,  914,  817,  985,  959,  974,  985,  833,  947,  816,
         887,  883,  892,  912, 1000,  981,  837,  943], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -3-----------
Real SNR = tensor([-3.2485, -2.2240, -2.2357, -2.4406, -2.8103, -3.9520, -2.8179, -2.5449,
        -2.6753, -1.4535, -1.7276, -4.0825, -2.6180, -0.4402, -3.1452, -2.1868,
        -2.6616, -1.9194, -3.1751, -4.2016], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([4.7439e+11-4.4410e+06j, 5.3459e+13+2.7419e+07j, 4.9398e+12+9.0244e+06j,
        2.2642e+13+2.3995e+07j, 1.0739e+12-1.9661e+05j, 1.4951e+12-1.7102e+06j,
        6.3035e+11+2.5567e+06j, 3.3719e+14-6.4899e+08j, 3.0527e+13+4.1070e+08j,
        3.3781e+13+3.4576e+06j, 4.3735e+12-1.5110e+07j, 1.0300e+10+7.4827e+04j,
        8.0765e+12-1.2112e+07j, 2.3269e+11+2.5679e+07j, 2.1108e+12-6.6757e+06j,
        5.4944e+12+1.3112e+07j, 1.8023e+12+4.0579e+06j, 1.7095e+12-7.1795e+07j,
        1.0145e+12-6.0763e+06j, 1.1322e+10+8.6779e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (25552207478784-12308103j)
SINR torch.Size([20]) = tensor([-23.7174, -14.8029, -21.4588, -15.9545, -17.7071, -16.5993, -20.9607,
        -12.9557, -18.7708, -17.3794, -16.5968, -27.8361, -15.2885, -32.0449,
        -17.9222, -16.2020, -23.4810, -23.6648, -20.0981, -35.0770],
       device='cuda:0')
SINR mean = -20.42589569091797
E[H^H] = 1e-07
E_MSE (Error Power) = 348.9999694824219
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0042, 0.0320, 0.0071, 0.0248, 0.0167, 0.0214, 0.0080, 0.0482, 0.0131,
        0.0180, 0.0214, 0.0016, 0.0287, 0.0006, 0.0159, 0.0234, 0.0045, 0.0043,
        0.0097, 0.0003], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  816,  964,  844,  885,  859,  954,  769,  908,  877,  859, 1000,
         828, 1000,  889,  850, 1000, 1000,  936, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -2-----------
Real SNR = tensor([-1.4844, -1.6135, -1.3579, -1.6391, -1.2932, -2.8495, -1.3986, -1.4553,
        -1.9137, -0.6162, -2.3942, -0.1547, -0.3428, -0.2719, -1.6061, -2.1617,
        -1.1478, -1.7919, -1.5037, -1.1432], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([5.3840e+12-1.4953e+07j, 8.0041e+13+1.6118e+07j, 4.0507e+12+1.0731e+07j,
        2.5215e+13+7.8558e+07j, 1.3528e+15+1.5698e+09j, 1.7513e+12+3.1752e+07j,
        2.8808e+12+1.8667e+07j, 7.8902e+11-1.0526e+07j, 8.4041e+11-3.0046e+06j,
        5.1528e+12-2.2919e+07j, 2.0794e+13-4.3706e+07j, 3.4986e+12+4.9471e+07j,
        2.0040e+11-1.0650e+07j, 3.3751e+13-6.7921e+07j, 1.1464e+12+5.1974e+06j,
        3.0899e+14+1.5224e+08j, 1.7194e+13-9.5865e+07j, 7.7571e+11-7.7173e+06j,
        1.4674e+12+2.6928e+06j, 3.1495e+11-1.0800e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (93350870908928+82843104j)
SINR torch.Size([20]) = tensor([-17.9193, -13.5662, -16.9908, -14.0573, -10.8245, -23.7590, -18.5044,
        -20.3170, -17.5022, -15.1873, -15.1086, -18.1506, -23.4850, -14.3819,
        -21.0429, -10.1955, -16.0568, -20.1592, -18.1079, -22.3115],
       device='cuda:0')
SINR mean = -17.381397247314453
E[H^H] = 1e-07
E_MSE (Error Power) = 77.09661865234375
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0159, 0.0421, 0.0196, 0.0378, 0.0764, 0.0042, 0.0139, 0.0092, 0.0175,
        0.0294, 0.0299, 0.0151, 0.0045, 0.0352, 0.0078, 0.0873, 0.0242, 0.0095,
        0.0152, 0.0058], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 889,  785,  868,  798,  711, 1000,  902,  941,  880,  826,  824,  894,
        1000,  806,  955,  693,  847,  937,  893,  981], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = -1-----------
Real SNR = tensor([-0.6775, -0.8896, -0.8743, -0.0824, -1.2179, -0.4743, -0.9414, -0.4616,
        -1.2548,  0.1494, -1.8747, -1.5554,  0.0419, -0.9676,  0.1004,  0.2163,
        -0.8900, -1.1001, -0.3370, -0.4337], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.3633e+12+2.4704e+07j, 2.6001e+12+5.2429e+05j, 2.2907e+13+1.3391e+07j,
        2.4128e+12+5.1004e+06j, 4.2746e+11+4.8930e+05j, 3.8082e+13+3.3759e+07j,
        8.0133e+10-2.2752e+06j, 3.3973e+13-5.8442e+07j, 2.6182e+12+1.2594e+07j,
        7.6450e+11+1.2317e+07j, 9.9182e+11+7.5614e+05j, 3.3106e+11+5.1777e+06j,
        1.3889e+14+2.1022e+08j, 1.8720e+12+7.2099e+06j, 1.1675e+12-5.4844e+07j,
        5.4563e+12-1.4021e+06j, 9.4985e+13+1.7579e+07j, 4.5008e+11-1.7311e+06j,
        1.0789e+12+9.1393e+06j, 1.1147e+13-9.7543e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (18179870949376+11225365j)
SINR torch.Size([20]) = tensor([-17.1651, -13.8729, -13.1446, -16.2078, -18.5370, -11.8490, -27.9809,
        -10.0598, -16.6086, -21.3057, -15.1254, -19.5751, -14.3638, -20.0607,
        -23.4589, -14.3826, -11.2390, -23.0833, -19.0209, -13.0681],
       device='cuda:0')
SINR mean = -17.00546646118164
E[H^H] = 1e-07
E_MSE (Error Power) = 93.1140365600586
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0188, 0.0394, 0.0462, 0.0234, 0.0138, 0.0613, 0.0016, 0.0898, 0.0214,
        0.0073, 0.0298, 0.0109, 0.0353, 0.0098, 0.0045, 0.0352, 0.0699, 0.0049,
        0.0124, 0.0470], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 872,  793,  774,  850,  903,  739, 1000,  689,  859,  961,  824,  925,
         805,  935, 1000,  806,  723,  995,  913,  772], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 0-----------
Real SNR = tensor([ 0.2540,  0.8429,  0.3688, -0.1068, -0.0450,  0.0488,  0.3804, -0.2861,
         0.1134,  0.7241, -0.4603,  0.6191,  0.5763,  1.6669,  1.5802, -1.0749,
         2.2489,  0.4113,  0.9829, -0.2097], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.6783e+13+5.2368e+07j, 1.2628e+12-2.7219e+06j, 8.5620e+12+1.2408e+07j,
        2.9284e+12-7.3473e+07j, 1.4862e+12-6.2472e+05j, 2.2956e+11-3.2309e+05j,
        3.3845e+12+3.4856e+06j, 1.0902e+11+3.0552e+06j, 2.9860e+13+3.0242e+07j,
        3.8620e+11-6.2457e+06j, 1.0443e+11+4.7898e+06j, 8.1334e+12+1.9452e+07j,
        9.9098e+11+4.0672e+07j, 3.4617e+12+3.1919e+06j, 3.8874e+11-1.6996e+06j,
        5.5686e+13-3.7818e+07j, 2.9137e+12+1.2397e+07j, 2.7919e+12-2.5684e+06j,
        1.3851e+13+1.7302e+08j, 4.7577e+13+7.7664e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10044560113664+15363383j)
SINR torch.Size([20]) = tensor([-14.9445, -15.8690, -13.9953, -21.6305, -16.3238, -18.9779, -14.4657,
        -21.4611,  -9.2762, -24.3866, -23.0030, -13.9781, -24.7350, -18.2538,
        -16.8750,  -9.0734, -17.7323, -12.4842, -17.4594, -10.0346],
       device='cuda:0')
SINR mean = -16.747968673706055
E[H^H] = 1e-07
E_MSE (Error Power) = 80.12378692626953
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0310, 0.0252, 0.0383, 0.0068, 0.0228, 0.0125, 0.0345, 0.0071, 0.1057,
        0.0036, 0.0050, 0.0385, 0.0033, 0.0147, 0.0201, 0.1101, 0.0166, 0.0534,
        0.0176, 0.0903], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 820,  842,  796,  967,  853,  912,  808,  964,  666, 1000,  994,  796,
        1000,  897,  866,  660,  885,  757,  879,  688], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 1-----------
Real SNR = tensor([1.5711, 0.7439, 1.6997, 0.8757, 0.6967, 0.9187, 0.6692, 0.5695, 0.9830,
        2.1287, 1.1457, 0.7511, 0.8224, 1.5430, 3.4779, 0.9097, 1.2480, 2.4582,
        0.9228, 0.1092], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.6592e+14+3.1630e+08j, 6.6079e+12-9.1116e+06j, 2.3787e+12+3.6690e+06j,
        1.9843e+12+2.5227e+07j, 9.2989e+11-1.5707e+06j, 2.4968e+11-2.4576e+04j,
        1.6813e+12-1.3280e+06j, 2.0572e+13+3.9622e+07j, 4.4363e+12+2.2791e+07j,
        2.2579e+13+6.7108e+07j, 3.2519e+12+2.6682e+06j, 9.9021e+12+1.7579e+06j,
        2.1810e+12+5.1656e+07j, 2.0461e+12+4.4874e+07j, 6.6891e+12-1.3488e+08j,
        6.5839e+13+1.8094e+08j, 1.6281e+12+1.1430e+07j, 1.4704e+13-6.7998e+07j,
        3.8719e+12-2.8472e+06j, 1.1770e+13+5.4518e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (22460927836160+27786756j)
SINR torch.Size([20]) = tensor([ -9.0451,  -9.9642, -14.0268, -15.8698, -12.1854, -16.2398, -10.2455,
        -10.9520, -16.3421, -12.0290, -18.1018, -10.2261, -20.4852, -20.6785,
        -18.9227, -10.9518, -13.6473, -15.0004, -14.8226,  -8.6226],
       device='cuda:0')
SINR mean = -13.917933464050293
E[H^H] = 1e-07
E_MSE (Error Power) = 35.451271057128906
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1108, 0.0916, 0.0381, 0.0252, 0.0570, 0.0232, 0.0863, 0.0743, 0.0227,
        0.0590, 0.0152, 0.0867, 0.0089, 0.0085, 0.0127, 0.0743, 0.0414, 0.0307,
        0.0319, 0.1207], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([659, 686, 797, 842, 749, 851, 694, 715, 853, 744, 893, 694, 944, 948,
        911, 715, 787, 821, 817, 646], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 2-----------
Real SNR = tensor([1.8641, 3.3564, 1.9708, 2.8368, 2.2114, 2.0808, 1.7109, 1.0746, 0.9428,
        4.1203, 2.3863, 2.1659, 2.2125, 2.7648, 0.7336, 2.0959, 3.6482, 2.2395,
        2.5336, 2.4848], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.6604e+12+5.2650e+06j, 2.5240e+12+1.2371e+06j, 4.2206e+10+2.3235e+06j,
        1.4278e+11-3.0904e+06j, 1.4598e+13-1.1416e+07j, 1.8398e+13-6.1552e+07j,
        4.6421e+12+1.7387e+06j, 7.0961e+11-5.8064e+05j, 1.0352e+11-4.4230e+05j,
        4.5878e+13-2.6575e+07j, 7.3386e+12+9.6971e+07j, 6.4003e+11-6.1289e+06j,
        5.5731e+10+2.5341e+05j, 8.4465e+12-7.5630e+06j, 3.0034e+12+7.9657e+05j,
        3.7624e+12-1.6421e+07j, 8.6137e+13-6.3330e+07j, 3.9974e+11+4.6927e+06j,
        5.9347e+11-1.0940e+06j, 2.0105e+15-5.7356e+08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (110479124987904-32923808j)
SINR torch.Size([20]) = tensor([-12.1773,  -9.4568, -22.5083, -17.2319,  -9.5575, -10.0443, -11.3276,
        -16.4121, -14.3434,  -9.8120, -15.7382, -18.8674, -17.7418, -10.9653,
         -8.4514, -12.3438,  -7.4218, -12.1560, -14.4886,  -6.2144],
       device='cuda:0')
SINR mean = -12.863003730773926
E[H^H] = 1e-07
E_MSE (Error Power) = 31.7259578704834
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0571, 0.1018, 0.0056, 0.0186, 0.0997, 0.0901, 0.0686, 0.0223, 0.0355,
        0.0945, 0.0260, 0.0128, 0.0165, 0.0741, 0.1250, 0.0551, 0.1533, 0.0574,
        0.0344, 0.1930], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([748, 671, 984, 874, 674, 688, 725, 855, 805, 682, 839, 910, 885, 715,
        641, 753, 608, 748, 808, 569], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 3-----------
Real SNR = tensor([3.3798, 2.4543, 2.9612, 4.1409, 3.7624, 2.9585, 3.1442, 3.6166, 3.5688,
        3.8225, 2.6729, 2.7033, 3.9559, 4.5791, 3.7176, 2.8370, 3.1867, 3.4612,
        3.3026, 3.7030], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([7.8127e+13+2.4519e+07j, 2.6541e+12+9.9636e+06j, 6.8979e+12-3.6354e+07j,
        1.3450e+13-8.8942e+07j, 1.5605e+12+3.8876e+06j, 1.9104e+12+5.2192e+07j,
        3.3482e+11-1.7769e+06j, 1.5326e+12+5.2906e+06j, 8.8151e+11-5.0405e+06j,
        1.1223e+12-2.3238e+06j, 7.8589e+11+1.1010e+07j, 1.4905e+12+1.4412e+07j,
        1.9269e+13+1.1766e+06j, 2.8935e+14-2.1583e+08j, 6.9559e+12+3.4778e+07j,
        2.6013e+14+3.3966e+08j, 2.2739e+12+5.8998e+06j, 9.6620e+11+2.5188e+06j,
        5.7840e+12+4.1111e+06j, 3.3497e+13+5.8664e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (36449021853696+8250869j)
SINR torch.Size([20]) = tensor([ -8.7489,  -9.7087,  -8.7092, -12.9472, -21.3951, -20.8415, -18.2152,
        -13.2749, -10.7680, -17.5132, -15.5606, -15.5720, -10.4310,  -5.4363,
         -9.9498,  -6.9697,  -9.0141, -11.3179,  -9.0351,  -8.6951],
       device='cuda:0')
SINR mean = -12.205177307128906
E[H^H] = 1e-07
E_MSE (Error Power) = 29.86333656311035
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1177, 0.0966, 0.1186, 0.0483, 0.0072, 0.0082, 0.0149, 0.0449, 0.0773,
        0.0174, 0.0270, 0.0270, 0.0830, 0.2224, 0.0919, 0.1673, 0.1115, 0.0688,
        0.1110, 0.1190], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([650, 679, 649, 769, 962, 951, 896, 778, 709, 880, 835, 835, 700, 543,
        686, 594, 658, 725, 658, 648], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 4-----------
Real SNR = tensor([4.3078, 4.1871, 4.7376, 4.5483, 4.4933, 4.8329, 3.2010, 4.0553, 4.3034,
        4.8366, 4.7598, 4.0550, 6.2968, 4.7331, 4.7438, 5.3949, 4.1491, 4.5266,
        5.5851, 3.8886], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, inf+nanj, nan+nanj, inf+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, inf+nanj, nan+nanj, inf+nanj, nan+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.4072e+13+1.2955e+07j, 1.4272e+13-2.8221e+07j, 1.3329e+14-5.8896e+07j,
        8.8894e+13-6.3229e+07j, 2.8970e+14-1.3935e+08j, 9.1863e+13+1.6693e+08j,
        6.0521e+10+5.6408e+05j, 1.6184e+12-8.8500e+05j, 9.5096e+12+6.6362e+06j,
        5.2515e+11+6.2476e+05j, 1.0447e+12+1.5982e+07j, 2.4504e+12+7.1680e+06j,
        2.4957e+12+8.6707e+06j, 1.5282e+13+7.2197e+07j, 1.0720e+14-3.4342e+08j,
        2.0748e+12-1.5729e+07j, 3.7737e+11+1.8650e+06j, 1.6365e+11+2.4192e+06j,
        2.0913e+12+3.8474e+07j, 1.6322e+13+7.9678e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (40165376524288-15363776j)
SINR torch.Size([20]) = tensor([ -8.1530, -10.7156,  -4.4784,  -7.1564,  -4.9619,  -6.4220, -17.0878,
        -12.2236,  -8.4798, -13.5162, -14.9263, -15.2285,  -8.1797,  -9.9181,
         -9.4654, -14.1776, -15.1752, -14.7522, -18.2358,  -5.8913],
       device='cuda:0')
SINR mean = -10.957236289978027
E[H^H] = 1e-07
E_MSE (Error Power) = 19.011520385742188
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1327, 0.0782, 0.2629, 0.1614, 0.2419, 0.1856, 0.0192, 0.0565, 0.1243,
        0.0426, 0.0312, 0.0291, 0.1320, 0.0925, 0.1016, 0.0368, 0.0295, 0.0324,
        0.0148, 0.2048], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([631, 708, 511, 600, 527, 576, 871, 750, 641, 784, 819, 827, 632, 685,
        671, 801, 825, 815, 896, 558], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 5-----------
Real SNR = tensor([5.2393, 5.5321, 5.1842, 4.4047, 4.9944, 4.4187, 5.6135, 5.5948, 4.3192,
        5.1728, 5.1663, 5.6583, 4.5569, 6.0948, 5.2212, 4.2877, 5.4785, 6.0564,
        5.5605, 3.9027], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, nan+nanj, nan+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.4690e+12+1.5106e+07j, 3.5101e+13-4.0305e+06j, 2.0394e+13-1.4708e+07j,
        2.0973e+11+1.9733e+06j, 1.1366e+13+3.4953e+07j, 6.2858e+11-9.1489e+06j,
        3.9275e+13+4.6319e+07j, 1.4037e+11-1.7736e+06j, 4.7829e+11+4.8935e+03j,
        3.4018e+12-3.4213e+06j, 1.0146e+12-5.6904e+06j, 3.2354e+13+7.1976e+06j,
        5.9299e+11+4.8670e+04j, 4.0491e+12+2.3071e+07j, 3.5998e+12-2.2791e+07j,
        6.6624e+12-4.1523e+06j, 2.3395e+12-7.7619e+06j, 8.8986e+12-6.2390e+07j,
        5.6098e+10-8.4520e+05j, 1.4817e+12+1.1228e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8725655453696-396400.90625j)
SINR torch.Size([20]) = tensor([-11.0084,  -7.6052,  -7.7169, -17.7037,  -7.7966, -10.7850,  -7.4801,
        -14.8550,  -9.8124,  -9.1495,  -9.8460,  -5.8859,  -8.3944, -13.2908,
        -14.8445,  -7.4872, -10.9334,  -8.6446, -19.6464,  -9.2250],
       device='cuda:0')
SINR mean = -10.605563163757324
E[H^H] = 1e-07
E_MSE (Error Power) = 17.6653995513916
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0735, 0.1479, 0.1447, 0.0167, 0.1424, 0.0770, 0.1516, 0.0317, 0.0945,
        0.1084, 0.0939, 0.2050, 0.1264, 0.0448, 0.0317, 0.1514, 0.0746, 0.1202,
        0.0107, 0.1068], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([716, 614, 618, 884, 620, 710, 610, 818, 682, 662, 683, 558, 639, 778,
        817, 610, 714, 647, 927, 664], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 6-----------
Real SNR = tensor([6.1442, 5.7554, 6.5024, 5.8685, 6.0228, 6.1502, 6.1024, 5.9158, 5.4009,
        7.3742, 6.6105, 6.0598, 6.5767, 6.6784, 7.5156, 7.8149, 7.1344, 6.8722,
        5.9340, 6.0738], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([5.1051e+13+1.0420e+08j, 1.3707e+11+2.3414e+05j, 1.3454e+13-1.8861e+07j,
        4.8916e+11-5.4641e+06j, 6.8951e+11-1.5552e+07j, 2.3586e+12+2.5766e+06j,
        5.2069e+10-1.9018e+06j, 7.4566e+12+3.9153e+06j, 1.2882e+11+8.0292e+05j,
        7.3350e+11-7.2223e+06j, 6.1805e+12+2.3777e+07j, 3.4212e+12+1.1308e+07j,
        1.5864e+12-1.5871e+06j, 4.7130e+11-1.4597e+05j, 2.5765e+12+9.3125e+06j,
        3.0938e+13+3.7529e+07j, 2.6533e+13+6.1591e+07j, 2.8386e+13+1.0663e+08j,
        1.0728e+14-3.2727e+07j, 1.9492e+14+1.2687e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (23941896732672+14554903j)
SINR torch.Size([20]) = tensor([ -4.7453, -10.3108,  -5.0407, -15.4660, -11.3020,  -9.6518, -22.6940,
         -7.3634, -19.1176, -10.8551,  -7.4595,  -7.4309,  -7.2916,  -9.6801,
        -11.4165,  -6.0094,  -6.1526,  -7.2051,  -3.3252,  -3.3311],
       device='cuda:0')
SINR mean = -9.292437553405762
E[H^H] = 1e-07
E_MSE (Error Power) = 20.862825393676758
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2511, 0.0852, 0.2385, 0.0276, 0.0690, 0.0978, 0.0053, 0.1551, 0.0121,
        0.0759, 0.1522, 0.1530, 0.1572, 0.0972, 0.0673, 0.2004, 0.1952, 0.1599,
        0.3174, 0.3171], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([520, 696, 530, 832, 724, 677, 988, 606, 915, 712, 610, 609, 604, 678,
        728, 562, 567, 601, 471, 471], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 7-----------
Real SNR = tensor([8.0263, 7.4231, 7.5041, 7.6034, 6.2444, 6.5129, 7.4401, 7.7841, 6.9433,
        8.0820, 6.9959, 7.4545, 7.2282, 7.4691, 6.3207, 8.2893, 7.2172, 7.6592,
        7.8211, 6.3224], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([       inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj, 1.1515e+38-1.4249e+34j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([6.0727e+12-2.2174e+08j, 2.4220e+13-1.7341e+07j, 1.2044e+13+2.2560e+07j,
        2.5119e+12-5.4864e+07j, 7.7519e+09+5.6055e+04j, 6.8147e+13-1.2951e+07j,
        2.9679e+12-2.3104e+06j, 1.0523e+13+1.1770e+07j, 5.0858e+12+1.8415e+08j,
        2.3532e+12+1.5795e+07j, 7.3667e+11+1.3542e+06j, 2.8920e+12+9.2556e+06j,
        1.1675e+14+1.9177e+08j, 1.3270e+11+7.9377e+06j, 2.8294e+13+9.8830e+06j,
        2.3922e+12-1.8668e+06j, 1.2378e+12-4.9010e+06j, 1.4987e+13-6.3193e+06j,
        4.0339e+12-1.4661e+08j, 9.0780e+09+7.3494e+04j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (15269860737024-715294.4375j)
SINR torch.Size([20]) = tensor([-12.8136,  -3.0094,  -3.9999, -14.7002, -11.9311,  -2.0598,  -3.6525,
         -3.3532, -12.5142,  -8.2499,  -7.3730,  -7.4615,  -3.0813, -17.3302,
         -3.6067,  -6.4688,  -7.2931,  -5.0233, -14.6396, -14.9288],
       device='cuda:0')
SINR mean = -8.174501419067383
E[H^H] = 1e-07
E_MSE (Error Power) = 12.093560218811035
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0497, 0.3334, 0.2848, 0.0328, 0.0602, 0.3836, 0.3013, 0.3160, 0.0531,
        0.1302, 0.1548, 0.1521, 0.3297, 0.0182, 0.3035, 0.1840, 0.1572, 0.2393,
        0.0332, 0.0311], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([765, 460, 494, 814, 742, 426, 482, 472, 757, 634, 607, 610, 462, 876,
        481, 578, 604, 529, 812, 819], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 8-----------
Real SNR = tensor([8.2334, 9.9009, 8.3260, 9.2861, 7.3664, 8.4539, 9.3054, 7.8715, 7.8972,
        7.7035, 8.2678, 7.9229, 8.8523, 9.4091, 9.3654, 7.8174, 8.8852, 9.0725,
        8.7456, 8.2566], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([6.9624e+37+3.7739e+32j,        inf+nanj, 3.1450e+37-7.3730e+31j,
               inf+nanj, 1.1122e+37-1.3279e+32j, 2.8419e+38-4.2220e+33j,
        3.2404e+37+7.6592e+32j, 2.1413e+38-2.4996e+31j, 2.0220e+38+1.3285e+33j,
               inf+nanj, 2.3428e+38+1.4471e+32j, 9.7207e+37+4.6145e+32j,
        3.0351e+38-6.7743e+32j,        inf+nanj, 4.6744e+36-1.1543e+32j,
        3.1163e+37-7.3767e+32j, 9.0714e+37+5.4053e+31j,        inf+nanj,
        4.1628e+37-3.5041e+32j,        inf+nanj], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([1.5778e+13+3.2817e+07j, 4.1878e+13-4.9462e+07j, 1.3703e+12+6.1173e+05j,
        1.8647e+12-2.7551e+06j, 2.3789e+12+2.4114e+05j, 1.2010e+12+2.4680e+06j,
        6.1741e+12+1.1167e+07j, 7.4213e+11+2.8709e+07j, 2.0523e+12+2.6437e+06j,
        4.9086e+12-7.9018e+06j, 2.3897e+09-2.5237e+07j, 1.7196e+12+2.7730e+06j,
        1.6918e+13-1.3979e+08j, 6.7258e+12-4.1303e+06j, 2.3042e+12-9.0608e+06j,
        2.5687e+13+1.3280e+07j, 1.5136e+12-8.9761e+05j, 7.5523e+12+3.4035e+07j,
        8.6568e+12-5.9798e+05j, 8.2675e+13+4.5750e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (11605130608640-3266879.75j)
SINR torch.Size([20]) = tensor([ -2.7555,  -3.5544,  -4.9088, -11.2672,  -5.4383,  -6.6156,  -5.0177,
        -14.5745,  -4.0925,  -4.8788, -39.4606,  -6.0221,  -5.1783,  -7.1038,
        -10.6824,  -1.9114,  -7.5543,  -6.3517,  -6.6039,  -3.3984],
       device='cuda:0')
SINR mean = -7.868508338928223
E[H^H] = 1e-07
E_MSE (Error Power) = 446.947998046875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([3.4650e-01, 3.0610e-01, 2.4411e-01, 6.9502e-02, 2.2232e-01, 1.7898e-01,
        2.3951e-01, 3.3702e-02, 2.8043e-01, 2.4538e-01, 1.1321e-04, 1.9995e-01,
        2.3284e-01, 1.6305e-01, 7.8731e-02, 3.9171e-01, 1.4938e-01, 1.8808e-01,
        1.7937e-01, 3.1378e-01], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 451,  479,  525,  723,  543,  582,  529,  811,  497,  524, 1000,  563,
         535,  598,  707,  421,  613,  574,  582,  473], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)
--------SNR = 9-----------
Real SNR = tensor([ 8.2687,  9.4655,  8.1749,  8.6012,  8.5551,  9.3399, 10.7840,  8.4372,
         9.3737,  9.0893,  9.7312,  8.8585,  9.3671,  9.4181,  9.7666,  9.1436,
         9.6462, 10.0182,  8.6739,  9.8209], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.5799e+36-1.0209e+31j, 1.3005e+37-9.1926e+30j, 8.3877e+34+3.1180e+30j,
        5.6531e+36+3.7574e+31j, 3.8510e+36+7.6621e+31j, 2.1430e+38-4.0407e+32j,
        1.4532e+36+2.5595e+31j, 5.5397e+35-1.9713e+30j, 5.0843e+36+6.6531e+30j,
        2.9132e+37+1.6593e+32j,        inf+nanj, 3.9031e+36-3.7524e+31j,
        1.4526e+37+8.0080e+31j, 4.7161e+37-2.8057e+31j, 4.5720e+36-5.9198e+31j,
        2.9987e+35-1.0783e+30j, 1.3358e+37-6.9422e+31j, 6.7865e+36-3.6138e+30j,
        2.9172e+35-2.1153e+31j, 2.3770e+36+1.1884e+31j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([5.4620e+10-6.5091e+05j, 3.0228e+12+1.2939e+06j, 4.0090e+11+1.6067e+05j,
        6.4300e+11+3.7835e+05j, 1.8661e+13-4.1943e+06j, 1.4410e+12-2.8882e+06j,
        1.1763e+14+6.1459e+08j, 1.0761e+13-1.9204e+07j, 2.5860e+12+8.2402e+06j,
        6.7969e+11-7.7761e+05j, 5.4273e+12-1.9200e+07j, 2.7673e+13+4.6249e+07j,
        1.2321e+13+1.0547e+07j, 7.5215e+11-5.1453e+06j, 5.3113e+11+2.7749e+07j,
        4.8072e+11-8.7285e+05j, 3.4779e+12-6.3962e+06j, 1.9917e+12+3.5402e+07j,
        2.7861e+12+9.7175e+06j, 1.4755e+12+2.7081e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10639899623424+36104104j)
SINR torch.Size([20]) = tensor([ -9.4441,  -4.4727,  -8.4185,  -3.5464,  -2.9386,  -3.4807,  -5.9185,
         -1.8602, -11.8844,  -8.5809,  -4.6857,  -1.9919,  -1.0545,  -6.5895,
        -13.2180,  -7.0287,  -4.3599, -11.1235,  -7.2830,  -6.4819],
       device='cuda:0')
SINR mean = -6.218076229095459
E[H^H] = 1e-07
E_MSE (Error Power) = 5.746514320373535
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1021, 0.2631, 0.1258, 0.3065, 0.3370, 0.3097, 0.2038, 0.3945, 0.0609,
        0.1218, 0.2537, 0.3873, 0.4396, 0.1799, 0.0455, 0.1654, 0.2682, 0.0717,
        0.1575, 0.1835], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([671, 511, 640, 479, 457, 476, 559, 419, 740, 645, 518, 424, 391, 582,
        776, 596, 507, 719, 604, 578], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 20)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 20)

--- 処理中: 画像 41 から 60 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 40)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6306, 0.6925, 0.4886, 0.7032, 0.5710, 0.5101, 0.6843, 0.5062, 0.6585,
        1.1102, 0.7262, 0.7535, 0.6937, 0.3628, 1.0899, 0.4007, 0.6435, 0.4448,
        0.6772, 0.7563], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-5.1667, -5.2102, -3.5997, -4.4859, -5.6971, -4.7522, -3.2394, -5.8282,
        -3.4587, -5.2253, -4.6800, -5.0918, -4.4157, -4.1009, -4.3310, -4.7666,
        -4.7807, -4.0565, -3.2542, -2.3503], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.6381e+13+2.3765e+07j, 1.7499e+13+4.5259e+06j, 8.6573e+11+6.2515e+06j,
        1.8853e+12-6.9517e+06j, 5.2127e+13+8.6598e+07j, 5.6797e+11-3.7473e+05j,
        3.0714e+10-1.5971e+07j, 1.1917e+11+1.4733e+06j, 1.3425e+14+2.7650e+08j,
        7.4326e+11+7.8516e+06j, 4.6624e+13-7.1986e+07j, 5.3749e+13-8.6748e+07j,
        1.3030e+12+9.3194e+05j, 1.3977e+13+2.0266e+07j, 5.7939e+13+2.8484e+07j,
        9.3207e+12-7.4332e+06j, 8.9888e+11-3.0351e+06j, 3.5582e+13-5.1380e+07j,
        2.1446e+12-6.3468e+07j, 6.5323e+12+2.4516e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (23126943465472+7587633.5j)
SINR torch.Size([20]) = tensor([-14.7790, -15.5903, -21.0190, -20.2302, -15.4603, -21.3197, -39.6644,
        -24.9901, -20.4100, -22.1497, -17.2256, -15.4212, -23.3196, -17.2617,
        -16.3380, -15.1506, -20.8433, -15.4961, -23.7229, -19.1159],
       device='cuda:0')
SINR mean = -19.975374221801758
E[H^H] = 1e-07
E_MSE (Error Power) = 561.1802368164062
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0322, 0.0269, 0.0078, 0.0094, 0.0277, 0.0073, 0.0001, 0.0032, 0.0090,
        0.0061, 0.0186, 0.0279, 0.0046, 0.0184, 0.0227, 0.0296, 0.0082, 0.0274,
        0.0042, 0.0121], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 816,  835,  955,  939,  832,  961, 1000, 1000,  942,  977,  874,  831,
        1000,  874,  853,  825,  951,  833, 1000,  915], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -4-----------
Real SNR = tensor([-3.5823, -4.5090, -2.7424, -4.0625, -3.6426, -3.2998, -2.9871, -3.3734,
        -3.9234, -4.0193, -3.6243, -3.7872, -2.7922, -3.4322, -5.1716, -4.2157,
        -2.8533, -3.9480, -3.8062, -2.7201], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.3613e+13-6.3145e+07j, 3.1611e+12-3.4051e+06j, 2.1176e+12+2.2453e+06j,
        8.1875e+12+2.8918e+06j, 3.0250e+13+1.2640e+08j, 3.1211e+12-8.5436e+06j,
        1.2821e+13-6.8295e+06j, 4.0979e+12-2.4282e+06j, 1.5714e+13+2.7624e+06j,
        4.9299e+13+0.0000e+00j, 3.1229e+12-1.9906e+07j, 1.2008e+13-1.3403e+08j,
        1.7738e+13-1.2101e+08j, 8.8969e+12-5.8817e+07j, 1.8774e+12+3.4553e+06j,
        2.4125e+12-1.3547e+07j, 2.2012e+13-3.0682e+07j, 6.0845e+12+6.2144e+06j,
        2.2431e+11-2.8072e+05j, 3.5389e+12+1.9661e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (12014801911808-15834490j)
SINR torch.Size([20]) = tensor([-14.7427, -15.0129, -16.0892, -14.6152, -15.8255, -17.5276, -14.6768,
        -14.6410, -16.8057, -15.1991, -21.6242, -21.7377, -16.9185, -17.2902,
        -21.0661, -19.8867, -16.2679, -15.3172, -23.1199, -16.7481],
       device='cuda:0')
SINR mean = -17.255615234375
E[H^H] = 1e-07
E_MSE (Error Power) = 65.85320281982422
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0325, 0.0306, 0.0240, 0.0334, 0.0255, 0.0174, 0.0329, 0.0332, 0.0204,
        0.0293, 0.0068, 0.0067, 0.0199, 0.0183, 0.0078, 0.0102, 0.0231, 0.0286,
        0.0049, 0.0207], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([815, 821, 847, 812, 841, 880, 813, 812, 864, 826, 967, 969, 867, 875,
        956, 932, 852, 829, 996, 863], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -3-----------
Real SNR = tensor([-2.0274, -3.9939, -2.0318, -3.8962, -3.6531, -1.9543, -2.2760, -2.6979,
        -2.3952, -2.8615, -3.8042, -2.5525, -2.9832, -2.2775, -2.1628, -3.4062,
        -1.5066, -2.9028, -2.2017, -1.8253], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.9062e+11+253391.0156j, 1.1744e+11-132254.7188j,
        5.9360e+11+8575147.0000j, 6.7570e+10+439581.3125j,
        1.5118e+12-4407272.0000j, 1.5777e+13-42893512.0000j,
        2.9572e+11+8655473.0000j, 1.1161e+14-72898016.0000j,
        5.4440e+13+14151812.0000j, 2.5792e+13+30337062.0000j,
        3.0554e+11-299568.4688j, 6.9844e+12+5458438.5000j,
        4.7410e+13+25863598.0000j, 1.0927e+13-9028603.0000j,
        3.7310e+10+3651262.7500j, 2.2262e+11-79671.0234j,
        4.0883e+12+20167200.0000j, 3.2405e+12+1953857.6250j,
        1.7380e+12+8313660.5000j, 6.9609e+12+27725364.0000j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (14615426629632+1290347.625j)
SINR torch.Size([20]) = tensor([-21.5861, -17.9971, -25.3547, -24.9252, -15.9198, -15.2448, -31.7370,
        -14.7047, -12.6639, -14.5452, -20.9931, -22.4727, -12.4696, -15.9884,
        -31.0079, -19.8976, -17.8422, -18.5353, -18.1915, -16.2243],
       device='cuda:0')
SINR mean = -19.415042877197266
E[H^H] = 1e-07
E_MSE (Error Power) = 223.2885284423828
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0069, 0.0156, 0.0029, 0.0032, 0.0249, 0.0290, 0.0007, 0.0327, 0.0514,
        0.0339, 0.0079, 0.0056, 0.0536, 0.0246, 0.0008, 0.0101, 0.0162, 0.0138,
        0.0149, 0.0233], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 966,  891, 1000, 1000,  843,  827, 1000,  814,  761,  810,  954,  984,
         756,  845, 1000,  932,  888,  903,  895,  851], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -2-----------
Real SNR = tensor([-1.9646, -2.0867, -1.4648, -3.2822, -2.6511, -0.6005, -1.3615, -1.7854,
        -1.3786, -2.4143, -1.8606, -1.8250, -1.5317, -1.3275, -2.9041, -1.7172,
        -1.9191, -1.6326, -1.7830, -0.5829], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.4557e+12+7371340.0000j, 2.4822e+12+592474.1250j,
        5.3982e+12-87984848.0000j, 2.6357e+13+16963770.0000j,
        1.2252e+12+3023041.0000j, 1.2366e+13-27750316.0000j,
        4.7589e+12-2281343.2500j, 9.9816e+12-2909474.2500j,
        3.4667e+12-34756468.0000j, 5.6104e+12-9407349.0000j,
        6.0202e+11-1301700.0000j, 2.3213e+10+4164010.5000j,
        2.0450e+13+2490822.7500j, 5.8969e+12-25664838.0000j,
        1.2766e+13+12851751.0000j, 6.0369e+11+8396491.0000j,
        3.7613e+13-35006220.0000j, 2.1901e+12+7050445.5000j,
        5.2689e+11-3635936.2500j, 1.1272e+13+11180902.0000j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8352308920320-7830672j)
SINR torch.Size([20]) = tensor([-19.5429, -17.3979, -18.3466, -12.6055, -16.3096, -17.6804, -17.4182,
        -13.5956, -18.1327, -17.3695, -22.0253, -33.3194, -13.4689, -15.6619,
        -16.4486, -25.6208, -12.4367, -17.9848, -28.8049, -13.4962],
       device='cuda:0')
SINR mean = -18.38330841064453
E[H^H] = 1e-07
E_MSE (Error Power) = 208.625244140625
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0110, 0.0179, 0.0144, 0.0520, 0.0229, 0.0168, 0.0178, 0.0419, 0.0151,
        0.0180, 0.0062, 0.0005, 0.0431, 0.0264, 0.0222, 0.0027, 0.0540, 0.0157,
        0.0013, 0.0428], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 924,  878,  899,  760,  853,  884,  878,  786,  894,  877,  975, 1000,
         783,  837,  856, 1000,  755,  891, 1000,  783], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = -1-----------
Real SNR = tensor([-1.0306, -1.1408, -0.1760, -1.1265, -0.1534,  0.3839, -0.7633, -1.2327,
        -1.5279, -0.8827, -0.3766,  0.8842, -0.6861,  1.4876, -0.9586,  0.0594,
        -0.3157, -0.1104, -1.2179,  2.1663], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.2010e+13+9.2365e+05j, 3.0930e+13-2.4523e+07j, 4.9186e+11+4.5684e+06j,
        5.2415e+12-8.8866e+06j, 6.1625e+12-7.9462e+07j, 5.2682e+12-1.4853e+07j,
        4.1973e+12+7.2290e+06j, 4.2589e+12-1.6461e+07j, 1.5379e+11+1.0842e+06j,
        3.6520e+11+2.3481e+06j, 4.0449e+14-1.3039e+08j, 4.0846e+14+3.8644e+08j,
        2.8490e+13-5.8826e+07j, 1.6369e+13-1.1228e+08j, 4.1997e+12+1.2372e+07j,
        7.6849e+12-2.1372e+08j, 5.7940e+13-1.7631e+07j, 2.4671e+12+4.5485e+07j,
        5.6590e+11+3.4128e+05j, 1.0675e+14+5.4661e+08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (55324673310720+16517843j)
SINR torch.Size([20]) = tensor([-11.4657, -12.1356, -16.7352, -15.7875, -21.5356, -15.3748, -14.6155,
        -16.3147, -16.1630, -20.3192,  -9.1882, -10.1724, -11.3007, -15.9333,
        -14.3664, -20.3170, -11.5840, -19.8604, -13.1333, -15.6364],
       device='cuda:0')
SINR mean = -15.096940994262695
E[H^H] = 1e-07
E_MSE (Error Power) = 44.38905715942383
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0666, 0.0576, 0.0208, 0.0257, 0.0070, 0.0282, 0.0334, 0.0228, 0.0236,
        0.0092, 0.1076, 0.0877, 0.0690, 0.0249, 0.0353, 0.0092, 0.0649, 0.0102,
        0.0464, 0.0266], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([729, 747, 862, 840, 965, 830, 812, 853, 849, 941, 663, 692, 724, 844,
        805, 941, 732, 931, 774, 837], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 0-----------
Real SNR = tensor([-0.0999,  0.2560,  0.8137,  0.6112,  0.7836,  0.6397, -0.6297,  0.5699,
         0.3982,  0.6938, -0.4970,  0.4060,  0.2193,  1.2805, -0.0887,  0.2521,
         1.4478,  0.4332, -0.2696,  2.1800], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([9.5277e+12-2.1641e+07j, 1.1644e+13-1.4736e+07j, 2.2689e+10+1.1366e+05j,
        1.5813e+12-1.9955e+07j, 6.8736e+12-1.2722e+07j, 1.6878e+12+1.0821e+07j,
        5.8130e+12-4.4731e+06j, 4.0097e+14+1.7156e+07j, 3.5474e+13+2.9870e+07j,
        1.7004e+12+3.9300e+05j, 4.1134e+13+1.3492e+08j, 4.5416e+13+2.5406e+08j,
        9.5336e+11+2.1917e+07j, 1.8907e+12+8.1479e+06j, 6.9285e+12-2.5376e+07j,
        2.7039e+11+6.0298e+07j, 1.9455e+13-4.3508e+07j, 1.0197e+13-7.5230e+07j,
        5.0356e+13-1.6347e+08j, 1.6960e+12+1.0609e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (32679701512192+8359478.5j)
SINR torch.Size([20]) = tensor([-13.1756, -12.6940, -28.4405, -17.4897, -12.1586, -14.7999, -12.1323,
         -9.6066,  -9.7455, -16.4318, -12.7699, -13.0970, -19.1815, -14.3954,
        -12.0517, -33.6581, -12.0834, -14.6836, -11.5255, -16.2849],
       device='cuda:0')
SINR mean = -15.320279121398926
E[H^H] = 1e-07
E_MSE (Error Power) = 175.40127563476562
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0459, 0.0510, 0.0014, 0.0175, 0.0573, 0.0321, 0.0577, 0.0987, 0.0959,
        0.0222, 0.0502, 0.0467, 0.0119, 0.0351, 0.0587, 0.0004, 0.0583, 0.0329,
        0.0658, 0.0230], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 775,  762, 1000,  880,  748,  816,  747,  676,  680,  855,  764,  773,
         917,  806,  745, 1000,  746,  813,  731,  852], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 1-----------
Real SNR = tensor([0.8134, 1.2380, 2.3934, 1.2890, 0.4212, 2.3038, 1.9487, 1.3972, 1.8147,
        2.0643, 0.9976, 1.6819, 0.7986, 3.4052, 0.9048, 0.6570, 0.2438, 0.6352,
        1.7698, 2.8521], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.6453e+11-1.1229e+07j, 1.4815e+11+8.8735e+05j, 1.2886e+12+1.3763e+06j,
        2.9857e+13-1.2142e+08j, 9.6052e+12-2.2663e+07j, 1.5614e+13-1.8915e+07j,
        7.8032e+12-1.2968e+07j, 3.0313e+13+1.5205e+07j, 1.2524e+13-1.5005e+07j,
        3.2894e+13-3.9735e+07j, 4.1678e+13-2.5123e+08j, 7.8946e+11-6.1955e+06j,
        8.9390e+13-1.9124e+08j, 1.6216e+14-3.7155e+08j, 4.6121e+12-4.7390e+06j,
        9.9668e+12-1.6041e+08j, 1.5109e+12-5.2387e+04j, 1.4462e+12-7.2353e+05j,
        3.1111e+13-3.9240e+07j, 3.7048e+13+3.7885e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (26001402757120-60598028j)
SINR torch.Size([20]) = tensor([-24.4140, -17.1422, -13.3099, -12.5399,  -9.9321, -12.6676, -13.2431,
        -10.4322, -15.3117, -11.1580, -12.0315, -13.3967,  -8.9874,  -8.9165,
        -15.9114, -14.8444, -12.5701, -14.5176,  -8.6326,  -9.3091],
       device='cuda:0')
SINR mean = -12.963400840759277
E[H^H] = 1e-07
E_MSE (Error Power) = 33.01621627807617
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0036, 0.0189, 0.0446, 0.0528, 0.0922, 0.0513, 0.0452, 0.0830, 0.0286,
        0.0711, 0.0589, 0.0437, 0.1121, 0.1137, 0.0250, 0.0317, 0.0524, 0.0341,
        0.1205, 0.1049], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  872,  778,  758,  685,  762,  777,  700,  829,  720,  744,  781,
         657,  655,  843,  817,  759,  809,  646,  667], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 2-----------
Real SNR = tensor([1.8543, 2.7275, 3.0888, 0.9964, 2.0243, 3.4035, 2.1293, 3.1739, 2.3502,
        0.3178, 1.9701, 2.6540, 3.6135, 3.3203, 2.5343, 2.4451, 2.1989, 2.9645,
        1.4179, 2.2737], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.0162e+12+8.9886e+06j, 1.9986e+12-1.5601e+07j, 4.6528e+11+1.9380e+07j,
        1.8608e+11-4.4941e+06j, 1.4615e+12+2.5536e+07j, 1.3589e+12+1.1061e+06j,
        8.9873e+12+8.1839e+07j, 1.2379e+13+2.2963e+07j, 4.5774e+12+1.2019e+07j,
        1.1019e+12-2.2298e+06j, 1.9363e+12+1.6515e+07j, 1.5156e+12-3.8781e+07j,
        9.3218e+12+1.1176e+08j, 4.3976e+13+4.0292e+07j, 5.7410e+09+1.6936e+05j,
        3.3606e+12-8.5359e+06j, 1.8302e+12-3.4877e+06j, 2.7637e+12-4.2780e+07j,
        5.7869e+11-6.4504e+05j, 9.5025e+13+5.6887e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (9692330852352+14044962j)
SINR torch.Size([20]) = tensor([-15.0629, -13.2286, -23.0766, -17.2367, -15.4416, -12.6089, -12.1771,
         -9.6609, -12.3754, -11.9331, -19.0073, -20.5493, -15.1534,  -7.8862,
        -21.5204, -12.2757, -13.9849, -16.3983, -12.0705, -10.6803],
       device='cuda:0')
SINR mean = -14.616406440734863
E[H^H] = 1e-07
E_MSE (Error Power) = 45.42237091064453
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0302, 0.0454, 0.0049, 0.0185, 0.0278, 0.0520, 0.0571, 0.0976, 0.0547,
        0.0602, 0.0124, 0.0087, 0.0296, 0.1399, 0.0070, 0.0559, 0.0384, 0.0224,
        0.0585, 0.0788], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([823, 776, 995, 874, 832, 760, 748, 677, 754, 742, 913, 945, 825, 623,
        965, 751, 796, 855, 746, 707], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 3-----------
Real SNR = tensor([3.4354, 3.4190, 3.9550, 4.4824, 2.6692, 3.6575, 4.6974, 2.8708, 1.9490,
        4.2121, 2.3024, 4.5364, 3.1367, 3.4605, 2.0380, 3.2311, 2.6679, 2.7018,
        2.3660, 3.6981], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.0845e+13-5.0983e+06j, 8.1074e+12-5.4161e+07j, 6.8290e+12+4.4015e+07j,
        1.6806e+12+5.6276e+06j, 6.3137e+12-1.2718e+05j, 2.2889e+12+5.5565e+06j,
        8.4892e+11+3.9678e+07j, 3.2257e+12+8.4018e+06j, 2.0676e+13-1.1310e+08j,
        5.2439e+13+6.5737e+07j, 3.5112e+12-4.9409e+06j, 1.9456e+11+3.1336e+07j,
        2.2350e+12+8.0250e+04j, 5.3344e+12-2.4033e+07j, 2.0564e+11+1.0119e+06j,
        4.1839e+11+3.1130e+05j, 5.9881e+10-1.1958e+06j, 1.5917e+12-3.3732e+06j,
        3.5802e+11-1.7792e+07j, 9.7397e+13+1.9807e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (11228017590272-1004109j)
SINR torch.Size([20]) = tensor([ -8.1745, -13.1460, -14.4731, -12.1816,  -6.6342, -12.6997, -21.3866,
        -12.7299,  -9.8863, -10.7708,  -8.1595, -26.1877,  -9.1051, -15.7556,
        -12.3048, -15.0764, -21.2495, -15.6455, -19.9490,  -7.7360],
       device='cuda:0')
SINR mean = -13.662589073181152
E[H^H] = 1e-07
E_MSE (Error Power) = 53.248878479003906
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1321, 0.0462, 0.0345, 0.0571, 0.1783, 0.0510, 0.0072, 0.0506, 0.0931,
        0.0773, 0.1325, 0.0024, 0.1094, 0.0259, 0.0556, 0.0301, 0.0074, 0.0265,
        0.0100, 0.1441], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 632,  774,  808,  749,  583,  762,  962,  763,  684,  709,  632, 1000,
         661,  839,  752,  823,  960,  837,  933,  618], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 4-----------
Real SNR = tensor([3.6385, 4.1469, 4.9553, 3.8176, 3.8488, 3.9517, 4.7700, 3.6028, 4.2619,
        3.5078, 4.1784, 4.4426, 3.7657, 6.4563, 4.1766, 4.4442, 5.0149, 4.2325,
        6.1929, 4.0474], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, nan+nanj, nan+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.4938e+13+4.7791e+07j, 2.1445e+13-2.4965e+07j, 2.3338e+12-6.2266e+06j,
        3.7717e+12-2.7666e+07j, 1.6293e+13-2.3059e+07j, 1.1522e+11-4.7197e+06j,
        4.3635e+14-2.9424e+08j, 3.9932e+12-9.4699e+06j, 7.7135e+12+1.3853e+07j,
        2.2296e+13-7.0970e+07j, 4.9347e+13+1.9231e+07j, 7.3479e+11-4.8255e+04j,
        4.0589e+10-2.0712e+06j, 1.5195e+13+8.0678e+07j, 2.9307e+12+2.0905e+06j,
        1.0260e+13+3.3769e+06j, 6.1709e+13+1.8033e+08j, 5.3919e+11+1.9381e+06j,
        3.8857e+13+2.0072e+06j, 3.4764e+13+1.9855e+08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (37681258037248+4320325j)
SINR torch.Size([20]) = tensor([ -9.5906,  -8.0975,  -8.6564, -11.8437, -10.4359, -22.4911,  -3.4448,
        -12.0729,  -7.1341, -11.5196, -13.1293, -12.5636, -23.4564, -10.1524,
         -9.1020,  -7.8680, -11.6880, -15.1224,  -6.7197, -12.2398],
       device='cuda:0')
SINR mean = -11.36641788482666
E[H^H] = 1e-07
E_MSE (Error Power) = 30.8963565826416
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0990, 0.1342, 0.1199, 0.0614, 0.0829, 0.0056, 0.3115, 0.0584, 0.1621,
        0.0658, 0.0464, 0.0525, 0.0045, 0.0880, 0.1095, 0.1404, 0.0635, 0.0298,
        0.1755, 0.0563], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 675,  630,  647,  739,  700,  984,  475,  746,  599,  730,  774,  759,
        1000,  692,  660,  622,  735,  824,  586,  750], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 5-----------
Real SNR = tensor([3.2090, 5.2883, 5.7313, 4.8855, 3.8020, 6.3463, 5.0474, 6.6463, 5.7458,
        5.2391, 6.5268, 4.5989, 4.5910, 5.4957, 6.9746, 4.1911, 5.1177, 5.5624,
        5.5283, 6.2377], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, nan+nanj, inf+nanj, nan+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([6.0277e+10+3.3126e+05j, 1.7189e+13+7.8989e+07j, 2.8932e+12-3.7728e+06j,
        8.8535e+12-1.3894e+07j, 2.2840e+11+2.2924e+06j, 6.3823e+11-1.6945e+05j,
        5.6411e+12+8.5396e+06j, 3.2120e+13-9.7329e+07j, 2.8414e+13-7.5658e+07j,
        1.7313e+11-1.3700e+07j, 2.8472e+13+2.8627e+08j, 2.8176e+11-5.1147e+05j,
        1.2028e+12-5.6078e+06j, 1.8804e+12-4.6531e+06j, 4.0365e+14+7.5312e+08j,
        2.9311e+12+3.6382e+06j, 1.3078e+12+8.4424e+06j, 1.1962e+11+2.9371e+06j,
        1.2599e+12+1.1123e+07j, 5.1437e+11+2.3490e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (26891509563392+47136928j)
SINR torch.Size([20]) = tensor([-11.8227,  -9.2958,  -8.8614,  -5.7364, -12.8400, -13.2192,  -8.2856,
        -11.3320,  -7.2442, -20.8298, -12.3544, -11.4473,  -8.4658,  -7.6361,
         -4.5043,  -7.9583,  -9.3903, -21.1801, -13.7632, -12.8266],
       device='cuda:0')
SINR mean = -10.949674606323242
E[H^H] = 1e-07
E_MSE (Error Power) = 22.89105796813965
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0617, 0.1052, 0.1150, 0.2107, 0.0494, 0.0455, 0.1292, 0.0685, 0.1587,
        0.0082, 0.0550, 0.0669, 0.1246, 0.1470, 0.2617, 0.1379, 0.1032, 0.0076,
        0.0403, 0.0496], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([739, 666, 653, 553, 766, 776, 635, 725, 603, 951, 753, 728, 641, 615,
        512, 625, 669, 958, 790, 766], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 6-----------
Real SNR = tensor([6.2095, 6.0334, 6.7666, 5.3481, 6.1225, 7.1801, 6.2730, 6.7595, 5.7246,
        6.8949, 6.1636, 5.7826, 5.9486, 7.1765, 7.1993, 6.9830, 7.1829, 6.0767,
        6.3231, 7.4717], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.5281e+12-5.2493e+05j, 2.7872e+12-2.0717e+07j, 6.1064e+10+1.4626e+06j,
        3.2786e+13-3.2201e+07j, 1.2529e+12-4.0800e+06j, 3.2322e+13-8.4945e+06j,
        1.5607e+09+5.5417e+06j, 1.0594e+14-4.7740e+08j, 1.5424e+11-2.2024e+06j,
        6.7102e+13-2.7731e+08j, 1.4664e+13-1.3495e+07j, 1.6319e+13+2.1440e+07j,
        1.9033e+11-2.9139e+06j, 1.4304e+12+3.6509e+06j, 1.0389e+11-1.8743e+04j,
        4.4453e+12-7.8905e+06j, 6.4966e+13+4.5047e+07j, 4.4627e+14+6.8845e+08j,
        1.2507e+14-1.4648e+07j, 9.3119e+12-9.2411e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (46335453560832-5277261j)
SINR torch.Size([20]) = tensor([ -7.2766, -12.1433, -18.7695,  -4.8422, -10.7627,  -5.1634, -35.4039,
         -7.4199, -17.3794,  -7.1829,  -5.8389,  -6.5219, -13.6543, -11.7448,
        -12.4686,  -7.6944,  -4.2710,  -2.1638,  -2.3759,  -6.0186],
       device='cuda:0')
SINR mean = -9.954803466796875
E[H^H] = 1e-07
E_MSE (Error Power) = 186.76292419433594
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([1.5769e-01, 5.7535e-02, 1.3101e-02, 2.4695e-01, 7.7400e-02, 2.3345e-01,
        2.8806e-04, 1.5336e-01, 1.7955e-02, 1.6058e-01, 2.0678e-01, 1.8217e-01,
        4.1327e-02, 6.2718e-02, 5.3605e-02, 1.4533e-01, 2.7221e-01, 3.7795e-01,
        3.6654e-01, 2.0008e-01], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 604,  748,  908,  523,  709,  534, 1000,  608,  877,  601,  557,  579,
         787,  737,  756,  617,  504,  430,  438,  563], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 7-----------
Real SNR = tensor([6.5445, 7.5444, 7.7630, 7.6358, 7.5318, 7.8244, 8.0788, 7.3700, 6.0499,
        5.5804, 6.7704, 7.0257, 7.2189, 7.9442, 6.1676, 6.6091, 7.9181, 6.8952,
        6.4606, 5.0223], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([       inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
               inf+nanj, 6.3327e+37+7.6146e+32j,        inf+nanj,
               inf+nanj,        inf+nanj,        inf+nanj,
        1.6023e+38-3.4702e+34j,        inf+nanj], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([1.6820e+13+34705448.0000j, 2.0178e+13+26536322.0000j,
        2.5894e+11-228572.4844j, 2.8856e+14+32624522.0000j,
        2.8237e+13-21691950.0000j, 8.1333e+11-9936669.0000j,
        2.8617e+12-28552202.0000j, 2.4981e+11-2818919.7500j,
        1.7876e+12-8582183.0000j, 2.6243e+11-1917499.3750j,
        1.5156e+13-25863884.0000j, 3.9114e+12-14320920.0000j,
        2.2669e+13+37286424.0000j, 2.1948e+11+14476141.0000j,
        4.7747e+12+11671329.0000j, 1.6603e+12+3565866.5000j,
        2.9735e+13-15186527.0000j, 1.4785e+12-1532269.3750j,
        3.5911e+09+214286.9219j, 1.2200e+12+5920189.5000j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (22042671841280+1818446.375j)
SINR torch.Size([20]) = tensor([ -7.5424,  -4.0014, -11.8855,  -1.6187,  -3.1217, -12.6096, -11.1759,
        -12.5155,  -6.7588,  -9.8754,  -6.8417,  -9.1572,  -3.9643, -15.7866,
         -5.3550,  -7.0620,  -3.8155,  -7.9737, -22.6790,  -7.4364],
       device='cuda:0')
SINR mean = -8.558819770812988
E[H^H] = 1e-07
E_MSE (Error Power) = 17.610553741455078
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1497, 0.2847, 0.0608, 0.4079, 0.3277, 0.0520, 0.0709, 0.0531, 0.1742,
        0.0933, 0.1715, 0.1083, 0.2864, 0.0257, 0.2256, 0.1644, 0.2935, 0.1375,
        0.0054, 0.1529], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([612, 494, 740, 411, 464, 760, 721, 758, 587, 683, 590, 662, 493, 840,
        541, 597, 488, 626, 988, 609], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 8-----------
Real SNR = tensor([8.3812, 7.0441, 9.1144, 8.5924, 8.2187, 8.4013, 9.7579, 8.5568, 8.8638,
        9.3512, 7.7552, 8.7186, 7.5502, 9.6490, 7.0401, 8.0214, 8.2944, 8.5402,
        7.8455, 8.9131], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([       inf+nanj,        inf+nanj, 1.1590e+38-1.3525e+32j,
               inf+nanj, 3.0103e+38-1.1569e+33j,        inf+nanj,
        1.0753e+38+1.2433e+33j,        inf+nanj, 2.6572e+38+1.5870e+32j,
        1.5369e+37-2.7802e+32j,        inf+nanj, 2.6921e+38-6.4738e+31j,
               inf+nanj, 1.8393e+38+5.4833e+33j, 3.0044e+38+2.4688e+33j,
        1.6068e+37+2.6852e+30j, 1.2003e+37-2.5914e+32j, 5.2561e+37-1.2574e+33j,
               inf+nanj, 4.6961e+37+6.5082e+32j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([5.3023e+13-4.6137e+07j, 4.2476e+13-2.3872e+08j, 1.8847e+12-5.4912e+06j,
        3.1721e+11+1.0568e+06j, 6.3140e+12+1.1974e+07j, 1.2266e+13+4.1695e+07j,
        5.6112e+12-1.6435e+07j, 2.7849e+12-4.2698e+06j, 4.9910e+12-1.3697e+07j,
        1.4971e+11-1.7615e+05j, 6.9281e+11-2.5852e+06j, 1.5074e+12-2.7624e+06j,
        6.3249e+13+5.0217e+06j, 5.2220e+14-2.1178e+08j, 1.1828e+12+2.9991e+06j,
        1.8836e+11+2.6933e+07j, 1.8858e+12+4.9832e+06j, 3.4720e+13-7.1208e+07j,
        9.7493e+11+8.9556e+05j, 2.4375e+12-3.6013e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (37943070687232-27685712j)
SINR torch.Size([20]) = tensor([ -2.8581,  -5.7214,  -5.0501,  -5.7752,  -6.7549,  -3.8149,  -7.3942,
         -7.0232, -11.9770, -12.3198,  -7.3117,  -7.6701,  -4.1538,  -3.3244,
         -4.6333, -17.0021,  -5.6211,  -3.5572,  -5.2406, -11.2872],
       device='cuda:0')
SINR mean = -6.924504280090332
E[H^H] = 1e-07
E_MSE (Error Power) = 7.741701602935791
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3412, 0.2113, 0.2382, 0.2092, 0.1743, 0.2935, 0.1541, 0.1656, 0.0596,
        0.0554, 0.1566, 0.1460, 0.2776, 0.3175, 0.2560, 0.0196, 0.2151, 0.3060,
        0.2303, 0.0692], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([454, 553, 530, 555, 587, 488, 607, 596, 743, 752, 605, 616, 500, 471,
        516, 869, 549, 479, 537, 724], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)
--------SNR = 9-----------
Real SNR = tensor([ 9.7189,  8.0231,  9.5744,  8.5897,  9.4293,  9.5773,  9.7038,  8.6799,
         9.4360,  8.1664,  8.7386,  8.0170,  8.3368,  9.9443,  8.5319,  9.3785,
        10.3412,  8.8867,  9.7659, 10.1918], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.1095e+38-1.4281e+32j, 6.5817e+37-7.0754e+31j, 1.3631e+37-4.3516e+29j,
        1.4864e+36+5.3313e+30j, 2.6917e+37+9.6505e+31j, 5.4520e+37-4.6421e+31j,
        1.8694e+36-1.4410e+31j, 9.2353e+36-2.2068e+31j, 6.0555e+37+1.2689e+30j,
        8.7750e+35-7.2255e+30j, 3.8391e+36+9.2162e+31j, 7.2064e+36-2.4669e+31j,
        1.1896e+37+4.0305e+31j, 1.4242e+36-1.2032e+31j, 3.3220e+36+7.5904e+30j,
        7.6312e+36+1.3867e+31j, 1.9053e+36+2.0684e+31j, 4.6087e+37+8.8043e+31j,
        1.6924e+38+1.5406e+32j, 9.4940e+35-8.4600e+29j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+8.907401102232266e+30j)
torch.linalg.det(H.mH@H) = tensor([1.0400e+13+1.4834e+07j, 1.8259e+13-7.9527e+06j, 2.6162e+13+2.0537e+07j,
        2.7362e+13-1.6905e+07j, 1.1647e+12+1.0147e+06j, 5.5472e+12-8.8170e+06j,
        7.1925e+12+1.1524e+07j, 9.7057e+11-1.0722e+06j, 1.0815e+13+3.8002e+06j,
        1.7655e+10-3.7660e+05j, 1.9679e+13-1.6037e+07j, 7.8983e+11-3.6889e+06j,
        1.0182e+13+3.6327e+07j, 1.4749e+12+9.4280e+06j, 9.1452e+12+2.1068e+06j,
        1.0422e+13+8.6563e+07j, 1.2944e+13+3.6142e+07j, 1.5402e+12-1.0874e+07j,
        3.5544e+10-7.9285e+04j, 2.6327e+11+3.1463e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8718325907456+7839404j)
SINR torch.Size([20]) = tensor([ -4.4393,  -2.0935,  -4.6205,  -0.7749,  -6.3600,  -3.7239,  -2.8460,
         -5.6607,  -1.3920, -17.5956,  -3.4813,  -3.9001,  -4.8230,  -7.2600,
         -3.0969,  -7.3544,  -1.2516,  -6.8704, -21.4655, -13.3452],
       device='cuda:0')
SINR mean = -6.117741107940674
E[H^H] = 1e-07
E_MSE (Error Power) = 13.408706665039062
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2646, 0.3818, 0.2566, 0.4555, 0.1878, 0.2979, 0.3418, 0.2136, 0.4205,
        0.0171, 0.3097, 0.2895, 0.2478, 0.1582, 0.3289, 0.1553, 0.4284, 0.1705,
        0.0071, 0.0442], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([509, 428, 516, 381, 574, 485, 454, 551, 403, 882, 476, 491, 523, 603,
        463, 606, 398, 591, 964, 779], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 40)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 40)

--- 処理中: 画像 61 から 80 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 60)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6583, 0.6378, 0.7080, 0.4698, 0.4843, 0.5120, 0.8771, 0.5660, 0.6880,
        0.6601, 0.6396, 0.6971, 0.6009, 0.7180, 0.5978, 0.4435, 0.5451, 0.5308,
        0.7748, 0.5434], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-4.7747, -5.7318, -4.9262, -4.0367, -5.0234, -5.4611, -4.4227, -4.7561,
        -4.3493, -3.9661, -5.6937, -4.8012, -4.6373, -5.5823, -4.0113, -3.6553,
        -4.1143, -5.0955, -5.0025, -5.0840], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.8248e+13-41354128.0000j, 3.7235e+11+30872042.0000j,
        1.5844e+13+9909984.0000j, 1.4551e+13+46598916.0000j,
        5.0583e+12+21561010.0000j, 1.0940e+12-17368490.0000j,
        4.2483e+11+20400014.0000j, 7.1681e+11-5498495.5000j,
        4.5024e+11+15226160.0000j, 3.5029e+11+813258.8125j,
        6.6142e+12+9011142.0000j, 4.2195e+12-7547148.0000j,
        4.2116e+12+25236632.0000j, 1.1206e+13-26489036.0000j,
        2.5433e+14-24718670.0000j, 9.6034e+12+2235062.0000j,
        3.5842e+12-10337247.0000j, 2.0927e+12-2034737.1250j,
        2.4062e+11+2206669.7500j, 1.0230e+14-88493248.0000j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (23775489818624-1988515.625j)
SINR torch.Size([20]) = tensor([-17.7602, -27.6121, -16.4057, -16.8876, -17.9610, -24.3054, -33.3631,
        -20.7036, -31.5792, -24.1663, -17.7366, -20.7793, -20.0840, -18.8919,
        -13.3863, -16.4493, -22.4247, -17.3879, -25.8751, -13.4320],
       device='cuda:0')
SINR mean = -20.859560012817383
E[H^H] = 1e-07
E_MSE (Error Power) = 305.3271179199219
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0165, 0.0017, 0.0224, 0.0201, 0.0157, 0.0037, 0.0005, 0.0084, 0.0007,
        0.0038, 0.0166, 0.0083, 0.0097, 0.0127, 0.0438, 0.0221, 0.0057, 0.0179,
        0.0026, 0.0434], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 886, 1000,  855,  866,  890, 1000, 1000,  949, 1000, 1000,  885,  950,
         936,  911,  780,  856,  983,  877, 1000,  782], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -4-----------
Real SNR = tensor([-4.1753, -3.4860, -3.6901, -3.0549, -4.6071, -4.3105, -3.7608, -3.8275,
        -4.9652, -3.8810, -3.2832, -3.1650, -3.2767, -4.0939, -3.6667, -2.6024,
        -2.8956, -2.7797, -3.3663, -3.7492], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([4.7910e+10-1.9775e+05j, 5.0503e+12+7.2988e+06j, 1.0960e+12+6.5437e+06j,
        1.0348e+12-8.1017e+06j, 1.9408e+11-1.1055e+06j, 4.7436e+10+2.7639e+05j,
        1.3888e+11+2.1053e+06j, 1.5948e+12-7.4764e+06j, 7.2266e+12-6.2461e+07j,
        1.9157e+13+1.3973e+08j, 2.1092e+12+6.3687e+06j, 7.3113e+13+2.9660e+07j,
        6.4822e+12+1.6213e+07j, 6.9546e+11-8.6201e+06j, 2.7183e+13+3.2484e+07j,
        1.0243e+13+5.3906e+07j, 1.0530e+13-8.5593e+07j, 2.5053e+12+5.4448e+06j,
        8.0258e+12-7.3925e+07j, 5.4777e+12+4.4564e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (9097599516672+2850286.5j)
SINR torch.Size([20]) = tensor([-23.1234, -22.3195, -21.9391, -24.2406, -21.2868, -21.2467, -24.7548,
        -21.8109, -19.1706, -17.6806, -19.9594, -14.4906, -21.5124, -22.5685,
        -14.9091, -16.3958, -18.6133, -17.0992, -18.1370, -17.4270],
       device='cuda:0')
SINR mean = -19.934263229370117
E[H^H] = 1e-07
E_MSE (Error Power) = 121.14864349365234
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0048, 0.0058, 0.0064, 0.0038, 0.0074, 0.0074, 0.0033, 0.0065, 0.0120,
        0.0168, 0.0100, 0.0343, 0.0070, 0.0055, 0.0313, 0.0224, 0.0136, 0.0191,
        0.0151, 0.0178], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 996,  981,  973, 1000,  960,  960, 1000,  971,  917,  884,  933,  809,
         965,  986,  819,  855,  904,  871,  894,  878], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -3-----------
Real SNR = tensor([-2.7283, -2.9627, -3.8975, -2.0060, -2.9807, -3.3847, -3.3317, -3.1994,
        -3.1902, -2.9193, -3.4239, -3.0202, -2.6057, -1.6319, -1.7344, -1.9621,
        -3.0322, -2.7555, -3.8546, -2.7356], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.3847e+13-1.1003e+08j, 1.4137e+12+2.2770e+07j, 4.8912e+11+4.2722e+05j,
        1.1564e+13+2.3910e+07j, 2.2058e+12-2.9770e+07j, 4.1918e+11-4.1010e+05j,
        1.2431e+12-1.5558e+05j, 1.1020e+10+1.0895e+06j, 2.0839e+11+6.8703e+06j,
        1.2978e+13+1.1388e+07j, 1.3521e+13-3.1457e+07j, 1.1937e+11-3.1075e+06j,
        1.2961e+12+1.8828e+06j, 1.4378e+14-6.8242e+08j, 4.3737e+13+1.3941e+07j,
        1.2133e+13+4.0905e+07j, 1.0477e+12+2.7346e+07j, 4.2413e+11-3.6649e+05j,
        4.7413e+11+4.1850e+05j, 4.8320e+12+2.5842e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (14287259041792-34046196j)
SINR torch.Size([20]) = tensor([-13.7436, -22.6210, -18.5995, -16.4382, -21.2819, -21.9266, -16.7743,
        -29.8883, -28.6593, -14.6366, -15.4374, -23.6539, -22.9614, -15.4182,
        -15.0766, -15.0445, -26.2524, -20.0361, -20.4789, -18.2823],
       device='cuda:0')
SINR mean = -19.86055564880371
E[H^H] = 1e-07
E_MSE (Error Power) = 183.12112426757812
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0405, 0.0054, 0.0136, 0.0222, 0.0074, 0.0064, 0.0206, 0.0010, 0.0014,
        0.0332, 0.0278, 0.0043, 0.0050, 0.0279, 0.0301, 0.0304, 0.0024, 0.0098,
        0.0089, 0.0146], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 790,  987,  904,  856,  960,  973,  863, 1000, 1000,  812,  832, 1000,
         993,  831,  823,  822, 1000,  935,  944,  897], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -2-----------
Real SNR = tensor([-1.9769, -2.5188, -2.4398, -1.9807, -1.7470, -2.2736, -1.8871, -1.9985,
        -2.5131, -0.9774, -1.8967, -1.5145, -1.2831, -1.4092, -1.5064, -0.7932,
        -1.4676, -1.9477, -1.9557, -1.4347], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.2717e+12-6.4845e+05j, 4.6566e+13+3.2645e+07j, 8.4978e+12-2.5659e+07j,
        2.3631e+12+8.8101e+06j, 3.3138e+12+7.9287e+06j, 1.0616e+11-2.1415e+04j,
        1.0673e+13-2.2408e+06j, 3.4471e+12-1.0479e+07j, 1.6160e+13+6.2643e+07j,
        5.9325e+12-1.3410e+07j, 8.4372e+11+5.9883e+06j, 2.0198e+11-1.2514e+06j,
        2.6050e+12-2.7387e+06j, 3.7438e+12-6.2889e+06j, 2.2410e+12+5.7713e+06j,
        2.0179e+12-2.1956e+06j, 1.5746e+12+3.6659e+05j, 1.9032e+11-1.5034e+06j,
        7.0215e+11+3.1192e+06j, 1.0444e+13+2.4709e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (6144779616256+4277158.5j)
SINR torch.Size([20]) = tensor([-16.9826, -11.8337, -18.1819, -16.0374, -12.9355, -25.0853, -12.9471,
        -15.1914, -15.7540, -15.2383, -19.4575, -18.7901, -14.3008, -20.4384,
        -17.4556, -15.4468, -18.6289, -18.8319, -18.7969, -14.9390],
       device='cuda:0')
SINR mean = -16.8636474609375
E[H^H] = 1e-07
E_MSE (Error Power) = 64.25115966796875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0196, 0.0615, 0.0150, 0.0243, 0.0484, 0.0031, 0.0483, 0.0294, 0.0259,
        0.0291, 0.0112, 0.0130, 0.0358, 0.0090, 0.0176, 0.0277, 0.0135, 0.0129,
        0.0130, 0.0311], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 868,  739,  895,  846,  769, 1000,  769,  826,  839,  827,  923,  908,
         804,  943,  879,  832,  905,  909,  908,  820], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = -1-----------
Real SNR = tensor([ 0.0531, -1.3411, -1.2413,  0.2732, -0.5563, -0.1686,  0.2486, -0.8170,
        -1.0967, -1.3507, -0.6866, -1.2012, -0.5967, -0.9582, -1.2153,  0.0701,
        -0.9421, -0.3614, -1.5165, -0.1446], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.1238e+13+24578204.0000j, 5.4990e+12-16398801.0000j,
        1.6501e+12+1586911.1250j, 6.4624e+12-5785889.0000j,
        5.9948e+12-16981872.0000j, 4.1691e+13+84171424.0000j,
        1.4574e+10-3367165.2500j, 1.5920e+10+4190900.0000j,
        1.0623e+12-2844062.5000j, 1.4926e+13-5455541.5000j,
        4.3633e+13-69921856.0000j, 5.4680e+12-15177006.0000j,
        2.0647e+11-2023920.2500j, 2.3602e+11+9443325.0000j,
        1.5410e+12+6317457.0000j, 1.2479e+13+11524300.0000j,
        2.3612e+12+4825999.5000j, 1.0604e+14+34643584.0000j,
        3.3557e+13+43343124.0000j, 2.4755e+13+46424520.0000j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (15941682331648+6654682j)
SINR torch.Size([20]) = tensor([-13.6627, -14.4632, -16.7551, -13.7313, -15.1677, -15.8927, -32.8987,
        -30.7203, -16.5383, -12.3040, -11.0488, -14.6817, -21.7082, -22.5091,
        -16.5255, -13.0621, -18.6547, -11.5873, -11.8332, -13.1137],
       device='cuda:0')
SINR mean = -16.84290885925293
E[H^H] = 1e-07
E_MSE (Error Power) = 197.23629760742188
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0413, 0.0345, 0.0207, 0.0406, 0.0295, 0.0251, 0.0005, 0.0008, 0.0217,
        0.0556, 0.0728, 0.0329, 0.0067, 0.0056, 0.0218, 0.0471, 0.0134, 0.0649,
        0.0615, 0.0466], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 788,  808,  863,  789,  825,  843, 1000, 1000,  858,  752,  717,  813,
         969,  984,  858,  772,  905,  732,  739,  773], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 0-----------
Real SNR = tensor([ 0.1787, -0.2397,  0.2297,  1.0240,  0.3100,  0.6938,  0.3636,  0.7662,
         1.0130,  0.2184, -0.1284,  0.6441,  1.0965,  0.4333,  0.2595,  0.9327,
         0.2038, -0.5744, -0.8562,  0.3338], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.0388e+13-2.9469e+07j, 2.4197e+11-2.7085e+07j, 2.7650e+13+4.8444e+07j,
        1.9618e+12-1.4031e+06j, 4.8594e+11-3.6640e+06j, 4.5283e+09+1.0742e+06j,
        6.8045e+12-4.2005e+06j, 4.7882e+12-3.5172e+06j, 4.9622e+11+1.0439e+07j,
        2.7108e+13+1.7280e+07j, 7.2000e+11+1.0181e+06j, 1.2135e+13-8.7778e+07j,
        1.2419e+13+2.3208e+07j, 1.8056e+12-1.2216e+07j, 4.0514e+12+1.5905e+07j,
        1.1877e+14-1.4411e+08j, 5.9989e+12+1.1164e+07j, 3.6112e+12-1.0355e+07j,
        9.0960e+09-1.4679e+06j, 8.1588e+13-3.3064e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (17051875803136-11489775j)
SINR torch.Size([20]) = tensor([-11.6275, -28.3682, -11.8926, -12.2469, -17.9774, -34.2928, -12.0179,
        -14.0374, -22.2408, -12.6758, -16.6457, -15.5673, -11.2102, -21.2257,
        -12.5563,  -9.7732, -15.8240, -13.8002, -28.3625,  -9.6400],
       device='cuda:0')
SINR mean = -16.5991268157959
E[H^H] = 1e-07
E_MSE (Error Power) = 236.2438201904297
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0643, 0.0015, 0.0607, 0.0563, 0.0157, 0.0004, 0.0591, 0.0380, 0.0059,
        0.0512, 0.0212, 0.0270, 0.0704, 0.0075, 0.0526, 0.0953, 0.0255, 0.0400,
        0.0015, 0.0980], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 733, 1000,  741,  750,  891, 1000,  744,  797,  979,  762,  860,  835,
         722,  959,  759,  680,  841,  791, 1000,  677], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 1-----------
Real SNR = tensor([1.7641, 1.0963, 1.3479, 2.6313, 1.4203, 0.9843, 0.4701, 1.6996, 1.7517,
        1.4353, 0.9496, 0.5727, 1.0596, 0.9364, 1.5138, 2.8113, 0.5496, 1.8168,
        1.1568, 0.7382], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.5390e+14+3.9265e+08j, 1.0412e+13+1.9176e+07j, 9.1016e+12-6.9442e+07j,
        1.0506e+13-3.1417e+06j, 8.4864e+12-3.0213e+06j, 4.5984e+12-1.2100e+06j,
        7.2100e+11-3.2236e+04j, 9.7775e+12-1.1947e+07j, 3.8407e+12+2.9956e+07j,
        2.6835e+13+2.5087e+07j, 1.1232e+13-8.0103e+06j, 5.8543e+11+2.0044e+06j,
        1.3586e+13-6.4121e+07j, 1.1828e+14-5.9044e+07j, 1.1530e+13-1.6184e+07j,
        2.1834e+11-1.9145e+07j, 9.1794e+10+1.8746e+06j, 8.0789e+13+3.4486e+07j,
        3.5623e+12+5.6295e+06j, 7.2600e+12-6.1632e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (24265954951168+9696599j)
SINR torch.Size([20]) = tensor([-11.3996, -12.0633, -15.3619, -12.7304, -13.8771, -10.9676, -15.2733,
        -12.8577, -14.4636,  -9.9497, -17.3873, -15.7506, -15.0637,  -7.2328,
        -12.7267, -25.2351, -21.2669,  -8.8798, -12.0404, -16.4041],
       device='cuda:0')
SINR mean = -14.046582221984863
E[H^H] = 1e-07
E_MSE (Error Power) = 44.687721252441406
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0676, 0.0585, 0.0283, 0.0506, 0.0393, 0.0741, 0.0288, 0.0492, 0.0345,
        0.0919, 0.0179, 0.0259, 0.0302, 0.1590, 0.0507, 0.0030, 0.0074, 0.1146,
        0.0588, 0.0224], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 727,  745,  830,  763,  793,  715,  828,  767,  808,  686,  877,  839,
         823,  602,  763, 1000,  960,  654,  745,  855], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 2-----------
Real SNR = tensor([1.9051, 1.4858, 1.9792, 2.3474, 1.4888, 2.3408, 2.3617, 2.3191, 2.2884,
        1.6329, 1.3900, 2.3306, 2.0317, 2.0544, 1.7489, 4.1283, 2.1106, 2.8383,
        1.7526, 2.3882], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([6.2153e+11+3.1016e+06j, 3.8518e+12-5.9331e+05j, 6.0920e+11-7.9401e+06j,
        7.0845e+11-1.3628e+07j, 1.2486e+12+4.7623e+06j, 2.7278e+13+4.4475e+07j,
        5.5058e+12+3.9677e+05j, 1.6030e+11+6.3500e+06j, 1.0660e+13-4.4992e+07j,
        4.8823e+13+1.8056e+08j, 1.5906e+13-2.3871e+07j, 1.5534e+14+6.5524e+08j,
        2.2600e+14+1.2241e+08j, 1.4904e+12-7.2525e+06j, 6.6688e+12+4.0135e+06j,
        3.7036e+11-4.3909e+06j, 4.3215e+12-1.1586e+07j, 2.0398e+12+1.4659e+07j,
        1.7246e+12+4.7719e+06j, 4.9496e+12+9.1750e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (25913695666176+46369676j)
SINR torch.Size([20]) = tensor([-15.4461, -12.5668, -16.5046, -15.0790, -12.6466,  -8.8705,  -8.8623,
        -21.2377, -11.9109, -10.2845,  -9.1797,  -8.7972,  -6.2915, -17.8861,
        -10.1986, -17.3067, -11.0532, -12.6393, -13.2259, -12.3479],
       device='cuda:0')
SINR mean = -12.616751670837402
E[H^H] = 1e-07
E_MSE (Error Power) = 26.877079010009766
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0277, 0.0525, 0.0219, 0.0301, 0.0516, 0.1148, 0.1150, 0.0075, 0.0605,
        0.0856, 0.1078, 0.1165, 0.1902, 0.0160, 0.0872, 0.0183, 0.0728, 0.0516,
        0.0454, 0.0550], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([832, 759, 857, 823, 761, 653, 653, 959, 741, 695, 663, 651, 572, 888,
        693, 875, 717, 761, 776, 753], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 3-----------
Real SNR = tensor([3.4419, 3.4031, 3.2090, 4.0374, 3.7875, 3.6802, 2.1948, 2.8709, 3.2528,
        3.6885, 3.1271, 2.6937, 3.0960, 3.8638, 2.6963, 4.9004, 2.6850, 2.4032,
        1.6650, 2.6974], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([9.3178e+11-6.1580e+05j, 1.9336e+12-7.1086e+06j, 1.3684e+13+3.3585e+07j,
        2.7896e+12-3.0954e+07j, 1.8933e+12+4.6698e+06j, 2.8987e+13-3.1081e+07j,
        6.9885e+11-3.9801e+06j, 3.8369e+12-9.0817e+05j, 7.3343e+11+5.1467e+06j,
        1.0434e+14-1.8349e+07j, 9.0763e+11-1.1522e+07j, 9.0632e+10+1.3599e+06j,
        3.4091e+12-1.9259e+07j, 2.7715e+12-3.7171e+07j, 2.6368e+13-2.4964e+07j,
        2.5085e+13-7.0166e+08j, 5.5820e+11-1.2286e+07j, 1.0199e+12-4.8793e+06j,
        1.3066e+11-7.7220e+06j, 1.6032e+10-2.6344e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (11009211236352-43398280j)
SINR torch.Size([20]) = tensor([-13.2856, -14.0701,  -7.8408, -15.1028, -13.9926,  -9.8166, -14.7950,
        -12.4217, -12.0736,  -6.0146, -14.3449, -17.1908, -12.3996, -17.7480,
         -8.0165, -18.1757, -14.5679, -16.2490, -20.5089, -20.2372],
       device='cuda:0')
SINR mean = -13.942606925964355
E[H^H] = 1e-07
E_MSE (Error Power) = 35.22846221923828
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0448, 0.0377, 0.1412, 0.0300, 0.0383, 0.0945, 0.0321, 0.0542, 0.0584,
        0.2002, 0.0355, 0.0187, 0.0544, 0.0165, 0.1364, 0.0150, 0.0338, 0.0232,
        0.0088, 0.0094], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([778, 798, 622, 824, 796, 682, 816, 755, 746, 563, 805, 873, 754, 885,
        627, 895, 810, 851, 945, 939], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 4-----------
Real SNR = tensor([3.6040, 2.8048, 4.3009, 5.2755, 4.7754, 4.8265, 6.0996, 4.5558, 3.5202,
        4.0300, 3.6416, 3.9971, 4.5816, 3.6398, 3.7563, 5.1356, 3.9452, 5.1581,
        3.9842, 4.0712], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.8820e+12+9.7687e+06j, 4.8218e+12+1.0040e+07j, 7.5043e+11+1.5815e+07j,
        5.2509e+12+2.4616e+07j, 5.8327e+13-1.9529e+08j, 9.3939e+09-1.9135e+07j,
        2.4896e+10+3.4012e+06j, 1.8025e+12-3.1785e+06j, 5.3052e+11-1.3094e+06j,
        9.4897e+11+5.0507e+07j, 4.4950e+12-8.9276e+06j, 1.0689e+14-9.0928e+07j,
        4.4166e+12-1.2017e+07j, 2.7164e+12+1.3748e+07j, 2.8503e+12-2.5353e+06j,
        6.4754e+11+1.6712e+06j, 5.6569e+12+3.9775e+06j, 2.3343e+12+3.8207e+07j,
        4.1730e+12-6.8226e+06j, 2.1879e+11+7.4020e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10437504532480-8382581j)
SINR torch.Size([20]) = tensor([-11.9591, -10.9296, -15.4228, -10.8499,  -8.9190, -34.6362, -23.2146,
         -9.1367,  -8.8174, -22.7415,  -7.9624,  -6.8361, -12.3665, -10.4895,
         -7.9173, -14.1905,  -9.4262, -14.8183,  -9.3787,  -9.4804],
       device='cuda:0')
SINR mean = -12.974637031555176
E[H^H] = 1e-07
E_MSE (Error Power) = 176.60289001464844
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0599, 0.0747, 0.0279, 0.0760, 0.1137, 0.0003, 0.0047, 0.1087, 0.1161,
        0.0053, 0.1378, 0.1716, 0.0548, 0.0820, 0.1391, 0.0367, 0.1024, 0.0319,
        0.1034, 0.1013], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 743,  714,  831,  712,  655, 1000,  998,  662,  652,  989,  625,  590,
         754,  701,  624,  801,  670,  817,  669,  672], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 5-----------
Real SNR = tensor([5.0803, 5.7374, 4.4044, 6.0433, 5.7799, 5.0392, 5.8139, 4.8850, 5.1878,
        5.7479, 4.3542, 5.7713, 5.4503, 5.1403, 4.8015, 5.8268, 5.0936, 5.5450,
        5.7360, 4.7424], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        nan+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.2101e+11+1.6219e+05j, 1.4585e+13+7.2319e+07j, 1.1318e+12-3.9322e+05j,
        3.0593e+13+2.3561e+07j, 2.1678e+11+1.0879e+06j, 2.4021e+12-1.2043e+06j,
        9.8167e+12+7.7802e+06j, 7.7454e+12-3.5776e+07j, 5.2019e+12-2.2494e+06j,
        4.3781e+13+7.5403e+07j, 1.6642e+12-2.8844e+06j, 4.3114e+12-1.5204e+06j,
        9.8350e+12-1.7903e+08j, 9.7136e+11-1.0518e+07j, 1.4836e+13-2.0972e+07j,
        5.1514e+12-3.6960e+06j, 3.0132e+11+1.3544e+07j, 2.9952e+13+1.4996e+08j,
        7.5967e+11+8.4378e+07j, 2.7661e+12-2.7040e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (9307167916032+7145661j)
SINR torch.Size([20]) = tensor([-15.0092,  -7.9692,  -9.4326,  -8.6098, -14.1135,  -7.2866,  -4.3695,
        -15.8452,  -6.9668,  -5.5671,  -6.0443,  -9.0415, -14.0057, -11.1507,
         -6.0373,  -6.2916, -19.9138, -10.2174, -21.3532, -12.3783],
       device='cuda:0')
SINR mean = -10.580158233642578
E[H^H] = 1e-07
E_MSE (Error Power) = 22.7939510345459
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0306, 0.1376, 0.1023, 0.1211, 0.0373, 0.1574, 0.2677, 0.0254, 0.1674,
        0.2172, 0.1991, 0.1109, 0.0382, 0.0713, 0.1994, 0.1902, 0.0101, 0.0869,
        0.0073, 0.0547], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([821, 626, 670, 645, 799, 604, 507, 842, 594, 548, 564, 659, 796, 720,
        563, 572, 932, 693, 962, 754], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 6-----------
Real SNR = tensor([5.5642, 6.7297, 6.2707, 7.2443, 6.5513, 6.6114, 6.7264, 7.0127, 6.4684,
        5.1343, 6.4288, 6.8240, 6.4589, 6.4998, 5.5846, 6.3307, 6.4748, 6.6353,
        5.6409, 5.7974], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([6.1399e+12-3.5432e+06j, 1.5097e+14+3.6705e+07j, 2.6665e+13+5.6447e+07j,
        1.2247e+14+1.0401e+08j, 4.0086e+10+1.2588e+04j, 1.4251e+14-1.4730e+07j,
        3.6483e+12+5.2213e+06j, 1.3151e+12-2.4046e+07j, 4.7659e+13+1.2954e+08j,
        2.7307e+11-1.2077e+07j, 2.6517e+13+7.3497e+07j, 4.1513e+12-5.1113e+07j,
        7.5531e+13-3.7762e+07j, 6.8387e+12+1.6021e+07j, 1.6960e+12-1.1981e+07j,
        1.2522e+12+1.6590e+06j, 2.0684e+13+2.0417e+08j, 2.4138e+12+1.0946e+07j,
        1.2203e+13+2.2944e+06j, 7.8607e+11-1.3226e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (32687802810368+23602356j)
SINR torch.Size([20]) = tensor([ -6.2660,  -7.3003,  -5.6362,  -2.7796, -14.3319,  -3.0643,  -9.1350,
        -13.0570,  -5.7766, -20.4100,  -7.2661, -12.3629,  -3.9207,  -7.4116,
         -8.3844,  -8.7553, -10.3193,  -7.5906,  -3.8286, -16.4556],
       device='cuda:0')
SINR mean = -8.702605247497559
E[H^H] = 1e-07
E_MSE (Error Power) = 14.723828315734863
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1911, 0.1570, 0.2145, 0.3452, 0.0356, 0.3306, 0.1088, 0.0471, 0.2091,
        0.0090, 0.1580, 0.0549, 0.2885, 0.1536, 0.1267, 0.1175, 0.0850, 0.1483,
        0.2929, 0.0221], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([571, 604, 550, 452, 805, 462, 661, 772, 555, 942, 603, 753, 492, 608,
        639, 650, 696, 614, 488, 856], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 7-----------
Real SNR = tensor([6.2327, 7.7210, 7.3595, 8.7329, 7.1736, 7.2722, 7.6209, 6.6413, 7.4581,
        6.8711, 7.1939, 6.6501, 7.9198, 7.4188, 7.4984, 8.9412, 6.5673, 6.4995,
        6.3381, 7.6780], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([1.1296e+14-60374016.0000j, 8.7530e+11-399986.8438j,
        5.3857e+11+38527112.0000j, 1.7211e+12-89204264.0000j,
        2.8275e+12-741991.5000j, 2.8149e+13-2838431.5000j,
        1.7683e+12+32066270.0000j, 2.1511e+13-62069992.0000j,
        1.9349e+12-5523022.5000j, 1.1817e+10-2174012.7500j,
        1.3586e+12+231996.2188j, 5.0130e+13+32590464.0000j,
        4.8556e+12-10848393.0000j, 5.8816e+13+22701106.0000j,
        1.4964e+12-1177099.7500j, 3.2772e+12-22196598.0000j,
        8.5451e+12+21242168.0000j, 5.2365e+12+4429145.5000j,
        3.5914e+12+2928076.0000j, 9.3387e+13+4140500.5000j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (20149490941952-4934548.5j)
SINR torch.Size([20]) = tensor([ -2.1757, -11.4521, -16.8942, -16.3069,  -6.0740,  -6.4107, -15.1057,
         -4.1816,  -7.6971, -25.0791,  -6.4529,  -2.8632,  -8.7505,  -4.5634,
         -6.5995,  -6.5043,  -6.4828,  -6.8158,  -7.6050,  -5.1966],
       device='cuda:0')
SINR mean = -8.660547256469727
E[H^H] = 1e-07
E_MSE (Error Power) = 26.11456871032715
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.3773, 0.0668, 0.0200, 0.0229, 0.1980, 0.1860, 0.0299, 0.2763, 0.1453,
        0.0031, 0.1845, 0.3409, 0.1177, 0.2591, 0.1795, 0.1828, 0.1835, 0.1723,
        0.1479, 0.2321], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 431,  729,  866,  852,  565,  576,  824,  501,  617, 1000,  577,  455,
         650,  514,  582,  579,  578,  589,  614,  535], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 8-----------
Real SNR = tensor([7.8840, 7.0441, 8.5051, 8.1682, 8.3526, 8.5749, 7.4231, 8.6029, 7.9743,
        8.4459, 8.0526, 6.7571, 8.1972, 7.5947, 8.7040, 9.0170, 8.3461, 8.1165,
        7.9419, 7.5988], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.2083e+37+6.7800e+32j, 1.3198e+37-2.5221e+32j,        inf+nanj,
               inf+nanj, 6.9751e+37-1.3102e+32j, 2.4365e+36-2.0527e+32j,
               inf+nanj,        inf+nanj, 2.8477e+38-6.0750e+32j,
               inf+nanj,        inf+nanj, 2.3179e+38+1.1699e+33j,
        2.2415e+37+1.6839e+31j, 1.0457e+38-1.4356e+32j, 2.3740e+36-3.1170e+30j,
               inf+nanj,        inf+nanj, 1.2462e+38+1.7381e+32j,
               inf+nanj, 1.1621e+38-1.3308e+32j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([2.2430e+13-2.8388e+07j, 3.6375e+10-1.0435e+06j, 4.5102e+12-1.6847e+08j,
        4.2611e+11+1.8413e+05j, 6.3079e+10+1.2154e+07j, 5.0396e+12+1.3484e+07j,
        7.1698e+13+1.2595e+07j, 3.6699e+11-1.3006e+06j, 7.9669e+12+2.8286e+06j,
        3.5923e+11-5.0596e+06j, 1.9152e+12-1.1510e+07j, 7.2025e+12-7.3250e+05j,
        6.9881e+12-1.5298e+08j, 4.8328e+12+1.8628e+06j, 4.5723e+12-8.3901e+06j,
        8.5424e+12+6.9311e+06j, 5.0959e+12+5.3134e+06j, 3.1002e+13-4.6152e+07j,
        1.9782e+11+1.6384e+06j, 2.7299e+13-1.7302e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10527283609600-19216842j)
SINR torch.Size([20]) = tensor([ -4.2036, -14.4554, -13.6308,  -8.4725, -26.5152,  -7.2870,  -1.8668,
         -8.7148,  -3.7652, -14.9968,  -8.6294,  -2.6326, -10.3322,  -2.6336,
         -6.0685,  -6.5605,  -8.7199,  -1.8822,  -8.9483,  -4.3718],
       device='cuda:0')
SINR mean = -8.234355926513672
E[H^H] = 1e-07
E_MSE (Error Power) = 30.331912994384766
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2753, 0.0346, 0.0415, 0.1245, 0.0022, 0.1574, 0.3942, 0.1185, 0.2959,
        0.0307, 0.1206, 0.3529, 0.0848, 0.3529, 0.1982, 0.1808, 0.1184, 0.3933,
        0.1130, 0.2676], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 501,  808,  787,  641, 1000,  604,  420,  649,  486,  821,  646,  447,
         697,  447,  564,  581,  649,  420,  656,  507], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)
--------SNR = 9-----------
Real SNR = tensor([ 9.1397,  8.5574,  9.3532, 10.0416,  9.3714,  8.4928,  9.2719,  8.8517,
         8.8149, 10.6635,  8.6057,  8.9455,  8.9994,  9.3464,  9.0127, 10.9465,
         9.4078,  9.1952,  9.9117,  8.9095], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([3.1171e+36+3.7490e+30j, 7.5951e+36+3.4959e+31j, 4.8786e+35+2.6937e+30j,
        1.3492e+37-2.8549e+30j, 1.3053e+37+6.1220e+31j, 1.5426e+36-3.8426e+30j,
        4.0230e+35+1.1995e+30j, 2.2986e+36-9.1905e+30j, 6.4134e+36-1.4498e+31j,
        8.4245e+35+5.8947e+29j, 1.3277e+37+8.0174e+30j, 7.3220e+37+1.6377e+31j,
        3.8780e+36-1.4791e+31j,        inf+nanj, 6.0497e+36-2.4980e+31j,
        2.2613e+37+2.0498e+31j, 1.2674e+38+3.7924e+31j, 1.5885e+37+4.6270e+31j,
        5.2951e+37-1.7795e+32j, 4.3891e+36-2.3205e+30j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([2.7647e+11-2.0489e+06j, 6.7837e+11+1.2784e+06j, 2.7290e+11+1.0304e+06j,
        1.0023e+12-7.3468e+06j, 5.0249e+11-1.3893e+06j, 2.0531e+11+1.1175e+06j,
        1.5643e+13+2.4294e+08j, 9.6053e+10+8.0116e+02j, 1.7811e+12+8.2429e+07j,
        6.2257e+13+3.6276e+07j, 4.3246e+13+2.7081e+07j, 2.3293e+11+1.1100e+06j,
        1.9501e+12+9.4588e+06j, 1.5741e+13+7.1428e+06j, 5.9493e+11-1.1862e+07j,
        1.2057e+13-3.6218e+07j, 1.1318e+13-3.4048e+06j, 2.7070e+11-2.1738e+06j,
        2.1969e+11+4.5786e+06j, 3.2295e+12+1.4361e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8578743664640+18217942j)
SINR torch.Size([20]) = tensor([-11.6440,  -5.7131,  -9.1963,  -5.3036,  -8.2108,  -8.8349,  -8.1582,
         -8.8211, -10.2708,  -1.7230,  -4.3978,  -7.8378,  -5.2817,  -2.3806,
        -13.3669,  -3.3970,  -6.6704, -12.0154, -10.9061,  -6.5374],
       device='cuda:0')
SINR mean = -7.53334903717041
E[H^H] = 1e-07
E_MSE (Error Power) = 7.288338661193848
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0641, 0.2116, 0.1074, 0.2277, 0.1312, 0.1156, 0.1326, 0.1160, 0.0859,
        0.4021, 0.2665, 0.1413, 0.2286, 0.3663, 0.0440, 0.3138, 0.1771, 0.0592,
        0.0751, 0.1816], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([734, 553, 663, 539, 633, 652, 632, 652, 695, 415, 508, 622, 538, 438,
        780, 473, 584, 744, 713, 580], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 60)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 60)

--- 処理中: 画像 81 から 100 (バッチサイズ: 20) ---
img_chunk shape = torch.Size([20, 3, 256, 256])
20 images are saved in ./sentimg/ (starting from index 80)
Encoder, forward@@@@@@@@@@@@@@@
autoencoder.py, h = torch.Size([20, 8, 32, 32])
autoencoder.py , moments = torch.Size([20, 8, 32, 32])
encode start = 
z_variance before normalization = tensor([0.6931, 0.5226, 0.7302, 0.7399, 0.7176, 0.6209, 0.5511, 0.6197, 0.7088,
        0.8136, 0.7387, 0.7753, 0.8751, 0.5915, 0.6488, 0.7575, 0.5067, 0.6304,
        0.9573, 0.5433], device='cuda:0')
--------SNR = -5-----------
Real SNR = tensor([-5.4335, -4.3080, -4.9350, -4.6256, -4.1754, -4.3007, -4.7542, -4.7587,
        -4.9028, -4.3843, -3.7673, -4.6952, -5.6055, -4.8800, -3.7464, -4.0603,
        -4.7484, -4.4130, -2.8902, -4.2139], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.1957e+10-2.7594e+06j, 3.2131e+13+2.6814e+07j, 3.1099e+11-6.4509e+06j,
        1.1372e+12-3.8714e+05j, 1.4179e+11-3.9069e+07j, 5.2470e+11-1.5324e+06j,
        9.8897e+12+6.1218e+07j, 7.8136e+13-8.9591e+07j, 5.9941e+12+8.9212e+06j,
        3.2987e+13-1.9205e+08j, 2.2098e+12-4.1419e+07j, 9.0107e+11+1.1039e+07j,
        2.8214e+13+7.4003e+07j, 2.1323e+11-3.9215e+06j, 2.6717e+13-6.6438e+07j,
        4.8491e+12-7.0087e+07j, 1.1603e+13-1.0892e+07j, 8.1752e+09-4.5775e+05j,
        1.2098e+12+1.4649e+07j, 7.3113e+12+1.7246e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (12225505918976-15558122j)
SINR torch.Size([20]) = tensor([-33.8522, -17.1390, -25.8637, -19.5348, -37.5700, -24.3938, -20.6836,
        -13.8076, -18.1016, -19.2509, -26.9197, -23.1850, -17.3755, -25.5860,
        -15.8949, -22.4660, -17.6737, -34.9223, -22.2394, -15.7726],
       device='cuda:0')
SINR mean = -22.611602783203125
E[H^H] = 1e-07
E_MSE (Error Power) = 696.5040283203125
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0004, 0.0190, 0.0026, 0.0110, 0.0002, 0.0036, 0.0085, 0.0400, 0.0152,
        0.0117, 0.0020, 0.0048, 0.0180, 0.0028, 0.0251, 0.0056, 0.0168, 0.0003,
        0.0059, 0.0258], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  872, 1000,  924, 1000, 1000,  948,  791,  893,  918, 1000,  997,
         877, 1000,  843,  984,  884, 1000,  979,  840], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -4-----------
Real SNR = tensor([-2.7697, -1.9671, -3.9088, -2.9619, -3.1163, -4.3279, -2.7661, -4.4788,
        -3.9228, -3.2184, -3.0604, -4.0080, -3.7266, -3.4682, -4.7644, -3.6740,
        -3.4639, -3.1872, -3.1181, -4.2268], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([6.6803e+13-2.4449e+07j, 1.5739e+12-2.2245e+07j, 1.1626e+13-4.5593e+07j,
        7.4202e+12-1.3510e+07j, 1.0391e+14+2.7270e+07j, 5.2460e+10-5.1330e+05j,
        2.1732e+12+2.2133e+07j, 4.1484e+12+1.2414e+07j, 9.4689e+12+5.0541e+06j,
        6.5022e+12-8.4317e+07j, 9.9408e+12-3.4206e+07j, 1.5868e+13-5.4004e+06j,
        1.3601e+14+4.9124e+07j, 1.2558e+13+1.2322e+06j, 4.3657e+12-6.5091e+06j,
        2.1886e+13-1.1267e+08j, 7.9659e+12-2.6158e+07j, 3.0964e+13+1.1446e+07j,
        5.6033e+12+5.6277e+06j, 1.8148e+12+3.4810e+05j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (23032464670720-12046172j)
SINR torch.Size([20]) = tensor([-13.0691, -23.4354, -16.5728, -23.2780, -14.1545, -27.2679, -24.2546,
        -20.1377, -14.8001, -19.8663, -19.1238, -16.3760, -13.0680, -21.4611,
        -17.7939, -17.5294, -17.6339, -16.3832, -22.8963, -22.5781],
       device='cuda:0')
SINR mean = -19.08399772644043
E[H^H] = 1e-07
E_MSE (Error Power) = 121.66837310791016
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0470, 0.0045, 0.0215, 0.0047, 0.0370, 0.0019, 0.0037, 0.0096, 0.0321,
        0.0102, 0.0121, 0.0225, 0.0470, 0.0071, 0.0163, 0.0174, 0.0170, 0.0225,
        0.0051, 0.0055], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 772, 1000,  859,  999,  800, 1000, 1000,  937,  816,  931,  916,  854,
         772,  964,  886,  881,  883,  854,  992,  986], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -3-----------
Real SNR = tensor([-2.5666, -0.9100, -2.9376, -1.3949, -2.1579, -3.1952, -3.1989, -2.5942,
        -3.2006, -1.7561, -3.0747, -1.2046, -2.5354, -2.6448, -2.3364, -4.1940,
        -1.9896, -3.1021, -1.2838, -2.0324], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([4.4097e+12+3.7833e+06j, 2.7786e+13+5.6594e+07j, 3.9421e+12+4.3676e+07j,
        2.3945e+14+2.6440e+08j, 5.6413e+12+2.9476e+07j, 7.8148e+12-4.8867e+07j,
        1.6991e+11+6.6024e+05j, 4.0083e+13+3.1913e+07j, 7.4952e+12+6.3661e+06j,
        1.1413e+11+1.1284e+06j, 5.0577e+12-8.0400e+06j, 5.7494e+10-3.5513e+06j,
        3.6176e+13+3.9093e+07j, 4.3475e+12+9.3948e+05j, 3.0257e+13+7.2329e+07j,
        4.9045e+12-4.0879e+07j, 2.3825e+13+1.9925e+07j, 3.5188e+12-1.0440e+07j,
        1.3248e+12-1.4590e+07j, 3.0069e+13+3.0584e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (23822285668352+23724862j)
SINR torch.Size([20]) = tensor([-14.8562, -16.0237, -19.4831, -12.0091, -18.0627, -17.4086, -22.9880,
        -14.0547, -14.3274, -24.6238, -20.6727, -32.2092, -13.8790, -14.4668,
        -16.1643, -19.7051, -15.6512, -19.4237, -21.6141, -12.8900],
       device='cuda:0')
SINR mean = -18.025678634643555
E[H^H] = 1e-07
E_MSE (Error Power) = 154.54771423339844
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0317, 0.0244, 0.0111, 0.0592, 0.0154, 0.0178, 0.0050, 0.0378, 0.0356,
        0.0034, 0.0085, 0.0006, 0.0393, 0.0345, 0.0236, 0.0106, 0.0265, 0.0113,
        0.0068, 0.0489], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 818,  846,  923,  744,  892,  878,  994,  798,  804, 1000,  948, 1000,
         793,  808,  849,  928,  837,  922,  967,  767], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -2-----------
Real SNR = tensor([-1.3030, -1.4679, -1.2382, -1.7519, -2.6432, -1.5724, -0.8223, -1.7317,
        -2.3246, -3.1682, -1.4391, -1.5319, -2.8852, -2.5801, -1.3536, -0.9906,
        -1.6015, -2.5479, -2.7333, -2.2750], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.6997e+14+1.2352e+08j, 1.4783e+13-4.8305e+07j, 4.3226e+13+4.7652e+06j,
        1.6159e+13-5.2780e+05j, 9.4343e+12-1.4935e+07j, 4.0340e+13-1.6177e+07j,
        1.5024e+14+1.2521e+08j, 1.5704e+14+3.4310e+08j, 1.9776e+12+6.9108e+06j,
        5.8355e+09-5.8680e+06j, 1.6898e+13+1.6918e+06j, 1.8260e+12+1.0744e+07j,
        1.8643e+12+7.2984e+05j, 2.6713e+13-8.6480e+07j, 4.3672e+12+2.1443e+06j,
        2.1069e+12-3.6243e+06j, 1.5920e+13-6.6120e+06j, 4.1970e+13-2.2928e+07j,
        1.1968e+11+3.2333e+06j, 3.3887e+12-3.6167e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (35917565788160+19021468j)
SINR torch.Size([20]) = tensor([-11.1619, -19.0926, -11.1860, -15.1778, -16.3093, -13.1701, -11.8997,
        -12.2081, -23.1798, -36.6210, -11.7505, -17.8305, -16.8652, -13.8796,
        -21.7871, -14.4865, -14.7118, -12.6062, -22.7629, -18.7019],
       device='cuda:0')
SINR mean = -16.769437789916992
E[H^H] = 1e-07
E_MSE (Error Power) = 283.553466796875
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0711, 0.0122, 0.0707, 0.0295, 0.0229, 0.0460, 0.0607, 0.0567, 0.0048,
        0.0002, 0.0626, 0.0162, 0.0202, 0.0393, 0.0066, 0.0344, 0.0327, 0.0520,
        0.0053, 0.0133], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 720,  915,  721,  825,  852,  775,  741,  749,  997, 1000,  737,  887,
         865,  793,  970,  808,  814,  760,  989,  906], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = -1-----------
Real SNR = tensor([-1.5722,  0.4811, -0.3970, -1.2170, -1.4518, -1.1443,  0.2434, -0.5805,
        -0.7719, -0.5259, -1.2268, -0.2384, -1.0525, -0.4107, -0.6349, -1.2898,
        -1.2810, -0.5499, -1.6558, -0.7040], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([2.3124e+12-1.3646e+06j, 9.7944e+13-5.2981e+07j, 1.1739e+12-5.1273e+06j,
        7.2173e+11+5.9708e+05j, 5.7284e+11-1.1243e+06j, 5.3967e+12+6.4570e+07j,
        9.4053e+12-2.1155e+07j, 6.9560e+13-1.7031e+08j, 1.0728e+12+3.4432e+06j,
        9.8203e+12+1.3062e+07j, 5.6802e+12+4.4022e+06j, 1.0040e+12+1.1964e+07j,
        2.2166e+13-2.7968e+08j, 3.2258e+13-1.6154e+07j, 1.4364e+12-7.4201e+05j,
        9.6782e+10+6.6771e+05j, 1.3809e+12-8.0449e+06j, 1.2486e+13+2.0358e+07j,
        1.3434e+13+6.2290e+06j, 2.4215e+13+7.2467e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (15606874112000-17946220j)
SINR torch.Size([20]) = tensor([-13.2565,  -9.6904, -21.4154, -14.7353, -15.9498, -18.4991, -13.0998,
        -20.3960, -14.5443, -12.5107, -13.8266, -22.2289, -18.0415, -11.3789,
        -15.5362, -18.3340, -17.1797, -12.7531, -14.3805, -12.2500],
       device='cuda:0')
SINR mean = -15.500335693359375
E[H^H] = 1e-07
E_MSE (Error Power) = 48.623634338378906
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0451, 0.0970, 0.0072, 0.0325, 0.0248, 0.0139, 0.0467, 0.0090, 0.0339,
        0.0531, 0.0398, 0.0059, 0.0155, 0.0679, 0.0272, 0.0145, 0.0188, 0.0504,
        0.0352, 0.0562], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([777, 678, 963, 815, 844, 902, 773, 942, 810, 757, 792, 979, 892, 727,
        834, 898, 873, 764, 806, 750], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 0-----------
Real SNR = tensor([-0.1378,  0.8237,  0.0904,  0.7067,  0.3767, -0.0655,  0.2698,  0.0674,
         0.4609,  0.4722,  0.1012,  0.7760, -0.3888, -0.2387,  0.6612, -0.8808,
         1.4816,  0.2630,  0.6396,  0.4251], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([6.3329e+10-4.6345e+05j, 6.1420e+10-1.1106e+05j, 1.8772e+12+3.9757e+06j,
        2.2638e+13-1.3275e+07j, 7.1575e+12-8.6922e+06j, 5.6929e+13+2.5563e+08j,
        6.5908e+10-1.3697e+07j, 8.5930e+12-7.8590e+07j, 6.9130e+13-1.4710e+08j,
        1.1557e+12-6.1365e+07j, 3.4697e+11-3.6129e+06j, 1.0897e+12-4.0608e+06j,
        1.2437e+12-8.3231e+06j, 2.2922e+11+6.6185e+07j, 3.3674e+12-2.6919e+06j,
        1.1656e+13-3.2475e+07j, 2.1515e+12+1.1055e+08j, 5.1574e+12+5.9802e+07j,
        1.3241e+13+3.4766e+06j, 1.8604e+11-1.8787e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10317048315904+6164159.5j)
SINR torch.Size([20]) = tensor([-26.7794, -19.3894, -15.3441, -10.2821, -11.0489, -12.5084, -30.5247,
        -14.4400, -12.9260, -21.7436, -21.3286, -18.1956, -17.6440, -28.5877,
        -16.7125, -13.3987, -21.5531, -17.3393, -10.3810, -19.2776],
       device='cuda:0')
SINR mean = -17.970239639282227
E[H^H] = 1e-07
E_MSE (Error Power) = 165.21536254882812
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0021, 0.0114, 0.0284, 0.0857, 0.0728, 0.0531, 0.0009, 0.0347, 0.0485,
        0.0066, 0.0073, 0.0149, 0.0169, 0.0014, 0.0209, 0.0437, 0.0069, 0.0181,
        0.0839, 0.0117], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([1000,  921,  830,  695,  717,  757, 1000,  807,  768,  969,  961,  895,
         883, 1000,  862,  781,  966,  876,  698,  919], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 1-----------
Real SNR = tensor([-0.1812,  1.6319,  1.3470,  0.8602,  1.4679,  1.1851,  1.4649,  0.8037,
         0.9830,  0.4491,  1.6273,  1.6070,  1.3517,  0.4455,  0.8198,  0.4942,
         2.5651,  1.1026,  1.4823,  1.1577], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.0601e+12-2.4357e+06j, 2.3986e+13-1.7055e+08j, 1.6968e+12-2.7033e+06j,
        3.7446e+12-6.7522e+06j, 4.6601e+12-4.9968e+06j, 5.2633e+10-9.2262e+05j,
        7.8178e+11+1.1204e+06j, 2.0229e+13-3.4945e+07j, 7.2357e+10-3.7590e+05j,
        1.5298e+12-2.1861e+07j, 1.1555e+12+6.6435e+06j, 2.1322e+13-4.0659e+06j,
        4.0103e+12+4.7251e+07j, 4.0610e+11+1.6004e+05j, 2.8168e+13-2.2543e+06j,
        8.6545e+11-1.6624e+07j, 1.1758e+12-6.2317e+06j, 1.8765e+11-6.8129e+06j,
        9.5169e+13-9.7230e+07j, 5.9730e+12-2.5033e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10912322813952-17431118j)
SINR torch.Size([20]) = tensor([-10.4697, -17.0305, -16.2420, -11.0728, -12.0163, -21.7228, -15.7373,
        -10.4030, -18.2780, -19.9861, -14.3341, -10.8094, -19.3611, -17.4670,
         -9.2284, -19.3309, -18.4942, -31.9242,  -8.7427, -12.1314],
       device='cuda:0')
SINR mean = -15.73908519744873
E[H^H] = 1e-07
E_MSE (Error Power) = 121.16336822509766
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0824, 0.0194, 0.0232, 0.0725, 0.0591, 0.0067, 0.0260, 0.0835, 0.0146,
        0.0099, 0.0356, 0.0766, 0.0115, 0.0176, 0.1067, 0.0115, 0.0139, 0.0006,
        0.1178, 0.0577], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 701,  869,  851,  718,  744,  969,  839,  699,  897,  934,  805,  710,
         921,  879,  664,  920,  902, 1000,  650,  747], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 2-----------
Real SNR = tensor([2.6215, 2.4336, 1.4224, 1.4143, 2.1594, 1.9590, 1.8923, 1.6267, 1.8124,
        1.4544, 2.4940, 2.7410, 2.4010, 1.8308, 2.2982, 1.6235, 2.7269, 2.0958,
        2.0458, 1.9590], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.5422e+12-6.5319e+07j, 9.6119e+12-5.8569e+07j, 2.6015e+12+1.1690e+07j,
        7.6740e+11+5.2974e+06j, 1.1645e+12-7.7246e+06j, 5.6152e+12-2.3860e+06j,
        7.7758e+12-1.2966e+07j, 4.3574e+13+1.6211e+08j, 1.0874e+13-2.0691e+07j,
        3.1348e+13+6.3693e+07j, 3.2524e+12+8.2498e+06j, 2.4674e+13+2.0912e+07j,
        6.0352e+12-4.4294e+07j, 5.1734e+12+7.5229e+06j, 9.5671e+11+2.8676e+07j,
        1.1540e+12-8.8566e+06j, 1.9136e+12-1.0033e+07j, 5.5387e+11+7.0154e+06j,
        1.3144e+13+6.3389e+07j, 2.0636e+12+1.1809e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (8789746515968+7976137.5j)
SINR torch.Size([20]) = tensor([-15.6399, -15.5112, -12.1258, -15.6454, -18.3609, -10.3768, -12.9507,
        -11.4522,  -9.7317,  -9.7208, -14.2282,  -7.8942, -13.9286, -11.2233,
        -19.1156, -18.3480, -14.2013, -17.6536, -12.7412, -11.0677],
       device='cuda:0')
SINR mean = -13.595855712890625
E[H^H] = 1e-07
E_MSE (Error Power) = 29.688573837280273
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0266, 0.0273, 0.0578, 0.0265, 0.0144, 0.0840, 0.0482, 0.0668, 0.0961,
        0.0964, 0.0364, 0.1397, 0.0389, 0.0702, 0.0121, 0.0144, 0.0366, 0.0169,
        0.0505, 0.0725], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([837, 834, 747, 837, 899, 698, 769, 729, 679, 679, 802, 623, 794, 722,
        915, 899, 801, 883, 764, 718], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 3-----------
Real SNR = tensor([3.0931, 3.4926, 4.2854, 3.5116, 3.0717, 4.1654, 3.8745, 5.0809, 3.6788,
        2.6517, 2.6149, 2.4602, 3.3764, 3.6261, 3.0697, 3.3725, 3.5246, 4.1658,
        3.2162, 3.6301], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, nan+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj,
        nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([1.3787e+13-4.4366e+07j, 1.8459e+13+2.6444e+06j, 3.1227e+12-1.4515e+07j,
        1.6473e+12+1.0577e+07j, 2.7495e+12+2.9848e+07j, 1.3145e+11+1.6842e+06j,
        1.5819e+12-2.4556e+07j, 3.0429e+13+4.3913e+07j, 1.1494e+12-5.4394e+06j,
        1.2483e+13-6.2697e+06j, 1.7421e+10+3.5284e+05j, 9.7397e+12+3.5533e+07j,
        9.9766e+11+5.7387e+06j, 4.8439e+11-2.3664e+06j, 1.2910e+13+8.5806e+06j,
        3.7571e+12+6.5895e+07j, 1.3131e+12+8.5260e+06j, 7.0435e+13+1.4770e+08j,
        3.4156e+13+7.7023e+07j, 5.2194e+11+6.5195e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10993608425472+20285006j)
SINR torch.Size([20]) = tensor([ -9.9188,  -8.5731, -12.7893, -17.3302, -17.7968, -14.3616, -14.8018,
         -8.9978, -16.3913,  -7.6746, -18.8036, -10.1320, -14.5514, -16.1366,
         -6.6593, -16.7836, -11.5624,  -7.4651,  -9.7262, -25.4262],
       device='cuda:0')
SINR mean = -13.294082641601562
E[H^H] = 1e-07
E_MSE (Error Power) = 42.56624221801758
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0925, 0.1220, 0.0500, 0.0182, 0.0163, 0.0353, 0.0320, 0.1119, 0.0224,
        0.1459, 0.0130, 0.0884, 0.0339, 0.0238, 0.1775, 0.0205, 0.0652, 0.1520,
        0.0963, 0.0029], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 685,  644,  765,  876,  887,  805,  816,  657,  854,  616,  909,  691,
         810,  848,  584,  864,  732,  610,  679, 1000], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 4-----------
Real SNR = tensor([3.3992, 4.5168, 4.8690, 4.0938, 3.9073, 4.8925, 4.8932, 4.6542, 3.9851,
        5.0537, 3.6129, 5.8989, 2.9736, 4.3128, 4.6348, 3.7041, 4.3911, 3.2226,
        4.2988, 4.7789], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([nan+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, inf+nanj, nan+nanj,
        inf+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj, nan+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([9.4612e+10+9.6326e+06j, 4.6246e+12-4.6697e+07j, 6.6869e+11-5.6580e+06j,
        1.9083e+12+3.8672e+06j, 2.4507e+12-9.1381e+06j, 9.8138e+12-6.2161e+07j,
        4.2833e+12-6.1604e+06j, 1.0678e+14+7.9729e+07j, 1.2158e+12+6.7301e+05j,
        3.4916e+13+5.7854e+07j, 9.8215e+11-1.9495e+06j, 6.3012e+11-2.1657e+06j,
        1.5818e+12-8.3841e+06j, 8.5062e+11-8.2054e+05j, 9.2520e+12-2.6284e+07j,
        1.1727e+12-3.8717e+06j, 1.1927e+14-4.5345e+06j, 4.9018e+10+1.2612e+06j,
        1.5622e+14+5.8572e+07j, 7.2251e+13+3.1094e+08j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (26450847596544+17235524j)
SINR torch.Size([20]) = tensor([-20.8360, -13.3592, -13.1010, -10.1794, -10.0694, -11.4469,  -7.9360,
         -7.0521,  -8.7130,  -8.6440,  -8.7149, -12.6962, -13.2301, -11.9442,
         -9.4416, -11.8767,  -6.6287, -19.9627,  -4.8150,  -8.9492],
       device='cuda:0')
SINR mean = -10.979822158813477
E[H^H] = 1e-07
E_MSE (Error Power) = 21.250057220458984
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0082, 0.0441, 0.0467, 0.0876, 0.0896, 0.0669, 0.1386, 0.1647, 0.1185,
        0.1202, 0.1185, 0.0510, 0.0454, 0.0601, 0.1021, 0.0610, 0.1785, 0.0100,
        0.2481, 0.1130], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([951, 780, 773, 692, 689, 728, 625, 597, 649, 647, 649, 762, 776, 742,
        671, 740, 583, 933, 522, 656], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 5-----------
Real SNR = tensor([4.9818, 6.3265, 4.6919, 5.3615, 5.8371, 4.7546, 4.7431, 5.4857, 6.1155,
        5.7597, 4.3646, 5.6243, 4.7736, 5.2714, 4.2439, 4.9527, 5.5719, 5.3892,
        5.0959, 5.7456], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, nan+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(nan+nanj)
torch.linalg.det(H.mH@H) = tensor([3.4830e+11-3.1056e+06j, 5.4155e+11-2.0951e+06j, 1.2311e+12-5.9427e+06j,
        1.6809e+14+1.5692e+08j, 1.9427e+11-2.1337e+06j, 9.2580e+10-5.0515e+06j,
        2.6436e+12+2.5748e+06j, 1.0517e+13-5.2410e+07j, 2.1662e+13+1.1912e+07j,
        5.4279e+12+2.2330e+07j, 1.0639e+12+4.5638e+06j, 6.2294e+12+6.2106e+05j,
        3.9300e+12+6.4251e+06j, 2.2102e+13+2.4962e+08j, 2.8584e+10+5.2620e+05j,
        2.6255e+12-4.3637e+07j, 7.7762e+11-7.1722e+05j, 1.4051e+13-3.5283e+07j,
        4.5893e+12-3.8118e+05j, 3.3981e+12-9.6251e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (13476962500608+14755621j)
SINR torch.Size([20]) = tensor([-14.1181, -14.6245, -10.0429,  -5.3812, -21.8715, -18.6565,  -8.8184,
        -10.0541,  -8.5043,  -8.6004, -13.4829,  -6.1490, -12.2300, -10.9903,
        -15.0755, -12.2266, -10.3400,  -8.2267, -12.4748, -11.3350],
       device='cuda:0')
SINR mean = -11.660128593444824
E[H^H] = 1e-07
E_MSE (Error Power) = 24.035266876220703
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0373, 0.0333, 0.0901, 0.2246, 0.0065, 0.0134, 0.1160, 0.0899, 0.1237,
        0.1213, 0.0429, 0.1953, 0.0565, 0.0737, 0.0301, 0.0565, 0.0846, 0.1308,
        0.0535, 0.0685], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([799, 812, 688, 541, 972, 905, 652, 689, 642, 645, 783, 567, 750, 716,
        823, 750, 697, 634, 756, 725], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 6-----------
Real SNR = tensor([6.4988, 7.1322, 7.0113, 6.5634, 6.1503, 6.0237, 6.8711, 6.7904, 4.7094,
        6.9745, 6.8753, 6.3594, 6.3363, 6.1832, 6.7877, 5.5425, 7.5097, 5.5864,
        6.2155, 5.8946], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([2.1218e+13-2.8847e+07j, 1.6699e+12-1.0702e+07j, 9.8208e+11+2.2264e+06j,
        3.4285e+10+1.4532e+06j, 8.2507e+11+7.2803e+06j, 3.5510e+13-1.7189e+08j,
        1.6458e+14+1.6458e+08j, 1.7164e+13-2.2471e+07j, 4.8226e+11-1.1960e+06j,
        1.0511e+14-1.2444e+08j, 2.0978e+13+7.8847e+07j, 1.8056e+11+2.7688e+05j,
        5.9875e+12+7.5613e+06j, 1.8005e+13-8.7645e+06j, 5.0626e+12+2.8839e+07j,
        3.9634e+13+9.6782e+06j, 4.4186e+13+8.5359e+06j, 5.1731e+11+3.8828e+06j,
        1.6480e+14-1.5379e+08j, 1.6774e+13-1.1043e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (33185259847680-10999463j)
SINR torch.Size([20]) = tensor([ -5.7818, -15.5739, -14.6622, -18.3321,  -9.5208,  -6.5132,  -2.5209,
         -5.2777,  -7.0995,  -8.5228,  -6.1558,  -9.8421,  -8.4293,  -4.4558,
         -8.7148,  -2.8881,  -4.6900, -13.4618,  -3.6275,  -5.9337],
       device='cuda:0')
SINR mean = -8.100184440612793
E[H^H] = 1e-07
E_MSE (Error Power) = 11.613489151000977
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2089, 0.0270, 0.0331, 0.0145, 0.1004, 0.1825, 0.3588, 0.2288, 0.1632,
        0.1232, 0.1951, 0.0940, 0.1255, 0.2639, 0.1185, 0.3396, 0.2535, 0.0431,
        0.3025, 0.2032], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([555, 835, 813, 898, 673, 579, 443, 538, 598, 643, 567, 683, 640, 510,
        649, 456, 518, 782, 481, 560], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 7-----------
Real SNR = tensor([7.2772, 7.5285, 5.8234, 6.5362, 6.9736, 7.1829, 7.0264, 7.9752, 8.2784,
        7.3994, 6.5880, 8.3460, 6.1424, 7.7039, 7.8210, 6.6561, 6.7139, 6.8098,
        7.4676, 7.2100], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj,
        inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj, inf+nanj],
       device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([1.9047e+13-4.7606e+07j, 1.5279e+12+2.9039e+07j, 1.1418e+12+2.3891e+05j,
        1.3659e+11+1.1433e+07j, 3.1893e+11+1.8245e+07j, 2.3251e+12-7.0635e+07j,
        1.4776e+11+1.1064e+06j, 8.3540e+09+5.1217e+06j, 2.4699e+13-4.6377e+07j,
        1.7026e+13+1.4805e+08j, 4.5299e+12+7.4280e+06j, 5.7027e+13+2.6302e+08j,
        6.7236e+10-7.1520e+05j, 3.0990e+13+1.4660e+08j, 2.6816e+12-1.8531e+07j,
        1.8118e+12-5.9524e+06j, 2.8868e+13+1.3102e+08j, 2.0124e+12-9.8664e+06j,
        8.6303e+12+4.5614e+07j, 1.0099e+11+8.8478e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10154955243520+30804064j)
SINR torch.Size([20]) = tensor([ -4.4625, -11.2581,  -5.9000, -19.0597, -15.4195, -11.1791, -10.7378,
        -25.7635,  -3.3132,  -9.4057,  -6.8137,  -5.7465, -16.7560,  -5.9528,
        -10.9243,  -7.6396,  -6.4035, -12.9723,  -6.4244, -17.9782],
       device='cuda:0')
SINR mean = -10.705514907836914
E[H^H] = 1e-07
E_MSE (Error Power) = 35.85620880126953
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.2636, 0.0696, 0.2045, 0.0123, 0.0279, 0.0708, 0.0778, 0.0026, 0.3180,
        0.1029, 0.1724, 0.2103, 0.0207, 0.2025, 0.0748, 0.1469, 0.1863, 0.0480,
        0.1855, 0.0157], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 510,  723,  559,  914,  831,  721,  708, 1000,  470,  670,  589,  554,
         863,  561,  714,  615,  575,  770,  576,  891], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 8-----------
Real SNR = tensor([8.6429, 8.3690, 7.9356, 8.7129, 8.0074, 8.2549, 7.7965, 7.3859, 9.5579,
        8.2759, 8.1644, 7.8549, 6.3928, 8.1425, 7.2305, 6.8889, 8.5654, 8.6137,
        9.7934, 7.7603], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([4.7027e+37-2.3442e+33j, 3.2415e+38+3.6351e+32j,        inf+nanj,
        2.6248e+38+1.4895e+33j, 1.5594e+38-4.4494e+32j, 2.1798e+38+3.4131e+33j,
               inf+nanj, 9.5423e+36-1.8666e+32j,        inf+nanj,
        1.1714e+37+1.1743e+32j, 8.1657e+37+5.1830e+33j, 1.4168e+37+2.3630e+32j,
        1.0890e+38-3.1043e+33j,        inf+nanj, 1.9774e+37+1.4695e+33j,
               inf+nanj,        inf+nanj,        inf+nanj,
        1.1718e+37+6.3627e+31j,        inf+nanj], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([6.3437e+13+1.1412e+08j, 2.2972e+13+4.9006e+05j, 1.6094e+12-1.3804e+07j,
        1.7177e+14-8.8116e+07j, 1.4786e+13+3.5208e+06j, 1.2272e+13-2.0972e+07j,
        4.2788e+11-7.5493e+06j, 2.9153e+12-1.6658e+07j, 4.0126e+12+1.5483e+06j,
        1.2378e+12-1.0495e+07j, 2.8410e+12+1.1683e+07j, 3.2909e+11-2.8576e+06j,
        1.9544e+11-1.6562e+06j, 9.2014e+12+9.0940e+07j, 4.3952e+12-1.2663e+07j,
        2.0293e+13+3.2421e+07j, 5.5422e+13+3.3943e+08j, 3.4226e+13-5.1410e+07j,
        6.4013e+12-1.7252e+08j, 2.6117e+11+1.6284e+06j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (21450392076288+9854604j)
SINR torch.Size([20]) = tensor([ -6.2860,  -2.6406,  -7.1986,  -1.4173,  -2.3456,  -6.5395, -11.7914,
         -6.4675,  -8.0030, -10.1882,  -8.7092, -11.0916, -10.0692,  -6.2407,
         -7.8758,  -4.0167,  -9.9981,  -1.4488, -11.0802,  -6.7851],
       device='cuda:0')
SINR mean = -7.009648323059082
E[H^H] = 1e-07
E_MSE (Error Power) = 6.379724025726318
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.1904, 0.3525, 0.1601, 0.4191, 0.3682, 0.1816, 0.0621, 0.1840, 0.1367,
        0.0874, 0.1186, 0.0722, 0.0896, 0.1920, 0.1402, 0.2840, 0.0909, 0.4174,
        0.0723, 0.1733], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([572, 447, 601, 404, 436, 580, 738, 578, 627, 693, 649, 718, 689, 570,
        623, 495, 687, 405, 718, 588], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)
--------SNR = 9-----------
Real SNR = tensor([ 8.0272,  9.0212,  7.9009,  8.8841, 10.0234,  8.5614,  8.4912,  7.8797,
        10.2512,  9.5048,  9.5882, 10.0630,  9.2460,  9.1170,  9.4749, 10.1353,
         9.0365,  9.0662,  8.9118, 10.4863], device='cuda:0')
torch.linalg.det(H_hat.mH@H_hat) = tensor([1.2246e+37+4.0758e+31j, 8.9547e+35-3.8143e+30j, 2.1819e+36+2.6416e+30j,
        9.9554e+36-1.7690e+31j, 2.7869e+36-1.1570e+31j, 5.9396e+37-1.8319e+32j,
               inf+nanj, 1.6434e+38+1.1170e+32j, 1.9755e+37-1.3111e+31j,
        2.7666e+36+6.5954e+31j, 6.1532e+36+5.8371e+31j, 9.2485e+36-4.0059e+30j,
        1.0859e+36-1.7913e+31j, 2.6906e+35-8.3010e+28j, 1.8640e+37-1.5952e+31j,
        7.5127e+36-1.1258e+31j, 9.9432e+37+9.6452e+32j, 5.9857e+35+8.4949e+30j,
        3.1495e+35+4.9072e+30j, 5.9461e+35-2.1897e+30j], device='cuda:0')
torch.mean(torch.linalg.det(H_hat.mH@H_hat))=(inf+nanj)
torch.linalg.det(H.mH@H) = tensor([4.0640e+11-4.5499e+06j, 5.6119e+13-7.7846e+07j, 2.6577e+11+1.1712e+06j,
        2.9758e+12+4.2796e+06j, 1.9860e+13+8.5573e+07j, 3.8155e+09+1.2447e+06j,
        5.6987e+11+1.5757e+06j, 2.8716e+12-2.1780e+06j, 3.2566e+13+1.0045e+08j,
        9.3690e+12+1.3699e+08j, 1.7494e+13+1.7916e+06j, 2.7601e+13-1.4351e+07j,
        1.6116e+13+1.7478e+07j, 9.3294e+11+1.6953e+06j, 2.0278e+10-4.6795e+05j,
        1.5608e+11-1.4488e+07j, 1.8333e+12+5.2864e+07j, 1.2172e+10+6.6952e+06j,
        1.0174e+11-6.1440e+04j, 1.8382e+13-7.2352e+07j], device='cuda:0')
torch.mean(torch.linalg.det(H.mH@H)) = (10382801371136+11275941j)
SINR torch.Size([20]) = tensor([-14.0484,  -2.7205,  -6.2906,  -6.2070,  -3.6407, -22.5615,  -9.4989,
         -2.4146,  -2.5055,  -9.3002,  -2.3036,  -1.8423,  -2.4336,  -5.6396,
        -22.0479, -23.0966,  -9.6002, -28.8969, -10.3492,  -4.7710],
       device='cuda:0')
SINR mean = -9.508432388305664
E[H^H] = 1e-07
E_MSE (Error Power) = 70.524658203125
####cond finisihed #####
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps ddim_discr_method = uniform
ldm/modules/diffusionmodules/util.py, make_ddim_timsteps, Selected timesteps for ddim sampler: (200,)
ldm/modules/diffusionmodules/util.py, make_ddim_sampling_parameters, Selected alphas for ddim sampler: a_t: torch.Size([200]); a_(t-1): (200,)
For the chosen value of eta, which is 0.0, this results in the following sigma_t schedule for ddim sampler tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0.], dtype=torch.float64)
ddim.py alphas_cumprod = torch.Size([1000])
ddim.py, alpha_bar_u = tensor([0.0379, 0.3483, 0.1902, 0.1932, 0.3019, 0.0055, 0.1009, 0.3645, 0.3596,
        0.1051, 0.3704, 0.3955, 0.3635, 0.2144, 0.0062, 0.0049, 0.0988, 0.0013,
        0.0845, 0.2500], device='cuda:0')
ddim.py start_timesteps after clamp S = 200 : tensor([ 797,  450,  572,  569,  482,  985,  672,  439,  442,  666,  435,  419,
         440,  550,  975,  996,  675, 1000,  697,  521], device='cuda:0')
d = torch.Size([20, 4, 32, 32])
recoverd_img = torch.Size([20, 3, 256, 256])
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate/ (starting from index 80)
20 images are saved in outputs/ALLSU-MIMO/t=16_r=16_t=16/nosample_perfect_estimate/ (starting from index 80)

全 100 枚の画像の処理が完了しました。
Your samples are ready and waiting four you here: 
outputs/ALLSU-MIMO/t=16_r=16_t=16/dynamic_perfect_estimate 
Enjoy.
